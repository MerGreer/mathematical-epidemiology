<?xml version='1.0' encoding='utf-8'?>

<pretext xml:lang="en-US">

  <docinfo>
    <macros>
      \newcommand{\R}{\mathbb R}
    </macros>

    <latex-image-preamble>
      \usepackage{tikz,pgfplots}
    </latex-image-preamble>

    <!-- <rename element="inlineexercise">Try it!</rename> -->

    <rename element="exercises">For Further Thought</rename>
    <rename element="objectives">Goals</rename>
  </docinfo>

  <book xml:id="mathematical-epidemiology">
    <title>Mathematical Epidemiology</title>
    <subtitle>A Course for Undergraduates</subtitle>

    <frontmatter xml:id="frontmatter">
      <titlepage> 
        <author>
          <personname>Meredith L. Greer</personname>
          <department>Mathematics</department>
          <institution>Bates College</institution>
        </author>
        <date>
          <today />
        </date>
      </titlepage>

      <colophon>

        <!-- <website>
          <name><copyright></copyright>
            <c>example.org</c>
          </name>
          <address>https://example.org</address>
        </website> -->

        <copyright>
          <year>2020<ndash />2023</year>
          <holder>You</holder>
          <shortlicense> 
            This work is licensed under the Creative Commons Attribution-ShareAlike 4.0 International License. To view a copy of this license, visit <url href="http://creativecommons.org/licenses/by-sa/4.0/" visual="creativecommons.org/licenses/by-sa/4.0"> CreativeCommons.org</url>
          </shortlicense>
        </copyright>
      </colophon>

      <preface xml:id="preface-overall">
        <title>Preface</title>
        
        
        <p>
          Welcome to Mathematical Epidemiology: A Course for Undergraduates. It so happens that this book is becoming available well after the start of the global COVID-19 outbreak. During this pandemic, mathematics, data, epidemiology, graphs, and charts began appearing in the news and other media at levels beyond what we had ever seen before. To fully appreciate and act on the information in the media, it has been helpful to know first-hand the ways models can be built, used, and misused, and to understand the underlying mathematics involved. 
        </p>
        <p>
          Yet this text's origin lies not in the COVID-19 outbreak, but in the much longer history of mathematical epidemiology. The text builds on a course that has been taught since 2014, and typical students studying these topics pre-2020 had never heard of connections between mathematics and epidemiology. Nearly all students in the course, before and since 2020, have gained their first significant introduction to disease models within this course. Examples of outbreaks we study include measles, Ebola, mumps, and whooping cough. 
        </p>
        <p>
          The approach used throughout this text is to dive into using, then building, disease models. We play with models and discover the ways each model responds to small and large changes. We represent the ideas of models using images, equations, words, graphs, and numbers. Each section centers on one or more activities, and as we work through these activities, we build up knowledge about how to construct and work with mathematical models of disease outbreaks.
        </p>
        <p>
          <em>Who is the expected audience for this book?</em> The audience I have in mind while writing is a class of undergraduates, studying together, and checking in with their professor along the way. These students have studied at least one semester of calculus, focusing primarily on derivatives as rates of change. It helps for students to also recognize that integrals and derivatives are inverse operations, to know that integrals sum up area under a curve (when all values on the curve are nonnegative), and to be familiar with the idea of computing derivative and antiderivative formulas. Some sections of this text use linear algebra, specifically matrices and eigenvalues. These sections are not required for learning from this book. Or, for students who would like to include these sections but have not studied linear algebra, there is a brief tutorial available.
        </p>
        <p>
          Though undergraduates are the audience I primarily think about while writing, they are not the only audience. My goal is that anyone with some calculus background will be able to learn about mathematical epidemiology by working through these activities.
        </p>
        <p>
          <em>Who can teach from this book?</em> My goal is for many teachers and professors of college-level mathematics to feel comfortable teaching from this book. There is no requirement to have taught mathematical modeling before, or to have studied mathematical epidemiology. 
        </p>
        <p>
          <em>What other kinds of math will we use, besides calculus?</em> To do mathematical modeling, we use any math we need.  We typically jump into activities and then introduce new mathematical ideas whenever they are helpful. These math ideas come from differential equations, multivariable calculus, linear algebra, numerical analysis, probability, proofs, and more. If you have already studied some of these subjects, you may be able to move more quickly through some of the activities. On the other hand, if you have not yet taken full courses in these subjects, then there will be enough information contained here for you to learn what you need and keep modeling. And, perhaps, you may find that you want to learn more, and that may lead you to study additional areas of mathematics.
        </p>
        <p>
          <em>What kind(s) of models will we use?</em> For most of this textbook, we use compartmental models, which can be drawn in pictures and written as ordinary differential equations. (It is OK to not know some of the terms in the previous sentence when you start: all will be explained.) Some of these models are called SIR models. We will mention other types of models, but we restrict our focus to compartmental models using ordinary differential equations so that we can fully understand the underlying math ideas, how to use the models, and how to visualize our results.
        </p>
        <p>
          <em>Do all the models in this text focus only on diseases?</em> Actually, no. The style of modeling we focus on has many other applications. We will investigate several other ways to use these models, including studying the spread of rumors, political party affiliations, and viral YouTube videos.
        </p>
        <p>
          Thank you for reading this introduction, and I hope you enjoy the book!
        </p>
        <p>
          Meredith L. Greer
        </p>
      </preface>

      <preface xml:id="preface-students">
        <title>To Students: How to Get the Most from This Text</title>
        
        <p>
          Active learning. Goals, Explorations, Activities, For Further Thought, asides, live links, use links to open images where you are (rather than need to jump back in the text), Python code
        </p>
        <p>
          The features of the book (Goals, Explorations, Activities, other text, For Further Thought, and any others)
        </p>
        <p>
          I won't tell you how to think! There are not specific outcomes of models that I insist you find or agree on: instead, this is about the process of describing models, supporting your assumptions, doing correct mathematics, and understanding outcomes.
        </p>

      </preface>

      <preface xml:id="preface-instructors">
        <title>To Instructors: Ways to Use This Text</title>
        
        <p>
          Full-semester, shorter module, independent research, possibly other options for length of time spent with the text. Paths through, with and without linear algebra. Active learning. Grading. Setting up papers, HW, other assessments. Using new data sets.
        </p>
        <p>
          The features of the book (Goals, Explorations, Activities, other text, For Further Thought, and any others)
        </p>

      </preface>
    </frontmatter>


  <part xml:id="part-core-modeling-concepts">
    <title>Core Modeling Concepts</title>
     
    
    <chapter xml:id="ch-prelude-diseases-in-popular-news">
      <title>Prelude: Diseases in Popular News</title>

    <introduction xml:id="intro-prelude">
      <objectives>
        <ul>
          <li>
            <p>
              Read about an outbreak in a non-scientific article
            </p>
          </li>
          <li>
            <p>
              Begin to look for disease details that can turn into mathematical ideas
            </p>
          </li>
          <li>
            <p>
              Notice the goals and style of writing in a news or popular culture article on an outbreak, and think about how these may be different in a scientific journal article
            </p>
          </li>
          <li>
            <p>
              Prioritize, and build toward a habit of, full-class discussion
            </p>
          </li>
        </ul>
      </objectives>

      <p>
        Disease outbreaks have been a topic of widespread discussion for a very long time. In this course, we will discuss the scientific study of outbreaks, data sets collected and curated by government officials, and policy ideas for improving public health outcomes. To begin, however, we start by examining writing in news and popular culture articles about diseases.
      </p>

      </introduction>

      <exploration xml:id="expl-reading-about-disease-in-the-news-and-popular-media">
        <title>Reading about Disease in the News and Popular Media</title>
        <introduction>
          <p>
            The Washington Post is a newspaper with a corresponding website. CNN is a television station and an online news source. People magazine and the corresponding website people.com center on <q>celebrity news and human-interest stories</q><fn><url href="https://en.wikipedia.org/wiki/People_(magazine)">People magazine Wikipedia entry</url>, accessed 15 Nov 2022</fn>.
          </p>
        </introduction>

        <task>
          <statement>
            <p>
              Read one or more of these suggested articles, which come from the outlets described above.
            </p>
            <ul>
              <li>
                <p>
                  <url href="https://www.washingtonpost.com/health/2019/08/24/tourist-infected-with-measles-visited-disneyland-other-southern-california-hotspots-mid-august/">A tourist infected with measles visited Disneyland and other Southern California hot spots in mid-August</url>, published August 24, 2019, by the Washington Post;
                </p>
              </li>
              <li>
                <p>
                  <url href="https://www.cnn.com/2022/10/26/health/rsv-immunity-gap">Pandemic <q>immunity gap</q> is probably behind surge in RSV cases, scientists say</url>, published October 28, 2022, by CNN;
                </p>
              </li>
              <li>
                <p>
                  <url href="https://people.com/health/measles-outbreak-spreads-21-states-dc/">Vaccinations a Priority as Measles Cases in the U.S. Number 107 in the First 7 Months of 2018</url>, published August 16, 2018, by People.
                </p>
              </li>
            </ul>
          </statement>
        </task>
        <task>
          <statement>
            <p>
              While reading each article, think through the answers to as many of the following questions as you can.
            </p>
            <ol>
              <li>
                <p>
                  What illness is involved?
                </p>
              </li>
              <li>
                <p>
                  How does it spread?
                </p>
              </li>
              <li>
                <p>
                  How quickly does it proceed? Consider incubation time, length of sickness, etc.
                </p>
              </li>
              <li>
                <p>
                  Is it more prominent in some parts of the world than others?
                </p>
              </li>
              <li>
                <p>
                  What does the article say about vaccines, quarantines, isolation, testing, or other approaches to managing this illness?
                </p>
              </li>
              <li>
                <p>
                  What mathematical concepts can you find in your article?
                </p>
              </li>
            </ol>
            <p>
              The question about mathematical concepts is very open-ended. List any ideas that seem to make sense to you.
            </p>
          </statement>
        </task>
        <p>
          hi
        </p>
      </exploration>


      <section xml:id="sec-Possible-Discussion-Themes">
        <title>Possible Discussion Themes</title>
        
        <p>
          <xref ref="expl-reading-about-disease-in-the-news-and-popular-media" /> is very open-ended. The goal of this exploration is to begin discussing outbreaks as they appear in news and popular culture writing. There is no hidden <q>right answer</q> to find.
        </p>
        <p>
          There are some possible themes that may arise during discussion. Below, you can find a sample of such themes. These may help to expand thoughts and discussions you are already having about the articles. Or it is possible that you discovered yet other themes, beyond those listed here, and this is wonderful!
        </p>
        <p>
          <em>Theme 1.</em> The diseases in the articles are measles and RSV. Both are highly contagious and spread through coughing and sneezing.
        </p>
        <p>
          <em>Theme 2.</em> The articles give different kinds of information about the ways measles and RSV can spread. Some of the articles give descriptions that let us estimate incubation period or length of sickness, and some give fewer such descriptions.
        </p>
        <p>
          <em>Theme 3.</em> Some of the articles describe disease presence in the U.S. only, and some articles describe disease presence in other countries.
        </p>
        <p>
          <em>Theme 4.</em> All of the articles discuss vaccination, but there is not yet a vaccine for RSV. Some alternate control measures, such as hand washing or sanitizing surfaces, appear in one or more articles.
        </p>
        <p>
          <em>Theme 5.</em> The question about mathematical concepts could mean many things. There are many possible answers, including but not limited to: numbers of recent cases, lengths of time of the stages of disease, historical data about when more or fewer people have been ill in past years, or percentages of people vaccinated.
        </p>
      </section>

      <section xml:id="sec-Follow-Up-By-Seeking-More-Precise-Data">
        <title>Follow Up By Seeking More Precise Data</title>
        <p>
          For these and other diseases or outbreaks we may read about, we can add to our knowledge of underlying disease biology by gathering additional data. We will find, when modeling diseases, that it can help to know the lengths of time for each disease stage, such as incubation period, how long a person is typically sick, and how long any immunity to the disease lasts. Vaccine data is also helpful, including whether a vaccine exists at all, how effective the vaccine is on average, and what percentage of people are vaccinated against a particular disease. Some of the data we collect may depend on time or place: vaccines may be newer, or different percentages of people may be vaccinated in different locations. 
        </p>
        <p>
          One place to look up data is the <url href="https://www.cdc.gov/">Centers for Disease Control and Prevention (CDC)</url>. As one example, a web search can take us to the <url href="https://www.cdc.gov/measles/index.html">CDC's information page about measles</url>. Not every disease is presented in an identical manner on the CDC's web pages, but very commonly, there is a link for Transmission and another link for Signs and Symptoms. These typically contain lots of information about how diseases spread and how long each stage takes. Such information helps us build our models.
        </p>
        <activity>
          <statement>
            <p>
              Take a look at the <url href="https://www.cdc.gov/measles/transmission.html">Transmission</url> and <url href="https://www.cdc.gov/measles/symptoms/signs-symptoms.html">Signs and Symptoms</url> pages for measles at the CDC. Putting together the information on these pages, construct a timeline of measles contagion in a single person, starting at the time the person is first infected. Include the following, and include whatever other information appears important.
              <ol>
                <li>
                  <p>
                    How long does it typically take for a person to begin being contagious?
                  </p>
                </li>
                <li>
                  <p>
                    How long is the total time period from when a person begins being contagious to when they no longer are contagious?
                  </p>
                </li>
                <li>
                  <p>
                    How does contagion overlap, or not overlap, with when a person has the typical measles rash?
                  </p>
                </li>
              </ol>
                It is likely, for most diseases, that these timelines will involve ranges of time such as <q>3 to 5 days</q> rather than more specific amounts of time such as <q>4 days</q>. Time ranges will be helpful to us as we fine-tune our models.
            </p>
          </statement>
        </activity>
        
      </section>

    
    <exercises xml:id="exercises-prelude-diseases-in-popular-news">
      <exercise number="1">
        <p>
          Look up the lengths of time for key phases of how measles unfolds. Include the length of time of any incubation period, and include how long a person is infectious with measles. There may be additional disease phases to include. Use official sources, as described in <xref ref="sec-Follow-Up-By-Seeking-More-Precise-Data" />. Cite your sources, including links to any web pages, the title of each web page used, the name of the government agency or other publisher of each web page, and the date you most recently accessed the web page.  
        </p>
      </exercise>
      <exercise number="2">
        <p>
          Look up the lengths of time for key phases of how RSV (respiratory syncytial virus) unfolds. Include the length of time of any incubation period, and include how long a person is infectious with measles. There may be additional disease phases to include. Use official sources, as described in <xref ref="sec-Follow-Up-By-Seeking-More-Precise-Data" />. Cite your sources<fn>Include links to any web pages, the title of each web page used, the name of the government agency or other publisher of each web page, and the date you most recently accessed the web page.</fn>.
        </p>
      </exercise>
      <exercise number="3">
        <p>
          Look up additional information about measles and RSV. How does each spread? What are governmental recommendations for people who think they may have measles or RSV? And so on: read more about each disease, and write several pieces of information that you find interesting. Does anything you find surprise you? Cite your sources.<fn>Include links to any web pages, the title of each web page used, the name of the government agency or other publisher of each web page, and the date you most recently accessed the web page.</fn>
        </p>
      </exercise>
    </exercises>

    </chapter>

    <chapter xml:id="ch-zombies-can-math-help">
      <title>Zombies: Can Math Help?</title>
      
      <introduction xml:id="intro-zombies">
      <objectives>
        <ul>
          <li>
            <p>
              Simulate an outbreak and actively observe the data that emerge
            </p>
          </li>
          <li>
            <p>
              Think through the disease spread process underlying a simulation
            </p>
          </li>
          <li>
            <p>
              Compare the disease spread process with a system of differential equations suggested as a possible model for this process
            </p>
          </li>
          <li>
            <p>
              Consider how changes in the disease spread process can change the outcome
            </p>
          </li>
        </ul>
      </objectives>

      <p>
        First things first: let's simulate an outbreak! This activity is directly inspired by the Disease Lab materials published freely online by Utah State University.<fn>Powell, Jim and Lewis, Matt, "Disease Lab" (2016). <em>Laboratory Experiences in Mathematical Biology</em>. 1.
        <url href="https://digitalcommons.usu.edu/lemb/1">https://digitalcommons.usu.edu/lemb/1</url></fn> You can do this exploration in a group or on your own. (Groups are recommended, if you are able to team up with one or more other people.) You will model humans, also called Susceptibles, as well as zombies, also called Infectious. The <url href="https://digitalcommons.usu.edu/lemb/1">Utah State University link</url> describes a hands-on way to play this game using dry erase markers and overhead projector transparencies. In this text, we primarily use a related online <url href="https://nelsong1997.github.io/zombie_game/">Zombie Game App</url><fn>This app was created by Gabe Nelson, Bates College Class of 2020, after campus closed due to COVID-19.</fn> to play and to generate data.
      </p>

      <p>
        Why do we start with a simulation? First, this course requires active involvement, so we create space immediately for that involvement. Second, this simulation game can be interactive, and working with others helps us see other perspectives and adds both fun and community to learning. Third, though we mostly work with real-life outbreaks in this textbook, we also purposely diverge from reality to think through hypothetical outcomes, and zombies are one way to think creatively about disease spread. Fourth, this activity generates outbreak examples, and examples throughout this course are one of our main ways to build toward theory and illustrate abstract concepts. Therefore, to achieve the goals for each section, we usually begin with exploration activities, then use what we learned in the explorations to help build our mathematical framework.
      </p>

      </introduction>

      <exploration xml:id="expl-activity-zombie-game">
        <title>Zombie Game</title>

        <introduction>
          <p>
            This game uses a grid of 100 hexagons to represent a space in which humans and zombies interact. Each round of game play represents one day. For each day, each human (<q>Susceptible</q>) is represented on the grid by a blue <q>X</q> on a single hexagon. Each zombie (<q>Infectious</q>) is represented by three red dots connected by red lines, meant to suggest a head and two arms, each of which can infect a human. Each zombie spreads out across three connected hexagons. Sample hex grids, both unmarked and marked, appear in <xref ref="zombie-board-graphics" />.
          </p>
        </introduction>
        <figure width="90%" xml:id="zombie-board-graphics">
          <caption>Blank hex grid, and sample filled-in section</caption>
          <sidebyside widths="40% 40%" margins="auto" valign="middle">
            <figure width="40%" xml:id="fig-standard-hex-board">
              <caption>Full hex grid, not filled in</caption>
              <image source="StandardHexBoard.png" width="40%">
              <description>Hex grid of 100 hexagons, in a ten-by-ten arrangement</description>
              </image>
            </figure>
            <figure width="40%" xml:id="fig-zombie-board-detail">
              <caption>Representing humans (blue X marks) and zombies (red dots and lines, representing a head and two arms) on the hex grid</caption>
              <image source="ZombieBoardDetail.png" width="40%">
              <description>Detail of hex grid, showing placement of zombies and humans</description>
              </image>
            </figure> 
          </sidebyside>
        </figure>

        <task>
          <statement>
            <p>
              To start the simulation, go to the <url href="https://nelsong1997.github.io/zombie_game/">Zombie Game App</url>. Use the default settings at first, except to change the Human Start Count to 49, as shown in <xref ref="fig-zombie-app-49-susceptibles" />. Combining these 49 Humans with the Zombie Start Count of 1, the total population then equals 50.
            </p>
            <figure width="90%" xml:id="fig-zombie-app-49-susceptibles">
              <caption>Changing <q>Human Start Count</q> to 49 in the Zombie Game App</caption>
                <image source="ZombieApp_49Susceptibles.png" width="40%">
                    <description>Screen image from the Zombie Game App, showing the <q>Human Start Count</q></description>
                </image>
            </figure>
          </statement>
        </task>
        <task>
          <statement>
            <p>
              To watch the outbreak unfold, day by day, first click <c>start</c>. You will see the zombies and humans placed randomly on the grid. Both a table of data, and a graph of Round 0 and Round 1 data, appear to the right. A sample Round 1 result appears in <xref ref="fig-zombie-app-one-day" />, and the table of data is shown more clearly in <xref ref="fig-human-zombie-data-day1" />. There is randomness in how Zombies and Humans are placed on the grid, so your one-day results on the app may be different.
            </p>
            <figure width="100%" xml:id="fig-zombie-app-one-day">
              <caption>Sample output for Round 1 from the Zombie Game App</caption>
                <image source="ZombieApp_OneDay.png" width="100%">
                    <description>Sample output for Round 1 from the Zombie Game App, including the grid of humans and zombies, plus a table and a graph of data for Rounds 0 and 1</description>
                </image>
            </figure>
            <figure width="50%" xml:id="fig-human-zombie-data-day1">
              <caption>Table of sample data from Round 1 of a human<ndash />zombie simulation</caption>
              <image source="SampleHumanZombieData_Day1.png" width="70%">
                  <description>Sample data for one round of a simulation from the Zombie Game App, viewed as a table</description>
              </image>
            </figure>
            <p>
              If you began with 49 humans and 1 zombie, these will be the numbers listed for Round 0. The data for Round 1 are computed by looking at the hex grid: each human that overlaps with a zombie is a <q>New Infection</q> and moves from the <em># Humans</em> category to the <em># Zombies</em> category. This means that this number of individuals is subtracted from <em># Humans</em> and added to <em># Zombies</em>. Double check that your count of new infections matches the app's count! In <xref ref="fig-zombie-app-one-day" />, the one zombie overlaps two blue X hexes. We therefore see that on Round 1 there are two <em>New Infections</em>. We also compare Round 1 with Round 0. The two <em>New Infections</em> for Round 1 mean that the population of <q>Susceptibles</q> (that is, humans) drops by 2, from 49 to 47, while the population of <q>Infectious</q> (that is, zombies) rises by 2, from 1 to 3.)  
            </p>
          </statement>
        </task>
        <task>
          <statement>
            <p>
              When you are ready, click <c>next round</c> to see a new grid for Round 2. The table of data, and the graph, both update to include Round 2. Continue to click <c>next round</c> at your own pace, thinking through the grid, table, and graph as each step proceeds. The game ends when there are either no humans left to infect, or no zombies left to keep infecting new humans. 
             </p>
          </statement>
        </task>
        <task>
          <statement>
            <p>
              As an alternative to make the game more interactive, the app allows you to choose your own locations for humans and zombies. To choose your own locations, under <em>Mode</em>, check <em>Hotseat</em> instead of <em>Auto</em>. The app then prompts you to place all the Humans for one round of the simulation. After all Humans are placed, the app prompts you to place your Zombies. For each Zombie, you must place the head and the arms. When this is complete, the app shows both Humans and Zombies, to indicate how many new infections have occurred. To make this into a game, two people can play. One person places the Humans, <em>without their partner watching</em>. Then the partner places the Zombies, again <em>without their partner watching</em>. Then, together, the partners can see how many new infections there are, once the Human and Zombie grids are shown together. Is there any strategy that helps either the Humans or the Zombies?
            </p>
          </statement>
        </task>
        <task>
          <statement>
            <p>
              Try the game one or many times, on your own or with a partner. Copy several resulting data sets, as numbers and as images, so that you can look for patterns.
            </p>
          </statement>
        </task>
      </exploration>
      
      <section xml:id="sec-we-now-have-data-qualitative-musings">
        <title>We Now Have Data: Qualitative Musings</title>

        <p>
          You have now had the chance to generate one or many data sets. Take time to examine the data, both in the form of a table and in the form of a graph. Do this with multiple data sets: in a classroom setting, different student groups can share data.
        </p>
        
        <activity xml:id="exer-begin-zombie-app">
          <statement>
            <p>
              Think through the following questions. Spend time trying to answer these before you continue through this book.
            </p>
             
            <ol>
              <li>
                <p>
                  Upon viewing multiple sets of data from the <url href="https://nelsong1997.github.io/zombie_game/">Zombie Game App</url>, what patterns do you observe?
                </p>
              </li>
              <li>
                <p>
                  Do you have any questions, or guesses, about what might happen in additional simulations in the app?
                </p>
              </li>
              <li>
                <p>
                  So far, we have mostly kept the default settings in the app, and played just one version of the hands-on game, but what if we changed the rules for human<ndash />zombie interaction? Do you suspect that the outcome(s) could then be different? If so, then in what ways do you think the outcome(s) might change?
                </p>
              </li>
            </ol>
          </statement>
        </activity>
          
        <p>
          In this book, we work with mathematical models. As a first step toward building mathematical models, we should think through the underlying <q>rules</q> of our situation. We should also think through any outcomes of these rules. Must these rules always lead to similar outcomes? Could these same rules produce significantly different outcomes? Spending time on understanding our system is a crucial part of making sure our mathematical approaches make sense.
        </p>

        <activity>
          <statement>
            <p>
              In <xref ref="exer-begin-zombie-app" />, some of the first patterns to notice may be about the shapes of the graphs of the Human and Zombie populations as time progresses forward from Day 0. Next, develop responses to the following questions, and explain your reasoning. (If you already thought about these as part of <xref ref="exer-begin-zombie-app" />, great work!)
            </p>
            <ol>
              <li>
                <p>
                  What can you say about whether the size of each population (Humans and Zombies) is rising or falling?
                </p>
              </li>
              <li>
                <p>
                  Can a single population first rise, and later fall (or first fall, and then rise)?
                </p>
              </li>
              <li>
                <p>
                  If we tried this simulation many times, in what ways could your results be similar, and in what ways could your results be different?
                </p>
              </li>
            </ol>
          </statement>
        </activity>
        <p>
          There are many other things you may notice. To name just a few ideas: you may think about the speed with which each curve rises or falls. You may think about how much these speeds change when you try the game several times. You may relate a rise in one graph to a fall in the other, thinking about a sort of symmetry between the two graphs. You may think about when the rising or falling is relatively slow vs. relatively fast. These and many other observations are a valued and central part of working toward mathematical model building.
        </p>
        
      </section>

      <section xml:id="sec-a-first-model">
        <title>A First Model</title>
        
        <p>
          After completing a simulation, you have data for the numbers of humans and zombies during each day of the outbreak. These data can be presented as a table of values, and they can be presented as a graph. In the app, the table format for data appears as in <xref ref="fig-human-zombie-data-table" />, and the graph format for data appears as in <xref ref="fig-human-zombie-data-graph" />. 
        </p>
        
        <figure width="90%" xml:id="fig-human-zombie-data-table">
          <caption>Table of sample data from a human<ndash />zombie simulation</caption>
          <image source="SampleHumanZombieData.png" width="80%">
              <description>Sample data for a full simulation from the Zombie Game App, viewed as a table</description>
          </image>
        </figure>
        <figure width="90%" xml:id="fig-human-zombie-data-graph">
          <caption>Graph of sample data from a human<ndash />zombie simulation</caption>
          <image source="SampleHumanZombieGraph.png" width="80%">
              <description>Sample data for a full simulation from the Zombie Game App, viewed as a graph</description>
          </image>
        </figure>

        <p>
          As we build a model, we focus on the relatively slow changes in population sizes that happen near the beginning and end of the model. This may not happen in every simulation: for instance, sometimes zombies happen to infect a lot of humans in the last time step. However, in other simulations, one lone human may last for many days before being infected. We focus on what happens <em>on average</em>. For this model, on average, the pace of infection seems slower near the beginning and near the end of the outbreak.
        </p>
        <activity>
          <statement>
            <p>
              One observation is that the pace of infection is slower when there are relatively few humans, or when there are relatively few zombies.
            </p>
            <ol>
              <li>
                <p>
                  Can you see why it makes sense that infection tends to spread less quickly when there are fewer individuals in one of the populations?
                </p>
              </li>
              <li>
                <p>
                  Conversely, why does it make sense for infection to spread relatively rapidly when there are relatively large numbers of both humans and zombies?
                </p>
              </li>
              <li>
                <p>
                  To take the discussion about pace of infection to a logical extreme: how fast can infection spread when there are zero humans, or when there are zero zombies?
                </p>
              </li>
            </ol>
          </statement>
        </activity>
        <p>
          Putting this all together, we can say that, on average, the change in the number of infections seems to depend on both the number of humans (Susceptibles) and the number of zombies (Infectious). One mathematical approach to writing this is to say that new cases per day are proportional to the number of Susceptibles multiplied by the number of Infectious. We can write this as follows:
        </p>

        <mdn>
          <mrow xml:id="eq-proportionality">( \# \mbox{ New Infections}) \amp \propto (\# \mbox{ Susceptibles}) \cdot (\# \mbox{ Infectious}) </mrow>
        </mdn>

        <p>
          To turn this into a mathematical formula, we will use a <em>system of ordinary differential equations</em>. This is a good time to mention: to read and learn from this text, there is no need to have taken a course on differential equations. To write and work with the models we use, it is sufficient to know these ideas from calculus:
        </p>

        <ul>
          <li>
            <p>
              derivatives represent change;
            </p>
          </li>
          <li>
            <p>
              an increasing graph has a positive slope and a derivative greater than zero;
            </p>
          </li>
          <li>
            <p>
              a decreasing graph has a negative slope and a derivative less than zero; and
            </p>
          </li>
          <li>
            <p>
              a horizontal graph (one in which the output value is not changing) has a slope of zero and a derivative equal to zero.
            </p>
          </li>
        </ul>

        <p>
          One other helpful piece of information is the fact that a differential equation is just an equation containing a derivative. Many of the equations in calculus contain a derivative. A quick example is <m>f'(x)=3x+2</m>, which contains the derivative <m>f'(x)</m>. This means that if you have studied calculus, then you have already built significant experience using differential equations.
        </p>
        <p>
          With these calculus ideas in mind, we return to our model. We will write two equations, one to represent the change in the Susceptible population and one to represent the change in the Infectious population. When we say <q>change</q>, we mean the change that happens on average if we were to run the simulation many times. Our independent variable is time, which we label <m>t</m>. You may have noticed that time is the variable on the horizontal axis: this axis is labeled <q>Round</q> in the app, and it represents time in the form of days. For our dependent variables, we choose letters that correspond to the names of each population. This makes the dependent variable meanings easier to remember, and for many people, it makes the differential equations easier to interpret. Therefore let <m>S = S(t)</m> represent the Susceptible population and <m>I = I(t)</m> represent the Infectious population. Since our populations are represented by the letters <m>S</m> and <m>I</m>, we call this model an <term>SI model</term>. We say the names of each of the first two letters when saying <q>SI model</q> aloud, that is, we say <q>S</q> <q>I</q> <q>model</q>.
        </p>
        <p>
          You may have noticed that our data show us not just total numbers of <m>S(t)</m> and <m>I(t)</m> at each time step, but also show how <m>S(t)</m> and <m>I(t)</m> change over time. The number of New Infections tells us precisely how many people change, on each day, from the <m>S(t)</m> population to the <m>I(t)</m> population. We now connect <m>S(t)</m>, <m>I(t)</m>, and the number of New Infections using differential equations and the proportionality relationship from <xref ref="eq-proportionality" />:
        </p>

        <mdn>
          <mrow xml:id="eq-S-in-SImodel">\frac{dS}{dt} \amp = -\beta S I </mrow>
          <mrow xml:id="eq-I-in-SImodel">\frac{dI}{dt} \amp = \beta S I </mrow>
        </mdn>

        <p>
          There is a lot of calculus happening in these SI model equations! Here are some of the key ideas to notice.
        </p>

        <ul>
          <li>
            <p>
              The derivative term <m>dS/dt</m> represents the change, across time, in population <m>S(t)</m>.
            </p>
          </li>
          <li>
            <p>
              Similarly, the derivative <m>dI/dt</m> represents the change, across time, in population <m>I(t)</m>.
            </p>
          </li>
          <li>
            <p>
              In this model, individuals leaving <m>S(t)</m> go immediately into <m>I(t)</m>, which is why the same term <m>\beta S I</m> appears on the right-hand side of both equations.
            </p>
          </li>
          <li>
            <p>
              Individuals can only leave <m>S(t)</m>, so <m>S(t)</m> decreases, and <m>dS/dt</m> is negative. We actually see the negative sign (<m>-</m>) written into the differential equation.
            </p>
          </li>
          <li>
            <p>
              Individuals can only enter <m>I(t)</m>, so <m>I(t)</m> increases, and <m>dI/dt</m> is positive. We do not explicitly write a positive sign (<m>+</m>), but we note that there is no negative sign (<m>-</m>).
            </p>
          </li>
          <li>
            <p>
              The values of <m>S(t)</m> and <m>I(t)</m> should never be negative. They should be either positive or zero. This makes sense because they represent populations of individuals. This must also be true mathematically, in order for the model to make sense.
            </p>
          </li>
          <li>
            <p>
              We represent the idea of proportionality by using the parameter <m>\beta</m>. We will experiment in <xref ref="ch-visualization-graphing-model-results-and-data" /> with different values of <m>\beta</m> to see how changing <m>\beta</m> affects the outcomes of the model.
            </p>
          </li>
          <li>
            <p>
              The value of <m>\beta</m> must be positive. This observation is consistent with us directly seeing the negative sign (<m>-</m>) when a term is negative, and not seeing the negative sign when a term is positive. (With this observation, it could be possible for <m>\beta</m> to be 0, but if there is any outbreak and any interaction of <m>S(t)</m> with <m>I(t)</m>, then <m>\beta</m> will not be 0.)
            </p>
          </li>
        </ul>

        <p>
          This model uses differential equations, which think of time as continuous, using every real value for <m>t</m> starting at <m>t=0</m>. By contrast, when we collect data from the zombie game, time is <term>discrete</term>, meaning that time steps forward through values such as <q>Day 0</q>, <q>Day 1</q>, <q>Day 2</q>, and so on. In this course, we mainly use differential equation models, meaning time is thought of as <term>continuous</term>. Continuous time may match well with our intuitive sense of how time works: time does not stop and start. However, the data we collect about disease spread will often be discrete, on time scales such as days or weeks. We will include this knowledge in our work with models.
        </p>

        <activity>
          <statement>
            <p>
              <xref ref="fig-first-si-graph" /> shows one possible graph of the SI model, with <m>\beta</m> selected so that the graphs in <xref ref="fig-human-zombie-data-graph" /> and <xref ref="fig-first-si-graph" /> are fairly similar. Compare these two graphs, thinking through the questions below.
            </p>
            <figure width="90%" xml:id="fig-first-si-graph">
              <caption>A sample graph of the SI model, drawn using Equations <xref ref="eq-S-in-SImodel" /> and <xref ref="eq-I-in-SImodel" />.</caption>
              <image source="First_SI_Graph.png" width="80%">
                  <description>Sample SI graph, showing Susceptibles starting at 49 and dropping toward 0, and Infectious starting at 1 and rising toward 50</description>
              </image>
            </figure>
            <ol>
              <li>
                <p>
                  The curves in <xref ref="fig-first-si-graph" /> are smooth, whereas the graphs shown in <xref ref="fig-human-zombie-data-graph" /> are less so. Why is this?
                </p>
              </li>
              <li>
                <p>
                  The SI model, as described in Equations <xref ref="eq-S-in-SImodel" /> and <xref ref="eq-I-in-SImodel" />, provides formulas for <m>dS/dt</m> and <m>dI/dt</m>. Yet the graph in <xref ref="fig-first-si-graph" /> shows solution curves for Susceptibles and Infectious, that is, <m>S(t)</m> and <m>I(t)</m>. Describe how the formulas for <m>dS/dt</m> and <m>dI/dt</m> in the SI model correspond to the solution curves <m>S(t)</m> and <m>I(t)</m> shown in <xref ref="fig-first-si-graph" />. 
                </p>
              </li>
              <li>
                <p>
                  Throughout the human-zombie simulation, there are exactly 50 people at all times. Explain how this feature of the simulation appears in both <xref ref="fig-human-zombie-data-graph" /> and <xref ref="fig-first-si-graph" />.
                </p>
              </li>
              <li>
                <p>
                  Continue to comment on comparisons, similarities, and differences between <xref ref="fig-human-zombie-data-graph" /> and <xref ref="fig-first-si-graph" />. There are no specific <q>right answers</q> here: this is open-ended exploration, building intuition and understanding for the interactions among data, graphs, and a differential equations model.
                </p>
              </li>
            </ol>
          </statement>
        </activity>

        <exercises xml:id="exercises-ch-zombies-can-math-help">
          <exercise number="1">
           <p>
             Vary the zombie simulation so that zombies have only one arm. In this case, the app represents each zombie by two connected dots, rather than three connected dots. We can change the <q># of Zombie Arms</q> in the app from 2 to 1. Complete one or more simulations with this change. Collect and graph the simulation data. How do your results compare with the results from simulations in which zombies have two arms? Write about your results. Include your data and graphs as part of your comparison.
            </p>
          </exercise>
          <exercise number="2">
            <p>
              What other variations can you imagine creating in this game? Describe how the game changes, and connect each game change with what it would mean in the <q>real-world</q> scenario of a zombie outbreak.
            </p>
            <ol>
              <li>
                <p>
                  How might your mathematical model change in order to match this change in the game? In other words, how might your differential equations change?
                </p>
              </li>
              <li>
                <p>
                  How might long-term outcomes for humans and zombies change, if at all?
                </p>
              </li>
            </ol>
            <p>
              Support your thoughts, to the best of your abilities, using the data and graphs you generate from simulating your changes to the game.
            </p>
          </exercise>
          <exercise number="3">
            <p>
              Spend more time examining and thinking about the graph of the SI model, as shown in <xref ref="fig-first-si-graph" />.
            </p>
            <ol>
              <li>
                <p>
                  Since <m>\beta</m>, <m>S</m>, and <m>I</m> cannot be negative, we recognize that <m>-\beta S I</m> must be either negative or equal to zero. Explain what these observations indicate about the Susceptibles graph in <xref ref="fig-first-si-graph" />, using Equation <xref ref="eq-S-in-SImodel" /> as part of your explanation.
                </p>
              </li>
              <li>
                <p>
                  Since <m>\beta</m>, <m>S</m>, and <m>I</m> cannot be negative, we recognize that <m>\beta S I</m> must be either positive or equal to zero. Explain what these observations indicate about the Infectious graph in <xref ref="fig-first-si-graph" />, using Equation <xref ref="eq-I-in-SImodel" /> as part of your explanation.
                </p>
              </li>
              <li>
                <p>
                  In <xref ref="ch-visualization-graphing-model-results-and-data" /> we will vary the value of <m>\beta</m> in the SI model. Try to predict some of the ways in which changing <m>\beta</m> will change the outcome of the SI model. How will the solution curves in <xref ref="fig-first-si-graph" /> change as <m>\beta</m> increases? How will the solution curves in <xref ref="fig-first-si-graph" /> change as <m>\beta</m> decreases? (Though the value of <m>\beta</m> changes, your discussion should keep <m>\beta > 0</m>.)
                </p>
              </li>
            </ol>

          </exercise>
        </exercises>

      </section>


    </chapter>


    <chapter xml:id="ch-visualization-graphing-model-results-and-data">
      <title>Visualization: Graphing Model Results and Data</title>

      <introduction xml:id="intro-visualization-graphing-model-results-and-data">
        <objectives>
          <ul>
            <li>
              <p>
                Visualize data from the <url href="https://nelsong1997.github.io/zombie_game/">Zombie Game App</url> alongside solution curves of the SI model from <xref ref="ch-zombies-can-math-help"/>
              </p>
            </li>
            <li>
              <p>
                Use comparisons between data and our initial SI model to visually estimate the value of the parameter <m>\beta</m>
              </p>
            </li>
            <li>
              <p>
                Learn the <url href="https://www.python.org/">Python</url> needed for solving systems of differential equations and graphing these solutions, plus data, on a shared set of axes
              </p>
            </li>
          </ul>
        </objectives>

        <p>
          In <xref ref="ch-zombies-can-math-help" /> we simulated a simple outbreak. This outbreak can be modeled using the <em>system of ordinary differential equations</em> appearing in <xref ref="eq-S-in-SImodel" /> and <xref ref="eq-I-in-SImodel" />. Here is the system, also called an SI model, again:  
        </p>
  
        <md>
          <mrow>\frac{dS}{dt} \amp = -\beta S I </mrow>
          <mrow>\frac{dI}{dt} \amp = \beta S I. </mrow>
        </md>
  
        <p>
          We began to explore the differences between the discrete data, collected round-by-round in the Zombie Game App, and the continuous model, which uses a system of differential equations to produce smooth curves. Here, we continue that exploration visually, by producing graphs of data and graphs of model results. We also see a first, very visual, way to estimate the value of <m>\beta</m> in our model. (There will be other, more detailed, ways to estimate <m>\beta</m>, as we continue in this text.) To do all this, we employ visualization tools. This text uses cells that run both Python and <url href="https://www.sagemath.org/">SageMath</url>, which <q>is a free open-source mathematics software system</q><fn><url href="https://www.sagemath.org/">https://www.sagemath.org/</url></fn>, for visualization. The Python code here can be used in any setting where you use Python.
          <aside>
            <p>
              The Python-related goal of this text is to make it as easy and intuitive as possible for readers to jump into using Python, so that we can better explore disease models. Some readers may prefer different Python syntax, or using a different program altogether, and these alternate approaches are welcome. 
            </p>
            
          </aside> 
          
          <!-- Other options include Python and Mathematica, with files for each available at (provide on GitHub???). -->
        </p>

      </introduction>

      
      <exploration xml:id="expl-creating-graphs-in-python-from-the-human-zombie-game">
        <title>Creating Graphs in Python from the Human<ndash />Zombie Game</title>
        <introduction>
          <p>
            If you have never used Python before, you are in the right place! If you have used Python, you may be able to move through this chapter more quickly, but be sure to spend time to make sure you know the code you need to complete modeling tasks. In this chapter, we spend a significant amount of time reading code, viewing code output, and making changes to code, to build up enough Python knowledge to be able to generate additional graphs of data and model results. The code we practice with allows us to visualize the sample data set shown as a table in <xref ref="fig-human-zombie-data-table"/>.
          </p>
        </introduction>
        
        <task>
          <statement>
            <p>
              Read carefully through the code below, focusing your attention on lines 3<ndash/>8. Click the <c>Evaluate (Sage)</c> button underneath to view the output. Using the code and its output, answer the questions that follow.
            </p>
            <sage>
              <input>
                import matplotlib.pyplot as plt
                plt.cla()
                t_steps = [0, 1, 2, 3, 4, 5, 6]
                S_data = [49, 47, 43, 36, 20, 4, 0]
                I_data = [1, 3, 7, 14, 30, 46, 50]
                plt.plot(t_steps, S_data,'o', color='blue')
                plt.plot(t_steps, I_data, '*', color='orange')
                plt.show()
              </input>
              <output>
              (put the graph here!!)
              </output>
              </sage>
            <ul>
              <li>
                <p>
                  Explain where and how in the code we enter, and label, the data from <xref ref="fig-human-zombie-data-table"/>.
                </p>
              </li>
              <li>
                <p>
                  Which lines of code produce the blue dots on the output graph, and what information from <xref ref="fig-human-zombie-data-table"/> do these dots represent?
                </p>
              </li>
              <li>
                <p>
                  Which lines of code produce the orange stars on the output graph, and what information from <xref ref="fig-human-zombie-data-table"/> do these dots represent? 
                </p>
              </li>
            </ul>
          </statement>
          <answer>
            <ul>
              <li>
                <p>
                  In Line 3, we enter the time data and label it <q>t</q>. In the human<ndash/>zombie game, time is listed in rounds of game play.
                </p>
                <p>
                  In Lines 4 and 5, we enter the human and zombie data, that is, Susceptible and Infectious, labeled <q>S_data</q> and <q>I_data</q>, respectively. 
                </p>
                <p>
                  To enter a list of data, we type the label and the <q>=</q> sign. We then place the data inside square brackets, and we separate the data using commas. (The data, as listed, are separated by commas and also spaces. The spaces are optional.) 
                </p>
                <p>
                  We are not entering the data for New Infections. Instead, we enter only the data we need for graphing the Susceptible and Infectious populations.
                </p>
              </li>
              <li>
                <p>
                  Lines 3 and 4 enter the data: the inputs (time, in terms of rounds of game play, which we label on the horizontal axis and enter in Line 3) and the outputs (values of the Human population, also called the Susceptible population, which are labeled on the vertical axis and are entered in Line 4). Line 6 creates, but does not show, the plot of data from Lines 3 and 4. Line 8 shows the plot of data.
                </p>
              </li>
              <li>
                <p>
                  Lines 3 and 5 enter the data: the inputs (time, in terms of rounds of game play, which we label on the horizontal axis and enter in Line 3) and the outputs (values of the Zombie population, also called the Infectious population, which are labeled on the vertical axis and are entered in Line 5). Line 7 creates, but does not show, the plot of data from Lines 3 and 5. Line 8 shows the plot of data. 
                </p>
              </li>
            </ul>
          </answer>
        </task>

        <task>
          <statement>
            <p>
              Go back to the Python code and begin to play with it: make some changes. You can always start anew by refreshing the browser window. Address the following questions, and experiment freely beyond that.
            </p>
            
            <ul>
              <li>
                <p>
                  What marker shapes do you like? To experiment with other shapes, see <url href="https://matplotlib.org/stable/api/markers_api.html">the library of marker shapes</url> available in the online documentation for <c>matplotlib</c>.
                </p>
              </li>
              <li>
                <p>
                  Try different colors for the markers. One way to do this quickly is to go to <url href="https://matplotlib.org/stable/gallery/color/named_colors.html">this page about colors</url> from the online documentation for <c>matplotlib</c>, and scroll down to the header <q>CSS Colors</q>. Replace <q>blue</q> and <q>orange</q> with colors you choose from the CSS Colors list, and view the resulting graph. (There are many other ways to choose colors in Python, and you can search online examples and documentation to learn about these.)
                </p>
              </li>
            </ul>
          </statement>
        </task>

        <conclusion>
          <p>
            The first two lines of the Python code are important, but their phrasing does not make very obvious what they do. Line 1 imports a Python package that includes commands for drawing plots. Line 2 clears any past plots, meaning any past plots should be completely gone. This makes sure that any new plot contains only what we want. Line 2 may not be needed when we very first use Python, but if we create a different plot, and then come back to this code cell and re-enter it, the other plot we created could be overlaid with this one. The <q>clear</q> command, <c>plt.cla()</c>, makes sure that only our current plot appears.
          </p>
        </conclusion>

      </exploration>


      <!-- <section xml:id="sec-what-does-it-mean-to-solve-a-differential-equation">
        <title>What Does it Mean to Solve a Differential Equation?</title>
        
      </section> -->

      <section xml:id="sec-solving-differential-equations-using-graphs">
        <title><q>Solving</q> Differential Equations Using Graphs</title>

        <p>
          Our goal in this section is to learn to use Python to create graphs similar to what we saw in <xref ref="fig-first-si-graph"/>. Such a graph starts with a system of differential equations and draws one possible <term>graphical solution</term> to that system. The graphical solution drawn depends on the equations themselves, the value(s) of any parameter(s), and the starting values for each population in the system, that is, the values when <m>t=0</m> of <m>S(t)</m>, <m>I(t)</m>, and any other populations being modeled. For now, we specify that this type of solution is a <em>graphical solution</em>, but as the book continues, we will often refer to a graphical solution as simply a <em>solution</em>.
        </p>

        <p>
          One thing we will <em>almost never</em> do is solve an entire system of differential equations in the way you may have seen in a calculus course, where we wrote the solution as a formula. (!!! Possible exception in Chapter 12 - mention this. !!!) Here is an example to remind you how it looks to determine a formula as the solution to a differential equation. Then we will discuss why we use a different approach in this text.
        </p>
        
        <activity xml:id="exer-solve-de">
          <statement>
            <p>
              As we mentioned back in <xref ref="ch-zombies-can-math-help"/>, a differential equation is just an equation in which at least one term is a derivative. This means that an equation like <m>dy/dt=\cos t + 3</m> is a differential equation. 
            </p>

            <p>
              Solving a differential equation often means finding a way to write an equivalent relationship, without including a derivative. Using this interpretation of <q>solving</q>: solve  
            </p>

            <md>
              <mrow>\frac{dy}{dt}=\cos t + 3.
              </mrow>
              </md>
             
          </statement>
          <answer>
            <p>
              The general solution is <m>y=\sin t + 3t + C</m>, where <m>C</m> can be any constant. In this case, we solved by computing the antiderivatives of both sides of the differential equation.
            </p>
          </answer>
        </activity>

        <activity xml:id="exer-cannot-easily-solve-de-system">
          <statement>
            <p>
              Now consider the SI model: 
            </p>

            <md>
              <mrow>\frac{dS}{dt} \amp = -\beta S I </mrow>
              <mrow>\frac{dI}{dt} \amp = \beta S I. </mrow>
            </md>

            <p>
              What are the challenges to solving this system of equations, where <q>solving</q> means determining formulas that do not involve derivatives for <m>S(t)</m> and <m>I(t)</m>? 
            </p>
             
          </statement>
          <hint>
            <p>
              There are many ways to answer this. One consideration is that each of the differential equations involves both <m>S</m> and <m>I</m>. This means the differential equations do not stand alone: each depends on the other. This interrelationship means we cannot just compute two separate antiderivative formulas. 
            </p>
            <p>
              Another consideration is that the right-hand side of the differential equation in <xref ref="exer-solve-de"/> involves only <m>t</m>, that is, only the independent variable. The dependent variable <m>y</m> does not appear except in the derivative term <m>dy/dt</m>. However, in the SI model system of equations, the dependent variables <m>S</m> and <m>I</m> appear in the derivatives <em>and elsewhere in the equations</em>. The antiderivative methods learned in a typical introductory Calculus course do not apply in this situation.
            </p>
            <p>
              You may have thought of yet other challenges as well.
            </p>
          </hint>
        </activity>
          
        <p>
          As discussed in <xref ref="exer-cannot-easily-solve-de-system"/>, solving a system of differential equations is challenging. As we include more than two compartments, finding solution formulas for <m>S(t)</m>, <m>I(t)</m>, and additional populations becomes yet more challenging, and is often impossible. Even when we can determine solution formulas, they are typically quite complicated to work with.
        </p>

        <p>
          Instead, our approach is to compute <term>numerical solutions</term>, which are solutions in the form of numbers. More mathematical details appear in <xref ref="ch-numerical-simulations-an-overview-of-how-computers-turn-equations-into-graphs"/>, but the main idea is that Python starts at the initial population values, then uses the system of differential equations to <q>step through</q> the full range of time, computing population values step-by-step at later times by using information about how the population values change throughout. The system of differential equations is made up of derivatives, which are rates of change, so they exactly describe how the populations change at all times <m>t</m>. The population values computed in the numerical solution can be printed, or more often, graphed, to see the results in the form of a graphical solution.
        </p>

        <p>
          We noted earlier that graphical solutions may be called simply <em>solutions</em>. Similarly, numerical solutions are sometimes called simply <em>solutions</em>. And we have seen that formula-based solutions can be called simply <em>solutions</em>. It is important to use context to determine which kind of solution is being discussed, in this text or in other reading.
        </p>

        <p>
          Here is an outline of the numerical solution process.
        </p>

        <ol>
          <li>
            <p>
              Tell Python the formulas for the system of differential equations.
            </p>
          </li>
          <li>
            <p>
              Tell Python which numbers to use for any parameters in the model. We select the numbers for a particular numerical solution, and we can use different numbers to create a different numerical solution.
            </p>
          </li>
          <li>
            <p>
              Tell Python the <term>initial conditions</term> for each population, that is, the size of each population at the starting time of the model (which is usually <m>t=0</m>).
            </p>
          </li>
          <li>
            <p>
              Tell Python when to start and stop the model, that is, the starting and ending values for time <m>t</m>. Also tell Python what time steps to use as Python <q>steps through</q> from the starting to the ending time.
            </p>
          </li>
          <li>
            <p>
              Ask Python to use all this information to numerically solve the model and plot graphical solution curves. 
            </p>
          </li>
        </ol>

        <p>
          In <xref ref="exer-first-odeint-code"/>, compare this outline with Python code.
        </p>

        <activity xml:id="exer-first-odeint-code">
          
        <statement>
          <p>
            Read the Python code in the block below, and click the <c>Evaluate (Sage)</c> button to view the resulting graph. Think carefully about steps 1-5 in the outline above. Which lines of code address which steps of the outline? (Notice that you may need to scroll down within the code block. Alternately, click the rectangular icon in the top right of the code block. This opens a full-screen version of the code. To return to the regular screen, click again the rectangle in the top right.)
          </p>

          <sage>
            <input>
              import matplotlib.pyplot as plt
              import numpy as np
              from scipy.integrate import odeint
              plt.cla()
              
              def hz(y, t):
                S, I = y
                dydt = [-beta * S * I, beta * S * I]
                return dydt
              
              beta = 0.02
              y0 = [49, 1]
              t_range = np.arange(0.0, 8.0, 0.1)
              sol = odeint(hz, y0, t_range)
              
              plt.plot(t_range, sol[:, 0], color='blue')
              plt.plot(t_range, sol[:, 1], color='orange')
              plt.show()
            </input>
            <output>
            (put the graph here!!)
            </output>
            </sage>
        </statement>

        <answer>
          <p>
            <ol>
              <li>
                <p>
                  The formulas for the system of differential equations appear most directly in line 8, in order. The first formula is <c>-beta * S * I</c>, and the second formula is <c>beta * S * I</c>. Collectively, these are labeled <c>dy/dt</c>. More generally, the lines 6<ndash/>9 define the system of differential equations.
                </p>
              </li>
              <li>
                <p>
                  In line 11, we give <m>\beta</m> the value of 0.02. This number can be changed, and the resulting numerical solution then changes accordingly.
                </p>
              </li>
              <li>
                <p>
                  In line 12, the initial conditions are set to <m>S(0)=49</m> and <m>I(0)=1</m>. These initial conditions are collectively labeled as <c>y0</c>. The initial conditions appear in square brackets and are separated by a comma. This syntax should look familiar from line 8, when we entered the right-hand sides of the differential equations all in one command, using the same syntax.
                </p>
              </li>
              <li>
                <p>
                  The time range for this numerical solution appears in line 13, using the <c>arange</c> command from the <c>numpy</c> package downloaded in line 2. The code says <c>t = np.arange(0.0, 8.0, 0.1)</c>. This means that time starts at <m>t=0.0</m> and continues till <m>t=8.0</m>. In addition, the <c>0.1</c> tells Python to use a step size of 0.1 in the <q>step through</q> process for computing <m>S(t)</m> and <m>I(t)</m> values. 
                </p>
              </li>
              <li>
                <p>
                  We ask in line 14 for Python to compute a solution, called <c>sol</c>. To compute this solution, Python uses the command <c>odeint</c> and the inputs <c>hz</c> (the differential equations in the model), <c>y0</c> (the initial conditions for this solution), and <c>t_range</c> (the range of time across which to compute the solution). 
                </p>
                <p>
                  The commands in lines 16-18 work together to create the plot we see after clicking <c>Evaluate (Sage)</c>. Line 16 plots the blue <m>S(t)</m> curve, using the time inputs <c>t_range</c> and the values of <m>S(t)</m> throughout those times, which are described as <c>sol[:, 0]</c>. This means the solution <c>sol</c>, at all times, which is designated by <c>:</c>, in the initial position <c>0</c>. Python typically starts counting with 0 rather than 1, so the <m>S(t)</m> values are labeled as <c>0</c> rather than <c>1</c>. 
                </p>
                <p>
                  Line 17 plots the orange <m>I(t)</m> curve, using the time inputs <c>t_range</c> and the values of <m>I(t)</m> throughout those times, which are described as <c>sol[:, 1]</c>. Python continues its counting here, with the <m>I(t)</m> values labeled as <c>1</c>.
                </p>
              </li>
            </ol>
          </p>
        </answer>
        
        </activity>

        <p>
          Here is a summary of the Python code above, with some of the commands explained in more detail.
        </p>

        <p>
          In the lines 
          <cd>
            <cline>     import matplotlib.pyplot as plt</cline>
            <cline>     import numpy as np</cline>
            <cline>     from scipy.integrate import odeint</cline>
          </cd>
          we import online packages that make it possible for Python to do some of the things we are about to do. Saying we are importing <q>as</q> gives us a name, such as <c>plt</c> or <c>np</c>, by which to call each package and use the tools within that package.
        </p>

        <p>
          The lines 
          <cd>
            <cline>     def hz(y, t):</cline>
            <cline>       S, I = y</cline>
            <cline>       dydt = [-beta * S * I, beta * S * I]</cline>
            <cline>       return dydt</cline>
          </cd>
          define the system of differential equations, using the command <c>def</c>. The system is named <c>hz</c>, for <q>human-zombie</q>, and the <c>(y, t)</c> means that the model depends on variables <m>y</m> and <m>t</m>. The line <c>S, I = y</c> defines <m>y</m> as comprising both <m>S</m> and <m>I</m>, in that order. This means that <m>y</m> collectively represents all our dependent variables. Taking the derivative of <m>y</m>, then, means taking each of the derivatives <m>dS/dt</m> and <m>dI/dt</m>. The formulas for these derivatives, which are on the right-hand sides of the SI model, appear in order in the line <c>dydt = [-beta * S * I, beta * S * I]</c>. Finally, the line <c>return dydt</c> ends the definition and says that whenever we later use the definition, we will be using the derivatives defined in <c>dydt</c>.
        </p>
        <p>
          A quick way to think about these lines is that they define our system of differential equations and label them as <c>hz</c>.
        </p>

        <p>
          The lines 
          <cd>
            <cline>     beta = 0.02</cline>
            <cline>     y0 = [49, 1]</cline>
            <cline>     t_range = np.arange(0.0, 8.0, 0.1)</cline>
          </cd>
          provide values for <m>\beta</m>, the initial conditions <m>S(0)</m> and <m>I(0)</m>, and <m>t</m>. Any of these values can be changed, and the code can be run again, to produce a different numerical simulation of the same system of differential equations. Notice that the initial conditions are listed in the same order as how we defined the differential equations: <m>S(0)=49</m> is first, and <m>I(0)=1</m> is second. 
        </p>

        <p>
          The solution of the system of differential equations 
          <cd>
            <cline>     sol = odeint(hz, y0, t_range)</cline>
          </cd>
          is a numerical solution, and it includes multiple parts. The solution is named <c>sol</c>. The Python command <c>odeint</c> computes the solution. For <c>odeint</c> to run, it needs three things: (1) a system of differential equations <c>hz</c>, (2) initial conditions <c>y0</c> for the differential equations, and (3) a time range <c>t_range</c> across which to create the solution. Though <c>odeint</c> computes the numerical solution, it does not show us the graphical solution: the plots we create later show us these results. Instead, the numerical solution created by <c>odeint</c> consists of lists of numbers for <m>S</m> and for <m>I</m>, at the times specified in <c>t_range</c>. (If you would like to see the numerical values computed by <c>sol</c>, include the line <c>print(sol)</c> in the block of Python code above, sometime after the line <c>sol = odeint(hz, y0, t_range)</c>. When you then evaluate the code, the list of values will appear.)
        </p>

        <p>
          The lines 
          <cd>
            <cline>     plt.plot(t_range, sol[:, 0], color='blue')</cline>
            <cline>     plt.plot(t_range, sol[:, 1], color='orange')</cline>
          </cd>
          create, but do not show, the plots of graphical solutions to the system of differential equations. For each plot, we provide the input values <c>t_range</c> and the output values from the numerical solution <c>sol</c>. As described above, <c>sol</c> is a set of numbers which are the values of the populations <m>S(t)</m> and <m>I(t)</m> at all the times in <c>t_range</c>. The numbers in <c>sol</c> are structured into two lists, list 0 and list 1. (Python often counts things, such as lists, starting with 0 rather than starting with 1.) The syntax <c>sol[:,0]</c> describes all the <m>S(t)</m> data. The colon <c>:</c> means <q>all</q> the elements, and the <c>0</c> means list 0, which is the list containing values of <m>S(t)</m>. The syntax <c>sol[:,1]</c> describes all the <m>I(t)</m> data, with <c>:</c> again representing <q>all</q> and <c>1</c> representing list 1, which contains <m>I(t)</m> values.
        </p>

        <p>
          The lines above include colors for each graph, <c>'blue'</c> for the <m>S(t)</m> graph and <c>'orange'</c> for the <m>I(t)</m> graph. Stating colors is optional.
        </p>

        <p>
          Finally, 
          <cd>
            <cline>     plt.show()</cline>
          </cd>
          shows the two plots, on a shared set of axes.
        </p>
        
        <p>
          To build further understanding of how the Python code works, it helps to make several small changes to the code. Simultaneously, we continue to build intuition for how the output graph is affected by our selected parameter values, initial conditions, time range, and more.  Try this in <xref ref="exer-first-odeint-code-play-around"/>. 
        </p>

        <activity xml:id="exer-first-odeint-code-play-around">
            
        <statement>
          <p>
            Start with the same Python code as in <xref ref="exer-first-odeint-code"/> and try various small changes to the code. Identify where and how in the code to make the changes suggested below, and discuss the effects of each change on the resulting graph. Here and elsewhere, whenever we work with Python, feel free to try your own adaptations to the code. 
          </p>

          <sage>
            <input>
              import matplotlib.pyplot as plt
              import numpy as np
              from scipy.integrate import odeint
              plt.cla()
              
              def hz(y, t):
                S, I = y
                dydt = [-beta * S * I, beta * S * I]
                return dydt
              
              beta = 0.02
              y0 = [49, 1]
              t_range = np.arange(0.0, 8.0, 0.1)
              sol = odeint(hz, y0, t_range)
              
              plt.plot(t_range, sol[:, 0], color='blue')
              plt.plot(t_range, sol[:, 1], color='orange')
              plt.show()
            </input>
            <output>
            (put the graph here!!)
            </output>
            </sage>

            <ul>
              <li>
                <p>
                  Change the value of <m>\beta</m>. Identify where in the Python code to make this change, and comment on how the output graph changes when <m>\beta</m> increases or decreases. (While you can change <m>\beta</m> to any value you like, recall that a realistic outbreak model requires <m>\beta > 0</m>.)
                </p>
              </li>
              <li>
                <p>
                  Change the initial conditions so that <m>S(0) \neq 49</m>, <m>I(0) \neq 1</m>, or both. Comment on how these changes affect the resulting graph. (To stay in the realm of biologically feasible outbreaks, keep <m>S(0) > 0</m> and <m>I(0) > 0</m>.)
                </p>
              </li>
              <li>
                <p>
                  Change the time range. Continue to begin at <m>t=0</m>, but change the end time to something different than <m>t=8</m>. Discuss reasons why a modeler may want to change the time range, and identify ways in which changing the time range causes the output graph to change. 
                </p>
              </li>
              <li>
                <p>
                  Change the step size for time <m>t</m> so that Python steps forward in increments of 1.0 instead of 0.1. Identify where in the Python code to make this change, and observe any ways in which the output graph looks different after the change. 
                </p>
              </li>
            </ul>
        </statement>
          
        </activity>

        <p>
          These are all the basics for numerically solving a system of differential equations. In <xref ref="sec-estimating-beta-and-building-visualization-skills"/> we create a graph in which data points and solution curves appear all on the same set of axes. Combining these plots provides a visual way to change the value of <m>\beta</m> to improve the model's fit to data points. Then, also in <xref ref="sec-estimating-beta-and-building-visualization-skills"/>, we discuss helpful ways to visualize information on graphs, so readers can best understand the results that emerge from models.  
        </p>

      </section>

      <section xml:id="sec-estimating-beta-and-building-visualization-skills">
        <title>Estimating <m>\beta</m> and Building Visualization Skills</title>

        <p>
          To start, use information from the coding blocks above to create a single graph containing discrete data points for Humans and Zombies as well as continuous solution curves to the model for Susceptible and Infectious populations.
        </p>


        <activity xml:id="exer-combine-data-points-and-curves">
            
        <statement>
          <p>
            Combine lines of Python code from the coding blocks shown in <xref ref="expl-creating-graphs-in-python-from-the-human-zombie-game"/> and <xref ref="exer-first-odeint-code"/> so that both the individual data markers from <xref ref="expl-creating-graphs-in-python-from-the-human-zombie-game"/> and the smooth solution curves from <xref ref="exer-first-odeint-code"/> appear on the same graph.
          </p>

          <p>
            Notice before you begin: some of the same commands appear in each of the two coding blocks you are combining. You do not need to include those lines twice. 
          </p>

          <sage>
            <input>
              
            </input>
            <output>
            (put the graph here!!)
            </output>
            </sage>

            <p>
              Once you have combined the data points and solution curves into a single graph, try different values of <m>\beta</m>. Working visually, comparing data points with solution curves, can you identify a value of <m>\beta</m> that you believe produces the best correspondence between data points and solution curves? Discuss your reasoning, including a description of the features of a good correspondence between data points and solution curves.
            </p>

        </statement>

        <hint>
          <p>
            If your approach creates two separate sets of axes, try again. Can you find a way to produce just one set of axes that contains both the data points from the Zombie Game App, and also the solution curves from the system of differential equations?
          </p>
          <p>
            Regarding <m>\beta</m>, we are not seeking a mathematically precise <q>best fit</q>. Instead, we are (1) visually identifying what a good fit may look like, and (2) describing the features of a good fit, <em>from a visual perspective</em>. The features may be somewhat subjective: there is not likely to be a perfect fit, and different readers may have different priorities regarding how a good fit <q>should</q> look.
          </p>
        </hint>

        <answer>
          <p>
            One possible answer for the code is the following.
          </p>
          <p>
            <c>
import matplotlib.pyplot as plt
import numpy as np
from scipy.integrate import odeint
plt.cla()
              
t_steps = [0, 1, 2, 3, 4, 5, 6]
S_data = [49, 47, 43, 36, 20, 4, 0]
I_data = [1, 3, 7, 14, 30, 46, 50]
              
def hz(y, t):
  S, I = y
  dydt = [-beta * S * I, beta * S * I]
  return dydt
              
beta = 0.02
y0 = [49, 1]
t_range = np.arange(0.0, 8.0, 0.1)
sol = odeint(hz, y0, t_range)
plt.plot(t_steps, S_data,'o', color='blue')
plt.plot(t_steps, I_data, '*', color='orange')
plt.plot(t_range, sol[:, 0], color='blue')
plt.plot(t_range, sol[:, 1], color='orange')
plt.show()
            </c>
          </p>
          <p>
            There are many possible answers regarding the value of <m>\beta</m>. The key is to discuss what a good fit may look like. When the data and model do not fit perfectly, which is usually what will happen, then which aspects of the data do we most hope are represented in the model's solution curves?
          </p>
        </answer>
          
        </activity>

        <p>
          At this point, you have worked with enough Python code to be able to graph your own data points and your own solutions to systems of differential equations that represent disease spread. Before we complete this chapter, however, we spend additional time with Python and visualization, with the goal of designing plots that best convey the information learned from models.
        </p>

      
        <p>
          Each activity below invites you to learn by doing. Additionally: think through what YOU would like to see in plots. What features make it easier for you to interpret a graph? What features tell you best how to connect an image with a mathematical equation? 
        </p>

        <activity xml:id="exer-grid-axis-labels-comments">
          <statement>
            <p>
              Evaluate the code below. Use the Python code, as well as the resulting graphs, to answer the questions appearing below the code block.
            </p>
            <sage>
              <input>
                import numpy as np
                import matplotlib.pyplot as plt
                from scipy.integrate import odeint
                plt.cla()
                
                def model(y, t):
                  S, I = y
                  dydt = [-beta * S * I, beta * S * I]
                  return dydt
                      
                beta = 0.02
                y0 = [49, 1]
                t_range = np.arange(0.0, 8.0, 0.1)
                
                sol = odeint(model, y0, t_range)
                
                plt.plot(t_range, sol[:, 0], color='blue', label='S(t)')
                plt.plot(t_range, sol[:, 1], color='orange', label='I(t)')
                plt.legend()
                plt.xlabel('time')
                #plt.grid()
                plt.show()

              </input>
              <output>
              (put the graph here!!)
              </output>
              </sage>

              <ul>
                <li>
                  <p>
                    This code block includes an additional optional command in each of the lines starting with <c>plt.plot</c>. This command begins with <c>label</c> in each line. Where do you find these labels, <m>S(t)</m> and <m>I(t)</m>, on the plot produced below the code?
                  </p>
                </li><li>
                  <p>
                    Line 19 says <c>plt.legend()</c>. What does this mean? You can check by turning this line off, then on again. To turn it off, type <c>#</c> at the start of Line 19, and run the code again. To turn it back on, remove the <c>#</c>. Starting a line with <c>#</c> turns the line into a <em>comment</em> rather than code. This means that Python does not execute the rest of the line after the <c>#</c>.  
                  </p>
                </li><li>
                  <p>
                    Line 20 states <c>plt.xlabel('time')</c>. Do you see where this label appears in the resulting plot? If so: can you figure out how to label the vertical axis as <q>populations</q>, to represent the combination of populations <m>S(t)</m> and <m>I(t)</m>?
                  </p>
                </li><li>
                  <p>
                    Uncomment Line 21 by removing the <c>#</c> symbol and evaluate the code again. How does this change the resulting plot? What advantages or disadvantages do you see in this change?
                  </p>
                </li>
              </ul>
          </statement>

          <answer>
            <ul>
              <li>
                <p>
                  The labels <m>S(t)</m> and <m>I(t)</m> appear in the box on the graph, next to the line color of their associated plot. That is, label <m>S(t)</m> appears next to a blue line, and <m>S(t)</m> is plotted in blue. Label <m>I(t)</m> appears next to an orange line, and <m>I(t)</m> is plotted in orange. 
                </p>
              </li>
              <li>
                <p>
                  The legend is the box mentioned in the previous bullet point. Legends can be very helpful when multiple plots appear on a shared set of axes.
                </p>
              </li>
              <li>
                <p>
                  The label appears below the horizontal axis. To label the vertical axis, include this new line in the code: <c>plt.ylabel('populations')</c>.
                </p>
              </li>
              <li>
                <p>
                  A grid appears throughout the plot. This may be an advantage for better pinpointing what the values of <m>S(t)</m> and <m>I(t)</m> are at various times <m>t</m>. It may be a disadvantage if it makes the plot seem cluttered. There may be other advantages and disadvantages.
                </p>
              </li>
            </ul>

          </answer>
          
        </activity>

        <p>
          <em>Comments</em> are mentioned in <xref ref="exer-grid-axis-labels-comments"/>. In Python, comments are helpful for turning code lines on and off. One reason to do this is to troubleshoot: if code seems to not be working, turning some lines temporarily into comments can help narrow down where the problem lies. Another reason to include comments is to write notes about what is happening in the code. This is helpful if you will use this code later, or share it with other people, to make it easier for you and others to use the code in the future.
        </p>
        <p>
          The next activity shows more detailed use of comments, along with more ways to distinguish different solution curves when we plot multiple results on a shared set of axes.
        </p>

        <activity xml:id="exer-dash-dot-comments">
          <statement>
            <p>
              Notice that the code block below includes many comments. Read through the comments: do they make sense? Would you add others?
            </p>
            <p>
              Then evaluate the code and respond to the prompts below. 
            </p>
            <sage>
              <input>
                #Import packages
                import numpy as np
                import matplotlib.pyplot as plt
                from scipy.integrate import odeint
                
                plt.cla()  #Clear (delete) any past plots

                #Include data from Zombie Game App
                t_steps = [0, 1, 2, 3, 4, 5, 6]
                S_data = [49, 47, 43, 36, 20, 4, 0]
                I_data = [1, 3, 7, 14, 30, 46, 50]
                
                #Define the system of differential equations, and call it "hz"
                def hz(y, t):
                  s, i = y #Define y as consisting of s and i, in that order
                  dydt = [-beta * s * i, beta * s * i] #These formulas are the right-hand sides of the SI model
                  return dydt
                      
                beta = 0.02 #Give a value to beta
                y0 = [49, 1] #Set initial conditions for Susceptibles and Infectious, in that order
                t_range = np.arange(0.0, 8.0, 0.1) #Set the time range, then set the size of the time steps to use when "stepping through" to numerically solve
                
                sol = odeint(hz, y0, t_range) #Give the name "sol" to the lists of numerical values in the solution, and give "odeint" the information needed to solve
                
                # Plotting commands are below
                plt.plot(t_steps, S_data,'o', markersize=12, color='blue')
                plt.plot(t_steps, I_data, '*', markersize=5, color='orange')
                plt.plot(t_range, sol[:, 0], color='blue', linestyle='dashed', linewidth=2, label='S(t)')
                plt.plot(t_range, sol[:, 1], color='orange', linestyle='dotted', linewidth=3, label='I(t)')
                plt.legend()
                plt.xlabel('time')
                plt.ylabel('populations')
                plt.show()
              </input>
              <output>
              (put the graph here!!)
              </output>
              </sage>
              
              <ul>
                <li>
                  <p>
                    What do the <c>linestyle</c> commands do? Include them in Lines 26 and 27, when plotting <c>S_data</c> and <c>I_data</c>, to connect the markers from the Zombie Game App data points with the same style lines as those that solve the SI model.
                  </p>
                </li>
                <li>
                  <p>
                    What do the <c>markersize</c> commands do? Try different numerical values to find what you like.
                  </p>
                </li>
                <li>
                  <p>
                    What do the <c>linewidth</c> commands do? Try different numerical values to find what you like.
                  </p>
                </li>
                <li>
                  <p>
                    Label the data points from the Zombie Game App so that they appear in the legend.
                  </p>
                </li>                
                <li>
                  <p>
                    Change the label on the horizontal axis to say <q>time (rounds)</q> to make the units of time more clear.
                  </p>
                </li>
              </ul>



              <!-- Linestyles: https://matplotlib.org/stable/gallery/lines_bars_and_markers/linestyles.html#linestyles -->
          </statement>
        </activity>

      </section>

      <exercises xml:id="exercises-visualization-graphing-model-results-and-data">
        <exercise number="1">
          <statement>
            <p>
             Start with the basic SI model in Python. Code for this appears in <xref ref="exer-first-odeint-code"/> and <xref ref="exer-first-odeint-code-play-around"/>. Change the code in the ways described below. For each change, list the original Python code, specify what updates you make, provide an image of the resulting graph, and describe in words how the resulting graph looks different as a result of the change you made. Keep the change in part (a) when you update part (b), then keep all these changes when you update part (c).
            </p>
          <ol>
            <li>
              <p>
                Increase <m>S(0)</m> to 200.
              </p>
            </li>
            <li>
              <p>
                Adjust <m>\beta</m> so that the Susceptible population is approximately 100 on day 10. (Notice that this update requires changing more than just the value of <m>\beta</m>.)
              </p>
            </li>
            <li>
              <p>
                Increase <m>I(0)</m> to 10.
              </p>
            </li>
          </ol>
        </statement>
          <hint>
            <p>
              The following figures, in order, are possible results.
            </p>
            <figure width="90%" xml:id="fig-visualize-1a">
              <caption>A possible outcome from setting <m>S(0)=200</m>.</caption>
              <image source="Visualize_HW_1a.png" width="80%">
                  <description>Sample solution graph for setting <m>S(0)</m> to 200.</description>
              </image>
            </figure>
            <figure width="90%" xml:id="fig-visualize-1b">
              <caption>A possible outcome when adjusting <m>\beta</m> so that <m>S(10) \approx 100</m>. The graph includes a grid, and it extends time to <m>t=15</m>.</caption>
              <image source="Visualize_HW_1b.png" width="80%">
                  <description>Sample solution graph for setting <m>\beta</m> so that <m>S(100) \approx 10</m>. The graph includes a grid, and it extends time to <m>t=15</m>.</description>
              </image>
            </figure>
            <figure width="90%" xml:id="fig-visualize-1c">
              <caption>A possible outcome when setting <m>I(0)=10</m>.</caption>
              <image source="Visualize_HW_1c.png" width="80%">
                  <description>Sample solution graph for setting <m>I(0)</m> to 10.</description>
              </image>
            </figure>
          </hint>
        </exercise>
        <exercise number="2">
          <p>
            Open the <url href="https://nelsong1997.github.io/zombie_game/">Zombie Game App</url> and run it, creating a data set that is (hopefully) different than that in <xref ref="fig-human-zombie-data-table"/>. Use Python to plot these data points for humans and zombies. On the same set of axes, plot the graphical solutions to the differential equations in the SI model. Adjust <m>\beta</m> so the SI model solution curves fit adequately well with the generated data points. Include a short discussion of ways in which the curves fit the data well, and ways in which the fit is not as good. 
          </p>
        </exercise>
        <exercise number="3">
          <p>
            Look up information online about making data visualization more accessible to people who have some version of colorblindness. Read multiple sources on this topic, and use them to respond to the following questions.  
          </p>
          <ol>
            <li>
              <p>
                What sorts of color palettes can work relatively well to make a graph more accessible to a colorblind individual?
              </p>
            </li>
            <li>
              <p>
                What are some ways that data markers can be used to improve graph accessibility?
              </p>
            </li>
            <li>
              <p>
                How can different line styles be used to improve graph accessibility?
              </p>
            </li>
            <li>
              <p>
                What are yet additional ways you can use Python features to create graphs that are accessible to as many people as possible?
              </p>
            </li>
          </ol>
        </exercise>
      </exercises>
      

    </chapter>



    <chapter xml:id="ch-compartmental-diagrams">
      <title>Compartmental Diagrams</title>

      <introduction xml:id="intro-compartmental-diagrams">
      <objectives>
        <ul>
          <li>
            <p>
              Begin to use compartmental diagrams
            </p>
          </li>
          <li>
            <p>
              Learn the rules and assumptions for drawing compartmental diagrams
            </p>
          </li>
          <li>
            <p>
              Connect compartmental diagrams with their corresponding systems of differential equations
            </p>
          </li>
          <li>
            <p>
              Build understanding of units and rate parameters in models
            </p>
          </li>
        </ul>
      </objectives>

      <p>
        In <xref ref="ch-zombies-can-math-help" /> we simulated a simple outbreak. This outbreak can be modeled using the <em>system of ordinary differential equations</em> appearing in <xref ref="eq-S-in-SImodel" /> and <xref ref="eq-I-in-SImodel" />. Here is the system again:  
      </p>

      <md>
        <mrow>\frac{dS}{dt} \amp = -\beta S I </mrow>
        <mrow>\frac{dI}{dt} \amp = \beta S I. </mrow>
      </md>

      <p>
        This style of model is called a <term>compartmental model</term> because the individuals in our model are designated by categories called <term>compartments</term>; in this case, the compartments are <q>Susceptibles</q> and <q>Infectious</q>. In <xref ref="ch-zombies-can-math-help" /> we made calculus-based observations of the differential equations in this model. We can draw the dynamics of the model in a <term>compartmental diagram</term>, as shown in <xref ref="fig-SI-compartmental-diagram" />. 
      </p>

      <figure xml:id="fig-SI-compartmental-diagram">
        <caption>The compartmental diagram for one possible SI model, where <q>S</q>stands for <q>Susceptible</q> and <q>I</q> stands for <q>Infectious</q></caption>
          <image width="50%">
          <description>(Write this)</description>
            <latex-image>
            \begin{tikzpicture}
            \draw [thick] [black] (0,0) -- (2,0);
            \draw [thick] [black] (2,0) -- (2,2);
            \draw [thick] [black] (2,2) -- (0,2);
            \draw [thick] [black] (0,2) -- (0,0);
            \node [black] at (1,1) {\Huge $S$};
            \draw [thick] [->] (2.1,1) to (3.9,1); 
            \node at (3,1.5) {\Large $\beta SI$};
            \draw [thick] [black] (4,0) -- (6,0);
            \draw [thick] [black] (6,0) -- (6,2);
            \draw [thick] [black] (6,2) -- (4,2);
            \draw [thick] [black] (4,2) -- (4,0);
            \node [black] at (5,1) {\Huge $I$};
            \end{tikzpicture}
            </latex-image>
           </image>
      </figure>

      <p>
        In this text, we regularly represent the dynamics of an outbreak using both compartmental model drawings and systems of differential equations. When we are careful in how we draw our compartmental diagrams, we can use these diagrams interchangeably with their corresponding systems of differential equations. In this chapter, we learn the vocabulary of compartmental models, as well as ways to draw compartmental diagrams so they clearly and completely represent the information contained in their corresponding systems of differential equations.
      </p>
      <p>
        We begin by trying a different version of the human<ndash/>zombie game. We then ask you to use the intuition you are building to think through how the compartmental diagram should look for this human<ndash/>zombie game variation. After that, we discuss more details about compartmental diagrams. <em>You are strongly encouraged to try to build your own compartmental diagram before moving on to the text's discussion of the details.</em>
      </p>

      </introduction>
      
      <exploration xml:id="expl-activity-varying-the-human-zombie-game">
        <title>Varying the Human<ndash />Zombie Game</title>
        <introduction>
          <p>
            In the original <url href="https://nelsong1997.github.io/zombie_game/">Zombie Game App</url>, once an individual becomes a zombie, they are always a zombie. This means that no one leaves the Infectious compartment. 
          </p>
          <p>
            Suppose, instead, that zombies do not last forever. Instead, after some number of days, the zombies die (again), or in other words, the zombies become inactive. The number of days they remain Infectious before becoming inactive can be stated in the app.
          </p>
        </introduction>
        
        <task>
          <statement>
            <p>
              <em>Before trying this scenario in the app</em>, think through how zombie death, and different zombie lifespans, would change the outcomes of the simulation. In particular, think carefully about these questions:
            </p>
            <ul>
              <li>
                <p>
                  What do you <em>expect</em> will happen if Zombies die, that is, they become inactive and unable to spread infection? Whether you feel very certain, or somewhat uncertain, articulate some outcomes that you think will occur with this game variation.
                </p>
              </li>
              <li>
                <p>
                  How might your expected outcomes differ from those in the original model?
                </p>
              </li>
              <li>
                <p>
                  Outcomes might be measured by the table of data, by the graphs, by the timing of how infection spreads, by the numbers of survivors, or in other ways. For each of your expectations about how the outcomes may change, what support can you show for why this expectation makes sense?
                </p>
              </li>
            </ul>
            <p>
              This exercise is not about right or wrong ideas, but instead is about building hypotheses, comparing the hypotheses with data, and developing deeper understanding of what the model shows.
            </p>
          </statement>
        </task>
        <task>
          <statement>
            <p>
              After you have thought through how the outcomes will change in a variation, use the app to generate data.
            </p>
            <p>
              To set up this variation in the Zombie Game app, check the box for <q>Zombie Mortality</q>, shown by the lower red arrow in  <xref ref="fig-zombie-app-mortality" />. A box then appears for <q>Zombie Lifespan (days)</q>, shown by the upper red arrow in <xref ref="fig-zombie-app-mortality" />. Try setting Zombie Lifespan to 1, then 2, then 3. For each length of time, run several simulations, save your data sets, and compare the outcomes.
            </p>
            <figure width="90%" xml:id="fig-zombie-app-mortality">
              <caption>Checking the box for <q>Zombie Mortality</q> and setting a value for <q>Zombie Lifespan (days)</q></caption>
              <image source="ZombieApp_Mortality.png" width="60%">
                  <description>Screen image from the Zombie Game App, showing the checked box for <q>Zombie Mortality</q> and the <q>Zombie Lifespan (days)</q> that appears</description>
              </image>
            </figure>
          </statement>
        </task>
        <!-- Edit this figure to point at "Zombie Mortality" and "Zombie Lifespan" with an arrow, or circle them, or something -->
        <task>
          <statement>
            <p>
            Compare the results with the ideas you generated in part (a). <em>How similar or different are the actual results, compared with what you thought?</em>
            </p>
          </statement>
        </task>
        <task>
          <statement>
            <p>
              What else do you observe? Consider how many humans or zombies survive till the end, and consider how much these numbers vary from simulation to simulation. Consider how many days the outbreak lasts. Make note of any additional observations you have, and reach out to other people trying this experiment to see how your results compare with theirs.
            </p>
          </statement>
        </task>
        <task>
          <statement>
            <p>
              <em>Before moving on to the next section</em>, use your intuition to draw a possible compartmental diagram for the outbreak you just simulated in this Exploration. The only compartmental diagram we have seen so far is in <xref ref="fig-SI-compartmental-diagram"/>: use this diagram as an example, and make changes to match your simulation.
            </p>
          </statement>
        </task>
        
      </exploration>
      
      <section xml:id="section-compartmental-diagrams-vocabulary-and-comments">
        <title>Compartmental Diagrams: Vocabulary and Comments</title>

        <p>
          In this section, we give a general description of compartmental diagrams. As you read, check in with the intuition you have been building: do these ideas fit with your understanding so far? Soon, in <xref ref="sec-from-zombie-game-variation-to-compartmental-diagram"/>, we will connect these general ideas about compartmental diagrams with the specific model you constructed in <xref ref="expl-activity-varying-the-human-zombie-game"/>.
        </p>
        <p>
          A compartmental diagram is made up of boxes and arrows, each labeled to show what it represents. The boxes are called <term>compartments</term> and represent mutually distinct groups of individuals. The arrows indicate the possible ways that individuals can relocate from one compartment to another.
        </p>
        <p>
          When we say <q>mutually distinct</q>, we mean that at any moment in time, an individual is in exactly one compartment: no more, no fewer. This means our entire population is fully accounted for at all times because everyone appears in some compartment. We also notice that we cannot double-count individuals, as they cannot be in more than one compartment at a time.
        </p>
        <p>
          Because our models use continuous time and differential equations, we will sometimes compute non-integer values for the number of individuals in some compartments. We should think through this carefully. If, for instance, we find that at some time we have 13.6 Susceptibles and 36.4 Infectious, we are not saying that we have 13 Susceptibles, plus 36 Infectious, plus one individual who is split up to be 60% Susceptible and 40% Infectious. Instead, the differential equation model is telling us on average what happens, across many possible simulations or many possible outcomes. In computing an <em>on average</em> outcome, non-integer values are possible. If we wish to refer to actual numbers of people, we can round to the nearest integer, or use language that reflects the <em>on average</em> meaning of our model.
        </p>
        <p>
          When we use a compartmental diagram, we should carefully define and describe all our terms. The definitions and descriptions may change in different models, so we should not assume that <m>t</m>, <m>S</m>, <m>I</m>, or other variables always have the same meaning. Time, <m>t</m>, may be measured in days, weeks, or some other unit, and we should indicate the unit. Here are possible descriptions for <m>S</m> and <m>I</m> based on the human<ndash />zombie game in <xref ref="ch-zombies-can-math-help" />: <m>S</m> stands for the Susceptible population, meaning people who do not have the zombie disease yet but could become ill with this disease, and <m>I</m> stands for the Infectious population, meaning individuals who are currently contagious and currently showing symptoms of the zombie disease. In other outbreaks, and therefore in other models, these descriptions may change. As just one example, <m>I</m> in a different model may refer to individuals who are Infectious in the sense that they are contagious, but they may or may not be showing symptoms. Modelers should fully state the specific definitions of <m>S</m>, <m>I</m>, or other populations, in their models. 
        </p>

        <p>
          The term <m>\beta SI</m> indicates flow from <m>S</m> to <m>I</m>. This term indicates that the flow depends on both the population <m>S</m> and the population <m>I</m>. When either population is very small, flow is relatively small. When both populations are relatively large, their product is large and therefore flow is relatively large. This sort of term is called a <em>mass action</em> term, from the Law of Mass Action in chemistry. The idea of mass action is just one way to model flow from one compartment to another; we will study other formulas for flow.
        </p>

<!-- Check verb tense, esp in next paragraph: make all present, or keep some past??? -->

        <p>
          The letters <m>S</m>, <m>I</m>, and <m>t</m> are variables in the model. The Greek letter <m>\beta</m> is a parameter. We use the following conventions for letters in most of the models we study: 
        <ul>
          <li>
            <p>
              Time is denoted as the <em>lowercase letter</em> <m>t</m>.
            </p>
          </li>
          <li>
            <p>
              We use <em>capital letters</em> such as <m>S</m> and <m>I</m> to indicate populations of people, which are typically functions of time, so that <m>S=S(t)</m>, <m>I=I(t)</m>.
            </p>
          </li>
          <li>
            <p>
              <em>Greek letters</em> such as <m>\beta</m> represent some aspect of how a disease progresses and are called <term>parameters</term>.
            </p>
          </li>
        </ul>
             A parameter may seem to behave a bit like a variable, since it can take on different values. However, parameters play a different role than variables in our models. In a given simulation, <em>we use biological information to set all parameter values</em>. By contrast, we choose only the initial values of our variables, that is, the values when <m>t=0</m>, and then the simulation reveals the values of each variable at later points in time. For instance, in the human<ndash />zombie example, we start at <m>t=0</m> with 49 humans and 1 zombie. Writing this in mathematical terms: <m>S(0)=49</m> and <m>I(0)=1</m>. After <m>t=0</m>, the populations of Susceptibles and Infectious depend on the outcome of the simulation. Even the length of time for the simulation depends on how long it takes the Infectious zombies to convert all the Susceptible humans.
        </p>
        
      </section>

      

      
      
      <section xml:id="sec-from-zombie-game-variation-to-compartmental-diagram">
        <title>From Zombie Game Variation to Compartmental Diagram</title>
        
        <p>
          The Zombie Game variation in <xref ref="expl-activity-varying-the-human-zombie-game" /> introduces a new category of individuals, beyond Susceptibles and Infectious. This new category corresponds to a new compartment, compared with <xref ref="fig-SI-compartmental-diagram" />, in the model's compartmental diagram. 
        </p>
        <p>
          When zombies die, they leave the Infectious compartment and can no longer infect the Susceptibles. It is typical to represent these dynamics by introducing a Removed (R) compartment for the individuals who were zombies but have then become inactive. Our model then includes S, I, and R compartments, so we call it an SIR model.
          <aside>
            <p>
              We typically say each of the letters in SIR when naming this model aloud. That is, we refer to the <q>S</q> <q>I</q> <q>R</q> model, not the <q>sir</q> model. 
            </p>
          </aside>  A compartmental diagram representing the dynamics of this SIR model appears in <xref ref="fig-SIR-compartmental-diagram" />.
        </p>

        <figure xml:id="fig-SIR-compartmental-diagram">
        <caption>One possible <m>SIR</m> (Susceptible, Infectious, Removed) compartmental diagram</caption>
          <image width="70%">
          <description>(Write this)</description>
            <latex-image>
            \begin{tikzpicture}
              \draw [thick] [black] (0,0) -- (2,0);
              \draw [thick] [black] (2,0) -- (2,2);
              \draw [thick] [black] (2,2) -- (0,2);
              \draw [thick] [black] (0,2) -- (0,0);
              \node [black] at (1,1) {\Huge $S$};
              \draw [thick] [->] (2.1,1) to (3.9,1); 
              \node at (3,1.5) {\Large $\beta SI$};
              \draw [thick] [black] (4,0) -- (6,0);
              \draw [thick] [black] (6,0) -- (6,2);
              \draw [thick] [black] (6,2) -- (4,2);
              \draw [thick] [black] (4,2) -- (4,0);
              \node [black] at (5,1) {\Huge $I$};
              \draw [thick] [->] (6.1,1) to (7.9,1); 
              \node at (7,1.5) {\Large $\gamma I$};
              \draw [thick] [black] (8,0) -- (10,0);
              \draw [thick] [black] (10,0) -- (10,2);
              \draw [thick] [black] (10,2) -- (8,2);
              \draw [thick] [black] (8,2) -- (8,0);
              \node [black] at (9,1) {\Huge $R$};
            \end{tikzpicture}
            </latex-image>
           </image>
      </figure>

      <p>
        In this diagram, we include the S and I compartments used previously, while also allowing the Infectious zombies to leave the I compartment and enter the R compartment, where they stay for the rest of the simulation. The mathematical formula for movement from I to R is <m>\gamma I</m>. The parameter <m>\gamma</m> (the Greek letter <em>gamma</em>) represents the rate at which individuals leave <m>I</m> and enter <m>R</m>. Larger values of <m>\gamma</m>, for instance, mean that zombies become inactive more rapidly than with smaller values of <m>\gamma</m>. This formula indicates that neither Susceptibles nor Removed individuals influence movement from I to R: instead, only the number of Infectious people, and a rate based on how long they remain zombies, determine this movement between compartments. 
      </p>
      <activity xml:id="activity-sir-diagram-and-des">
        <statement>
          <p>
            Take time to think through the compartmental diagram in <xref ref="fig-SIR-compartmental-diagram"/>. 
          </p>
          <ol>
            <li>
              <p>
                Does <xref ref="fig-SIR-compartmental-diagram"/> match your sense of how individuals progress through the simulation? Are all individuals always in exactly one compartment, that is, in <em>at least one</em> compartment and also <em>no more than one</em> compartment at any given time?
              </p>
            </li>
            <li>
              <p>
                Using the information in the compartmental diagram, write the differential equations for this SIR model.
              </p>
            </li>
          </ol>
        </statement>
        <hint>
          <ol>
            <li>
              <p>
                Have you considered whether all individuals must pass through all three compartments?
              </p>
            </li>
            <li>
              <p>
                We saw in <xref ref="sec-a-first-model"/> that the term named on an arrow appears twice in the differential equations: once as a negative term, in the equation for the compartment the arrow is exiting, and once as a positive term, in the equation for the compartment the arrow is entering.
              </p>
            </li>
          </ol>
        </hint>
        <answer>
          <ol>
            <li>
              <p>
                It should be true that individuals are in exactly one compartment at a time, but with all claims such as this, you should convince yourself or else ask questions about it. It should also be true that individuals cannot progress in any order other than what the compartmental diagram shows. However, in some simulations, some individuals may not leave compartment S. By contrast, with <xref ref="expl-activity-zombie-game"/> and the SI model, all individuals progress from the S compartment to the I compartment.
              </p>
            </li>
            <li>
              <p>
                The differential equations for this SIR model are:
                  <md>
                    <mrow>\frac{dS}{dt} \amp = -\beta S I </mrow>
                    <mrow>\frac{dI}{dt} \amp = \beta S I - \gamma I </mrow>
                    <mrow>\frac{dR}{dt} \amp = \gamma I. </mrow>
                  </md>
              </p>
            </li>
          </ol>
        </answer>
      </activity>

      <!-- <p>
        Be sure to talk about gamma and how to estimate it, here or in Ch 4!!!
      </p> -->
      

<!-- NAME THE SECTION HERE !!!!! AS DESCRIBED IN PRIOR PARAGRAPH -->

      <!-- <p>
        (MOVE THIS TO CHAPTER 13!!! OR ELSEWHERE....) For the <q>Introduce an incubation period</q> variation in (subsec no longer exists), we do not include the compartment R, but we do include a compartment for individuals who are in an incubation period. A typical way to label this compartment is E, which stands for Exposed. (Notice that we already are using I for Infectious, so we cannot use I for Incubating.) The word Exposed may be misleading, since in daily life, we tend to think of being exposed to illness as meaning that a person may or may not become sick. Instead, in our model, the Exposed individuals will definitely become sick. For this reason, in this text, we will refer to the E compartment as <term>Exposed-and-incubating</term>. This model then includes the S, E, and I compartments, so we call it SEI. A compartmental diagram representing the dynamics of this simulation appears in <xref ref="fig-SEI-compartmental-diagram" />.
      </p> -->
      
      <!-- <p>
        In this diagram, after a human comes into contact with a zombie, the human moves out of the Susceptible compartment and into the Exposed-and-incubating compartment. The formula on the arrow from S to E is <m>\beta S I</m>, since the movement out of S depends on an interaction between S and I. The mathematical formula for movement from E to I is <m>\kappa E</m>. The parameter <m>\kappa </m> (the Greek letter <em>kappa</em>) represents the rate at which individuals leave E and enter I.
      </p> -->

      </section>

      <section xml:id="sec-estimating-gamma-and-other-rates">
        <title>Estimating Gamma and Other Rates</title>

        <p>
          Consider an SIR model as represented in <xref ref="fig-SIR-compartmental-diagram"/>. Let us think about what the values of <m>\gamma</m> should be. 
        </p>
        <activity xml:id="activity-understanding-gamma-pt1">
          <statement>
            <p>
              What would it mean if <m>\gamma =1</m>, <m>\gamma =0.5</m>, or <m>\gamma =0.25</m>? Specifically: what fraction of the members of the I compartment leaves I <em>within one time step</em> for each of these values of <m>\gamma</m>? Similarly, what percentage of the members of the I compartment leaves I <em>within one time step</em> for each value of <m>\gamma</m>?
            </p>
          </statement>
          <answer>
            <p>
              If <m>\gamma =1</m>, then all members of compartment I, that is, <m>100\%</m> of the members, leave I at each time step. If <m>\gamma =0.5</m>, then half the members, that is, <m>50\%</m>, leave I at each time step. And if <m>\gamma =0.25</m>, then one-quarter of the members, that is, <m>25\%</m>, leave I at each time step.
            </p>
          </answer>
        </activity>
        <activity xml:id="activity-understanding-gamma-pt2">
          <statement>
            <p>
              Using what you learned in <xref ref="activity-understanding-gamma-pt1"/>, think further about <m>\gamma =1</m>, <m>\gamma =0.5</m>, or <m>\gamma =0.25</m>. For each of these values of <m>\gamma</m>, how long does a typical individual remain in compartment I before leaving for compartment R?
            </p>
          </statement>
          <answer>
            <p>
              If <m>\gamma =1</m>, then all members of compartment I leave at each time step, so a typical individual stays in I for one time step. If <m>\gamma =0.5</m>, then half the members of I leave at each time step, so a typical individual stays in I for approximately two time steps. And if <m>\gamma =0.25</m>, then one-quarter of the members of I leave at each time step, so a typical individual stays in I for approximately four time steps.
            </p>
          </answer>
        </activity>
        <p>
          We begin to see in <xref ref="activity-understanding-gamma-pt2"/> that we can understand <m>\gamma</m> intuitively in relationship to how long an individual is in the I compartment. A compartmental model does not track individuals directly, and the responses in <xref ref="activity-understanding-gamma-pt2"/> do not suggest that every individual in an outbreak is sick for a precise amount of time that is shown by <m>\gamma</m>. Instead, the relationship between <m>\gamma</m> and length of time in compartment I shows how long <em>on average</em> individuals stay in compartment I. We can write this relationship mathematically:
        </p>
        <mdn>
          <mrow xml:id="eq-gamma-estimate">\frac{1}{\gamma} \amp \approx \mbox{length of time an individual spends in compartment I.} </mrow>
        </mdn>
        <p>
          Notice that <m>1/\gamma</m> is an amount of time. This means that the units of <m>\gamma</m> are <m>1/\mbox{time}</m>. This observation corresponds with <m>\gamma</m> being a <term>rate</term>.
        </p>
        <p>
          Many, but not all, of the parameters in the models in this text are rates. Usually, when a parameter in a compartmental model is a rate, we can estimate its value in a similar way to how we estimate <m>\gamma</m> in <xref ref="eq-gamma-estimate"/>. 
        </p>
        <p>
          In particular, notice that <m>\beta</m> in our model can not be a rate. We see this when we recognize that each term in a model equation must have the same units: otherwise, we cannot set terms equal to each other, or add or subtract terms. Explore how this works in <xref ref="activity-introducing-units"/>.
        </p>
        <activity xml:id="activity-introducing-units">
          <statement>
            <p>
              In <xref ref="activity-sir-diagram-and-des"/>, we developed the following system of differential equations for the SIR model shown in <xref ref="fig-SIR-compartmental-diagram"/>:
            </p>
            <mdn>
              <mrow xml:id="eq-SIR-model-S">\frac{dS}{dt} \amp = -\beta S I </mrow>
              <mrow xml:id="eq-SIR-model-I">\frac{dI}{dt} \amp = \beta S I - \gamma I </mrow>
              <mrow xml:id="eq-SIR-model-R">\frac{dR}{dt} \amp = \gamma I. </mrow>
            </mdn>
            <p>
              Recall that each of the variables <m>S</m>, <m>I</m>, and <m>R</m> represents some average number of individuals. This means that the units for each of <m>S</m>, <m>I</m>, and <m>R</m> are <em>population</em>.
                <aside>
                  <p>
                    Alternately, we could call these units <em>people</em> or <em>individuals</em>.
                  </p>                  
                </aside>  
              We also just saw from the discussion of <xref ref="eq-gamma-estimate"/> that the units of <m>\gamma</m> are <m>1/\mbox{time}</m>. 
            </p>
            <ol>
              <li>
                <p>
                  Consider the equation <m>\frac{dR}{dt} = \gamma I</m> from the SIR model. What are the units of the term <m>\frac{dR}{dt}</m> on the left-hand side, and what are the units of the term <m>\gamma I</m> on the right-hand side? Can you confirm that these two terms have the same units?
                </p>
              </li>
              <li>
                <p>
                  Next, consider the equation <m>\frac{dI}{dt} = \beta S I - \gamma I</m> from the SIR model. Start by using the first part of this activity to determine the units of <m>\frac{dI}{dt}</m> and <m>\gamma I</m>. Next, in order for the units to be the same for all three terms, what should the units be for <m>\beta S I</m>? Finally, knowing the units of <m>\beta S I</m>, what must be the units for <m>\beta</m>?
                </p>
              </li>
              <li>
                <p>
                  Use your results from the first two parts of this activity to confirm that the units are the same on both sides of the equation <m>\frac{dS}{dt} = -\beta S I</m> in the SIR model.
                </p>
              </li>
            </ol>
          </statement>
          <answer>
            <ol>
              <li>
                <p>
                  The term <m>\frac{dR}{dt}</m> has units <m>\mbox{(population)} / \mbox{(time)}</m> because the units of <m>R</m> in the numerator are <em>population</em> and the units of <m>t</m> in the denominator are <em>time</em>.
                </p>
                <p>
                  The term <m>\gamma I</m> has units <m>\mbox{(population)} / \mbox{(time)}</m> because <m>\gamma</m> has units <m>1/\mbox{time}</m> and <m>I</m> has units (population).
                </p>
                <p>
                  Both sides have the same units, namely <m>\mbox{(population)} / \mbox{(time)}</m>.
                </p>
              </li>
              <li>
                <p>
                  The terms <m>\frac{dI}{dt}</m> and <m>\gamma I</m> have units <m>\mbox{(population)} / \mbox{(time)}</m>, for similar reasons to those described in the first part of this activity.
                </p>
                <p>
                  The term <m>\beta S I</m> should therefore also have units <m>\mbox{(population)} / \mbox{(time)}</m>. Since there are two populations, <m>S</m> and <m>I</m>, multiplied in the numerator, this means that <m>\beta</m> must have units <m>1/(\mbox{population} \cdot \mbox{time})</m>.
                </p>
              </li>
              <li>
                <p>
                  The term <m>\frac{dS}{dt}</m> has units <m>\mbox{(population)} / \mbox{(time)}</m>, for similar reasons to those described in the first part of this activity.
                </p>
                <p>
                  Within the term <m>-\beta S I</m>, we saw in the second part of this activity that <m>\beta</m> has units <m>1/(\mbox{population} \cdot \mbox{time})</m>. Both <m>S</m> and <m>I</m> have units (population). Multiplying together the three terms <m>\beta</m>, <m>S</m>, and <m>I</m>, the resulting units are <m>\mbox{(population)} / \mbox{(time)}</m>. 
                </p>
                <p>
                  These observations confirm that the units are the same on both sides of the equation <m>\frac{dS}{dt} = -\beta S I</m>.
                </p>
              </li>
            </ol>
          </answer>
        </activity>
        <p>
          After completing <xref ref="activity-introducing-units"/>, we recognize that in our SIR model, the units of <m>\beta</m> are not <m>1/\mbox{time}</m>. Therefore <m>\beta</m> is not a rate, and we cannot estimate the value of <m>\beta</m> similarly to how we estimate the value of <m>\gamma</m>. Indeed, estimating the value of <m>\beta</m> will require different methods. In <xref ref="ch-visualization-graphing-model-results-and-data"/> we discuss estimating <m>\beta</m> visually by comparing our model with data. In later chapters, we discuss other approaches to estimating <m>\beta</m>. 
        </p>

        <!-- COME BACK HERE AND SAY MORE ABOUT WHERE AND HOW WE ESTIMATE BETA!!! -->
        <!-- COME BACK HERE AND SAY MORE ABOUT WHERE AND HOW WE ESTIMATE BETA!!! -->
        <!-- COME BACK HERE AND SAY MORE ABOUT WHERE AND HOW WE ESTIMATE BETA!!! -->
      
      </section>

    <exercises xml:id="exercises-ch-compartmental-diagrams">
      <exercise number="1">
        <p>
          Use the ideas and website suggestions of <xref ref="ch-prelude-diseases-in-popular-news"/> to determine how long individuals are infectious with measles. Cite your source(s).<fn>Include links to any web pages, the title of each web page used, the name of the government agency or other publisher of each web page, and the date you most recently accessed the web page.</fn> Then suppose you are creating an SIR model for the spread of measles. What value would you use for <m>\gamma</m>? Explain your reasoning.
        </p>
      </exercise>
      <exercise number="2">
        <p>
          Compare your response to exercise 1 in <xref ref="exercises-ch-compartmental-diagrams"/> with <url href="https://people.com/health/measles-outbreak-spreads-21-states-dc/">this article on measles</url> from <xref ref="ch-prelude-diseases-in-popular-news"/>. What are the similarities, and the differences, between how the CDC and People magazine describe how long measles is infectious? 
        </p>           
      </exercise>
      <exercise number="3">
        <p>
          Use the ideas and website suggestions of <xref ref="ch-prelude-diseases-in-popular-news"/> to determine how long individuals are infectious with RSV. Cite your source(s).<fn>Include links to any web pages, the title of each web page used, the name of the government agency or other publisher of each web page, and the date you most recently accessed the web page.</fn> Then suppose you are creating an SIR model for the spread of RSV. What value would you use for <m>\gamma</m>? Explain your reasoning.
        </p>
      </exercise>
    </exercises>

    </chapter>
    

      
    <chapter xml:id="ch-population-values-and-the-basic-reproduction-number-R0">
      <title>Population Values and the Basic Reproduction Number <m>\mathcal{R}_0</m></title>

      <introduction xml:id="intro-population-values-and-the-basic-reproduction-number-R0">
        <objectives>
          <ul>
            <li>
              <p>
                Develop the technique of <em>sign analysis</em> for analyzing outcomes of compartmental models
              </p>
            </li>
            <li>
              <p>
                Investigate relationships between a compartmental disease model, the size of the total population being modeled, and each compartment's long-term population value 
              </p>
            </li>
            <li>
              <p>
                Introduce the basic reproduction number <m>\mathcal{R}_0</m> and its implication for outbreaks 
              </p>
            </li>
          </ul>
        </objectives>
  
        <p>
          By now, we have studied models from several perspectives. In <xref ref="ch-zombies-can-math-help"/> and the Zombie Game App, we generated data for an outbreak, constructed tables and graphs of data, and thought through how all these pieces of information fit together. <xref ref="ch-zombies-can-math-help"/> then introduced using a system of differential equations for describing the relationships. The Python code in <xref ref="ch-visualization-graphing-model-results-and-data"/> generated images of data points and solution curves for systems of differential equations. Finally, and crucially, we began drawing compartmental diagrams in <xref ref="ch-compartmental-diagrams"/>. 
        </p>
        <p>
          These multiple forms of describing models all work together. They allow us to understand models and their results through graphs, equations, data, and diagrams. Now that we have these tools for discussing models, we take time to mathematically analyze models. Some of this analysis is necessary for confirming that our models make sense in relationship to the real world. Additional analysis of models gives us ways to think about controlling outbreaks.  
        </p>
        <p>
          Our starting point, using a combination of visual and equation-based understanding, begins in <xref ref="expl-rise-and-fall-of-an-epidemic"/>.
        </p>
  
        </introduction>
        
        <exploration xml:id="expl-rise-and-fall-of-an-epidemic">
          <title>Rise and Fall of an Epidemic</title>
          <introduction>
            <p>
              We first saw the SIR model in <xref ref="ch-compartmental-diagrams"/>. The compartmental diagram appears in <xref ref="fig-SIR-compartmental-diagram"/> and the system of differential equations is the following:
            </p>
            <md>
              <mrow>\frac{dS}{dt} \amp = -\beta S I </mrow>
              <mrow>\frac{dI}{dt} \amp = \beta S I - \gamma I </mrow>
              <mrow>\frac{dR}{dt} \amp = \gamma I. </mrow>
            </md>
            <p>
              Throughout this Exploration, continue to connect the model, graphs of its solution curves, and real-world meaning.
            </p>
          </introduction>
          
          <task>
            <statement>
              <p>
                Look at the expressions on the right-hand sides of the differential equations for the SIR model.  
              </p>
              <ul>
                <li>
                  <p>
                    Which terms are positive? Which terms are negative? What does this tell you about how each population can flow through the compartments? 
                  </p>
                </li>
                <li>
                  <p>
                    For each differential equation, what signs (<m>+</m>, <m>-</m>, or <m>0</m>) are possible on the right-hand side? What does this tell you about the solution curves for the model? 
                  </p>
                </li>
              </ul>
            </statement>
          </task>
          <task>
            <statement>
              <p>
                For the graph in <xref ref="fig-SIR-graph-unlabeled"/>, which curve goes with which compartment of the SIR model? Justify your reasoning in two ways: 
              </p>
              <ul>
                <li>
                  <p>
                    Use your <term>sign analysis</term>, that is, the work you just did on describing solution curves based on the sign (<m>+</m>, <m>-</m>, or <m>0</m>) of the right-hand side of that compartment's differential equation in the SIR model. 
                  </p>
                </li>
                <li>
                  <p>
                    Describe what happens in the <url href="https://nelsong1997.github.io/zombie_game/">Zombie Game App</url> when we run a simulation including zombie mortality, and confirm that these curves make sense in that context. 
                  </p>
                </li>
              </ul>
              <figure width="90%" xml:id="fig-SIR-graph-unlabeled">
                <caption>One set of solution curves for the SIR model</caption>
                <image source="SIR_Graph_Unlabeled_Curves.png" width="80%">
                    <description>Solution curves for the SIR model, unlabeled, for an exercise asking students to identify which curve represents which compartment in the model</description>
                </image>
              </figure>
            </statement>
          </task> 
          
        </exploration>

      <section xml:id="sec-using-calculus-to-analyze-models">
        <title>Using Calculus to Analyze Models</title>

        <p>
          The work of <xref ref="expl-rise-and-fall-of-an-epidemic"/> involves central ideas from introductory calculus. The equations of the SIR model are <em>differential equations</em>, which means they include derivatives. Derivatives represent <em>change</em>, and we often describe this change as the <em>slope of a graph</em>. The graphs we use in studying models are the <em>solution curves</em> of the model. That is, given equations for, say, <m>dS/dt</m>, <m>dI/dt</m>, and <m>dR/dt</m>, the solution curves are the graphs of <m>S(t)</m>, <m>I(t)</m>, and <m>R(t)</m>, with time <m>t</m> on the horizontal axis, and the populations <m>S</m>, <m>I</m>, and <m>R</m> on the vertical axis.  
        </p>
        <p>
          Now, let us continue with model analysis, specifically naming calculus concepts along the way.
        </p>
        <activity xml:id="activity-total-population">
          <statement>
            <p>
              Consider the SIR model:
            </p>
            <md>
              <mrow>\frac{dS}{dt} \amp = -\beta S I </mrow>
              <mrow>\frac{dI}{dt} \amp = \beta S I - \gamma I </mrow>
              <mrow>\frac{dR}{dt} \amp = \gamma I </mrow>
            </md>
            <p>
              and define <m>N(t)=S(t)+I(t)+R(t)</m> to be the <term>total population</term> being modeled, at time <m>t</m>. 
            </p>
            <p>
              Each equation in this model represents the change in a single compartment's population, over time. How can we use the equations in the model to represent the <em>change in total population</em> over time? That is, how can we use the equations to represent <m>dN/dt</m>?
            </p>
            <p>
              Determine the value of the <em>change in total population</em>: you should be able to compute a number. What does this number tell us about the total population in our model? 
            </p>
          </statement>
          <hint>
            <p>
              Add together the three differential equations. What is the meaning of the left-hand side? What is the meaning of the right-hand side? And what value do we obtain on the right-hand side when summing the differential equations?
            </p>
          </hint>
          <answer>
            <p>
              On the left-hand side:
            </p>
            <md>
              <mrow>\frac{dS}{dt}+\frac{dI}{dt}+\frac{dR}{dt} \amp = \frac{d(S+I+R)}{dt} = \frac{dN}{dt}.</mrow>
            </md>
            <p>
              Therefore, summing the three differential equations determines the change over time of the total population.
            </p>
            <p>
              On the right-hand side:
            </p>
            <md>
              <mrow>(-\beta S I)+(\beta S I - \gamma I)+(\gamma I) \amp = 0.</mrow>
            </md> 
            <p>
              Since the three differential equations sum to zero, the change in total population is <m>0</m>. This tells us that the total population in our model does not change. In other words, the size of the total population <m>N(t)</m> remains constant.
            </p>
          </answer>
        </activity>

        <p>
          The analysis in <xref ref="activity-total-population"/> includes the following calculus concepts.
        </p>
        <ul>
          <li>
            <p>
              The sum of derivatives equals the derivative of the sum: <m>\frac{dS}{dt}+\frac{dI}{dt}+\frac{dR}{dt} = \frac{d(S+I+R)}{dt}</m>. Therefore <m>\frac{dS}{dt}+\frac{dI}{dt}+\frac{dR}{dt} = \frac{dN}{dt}</m>.
            </p>
          </li>
          <li>
            <p>
              When the derivative of a function equals <m>0</m>, the function is unchanging: <m>\frac{dN}{dt}=0</m> indicates that <m>N(t)</m> is unchanging. 
            </p>
          </li>
        </ul>
        <p>
          In an outbreak that occurs over a relatively short time, it may make complete sense to say that the population is unchanging. It may be that the population truly does not change at all, or it may be that the population is changing so little that we decide not to include population change in a model of the outbreak. Noticing when population change is <m>0</m>, or close to <m>0</m>, allows us to write relatively simple models that do not try to incorporate births, deaths, immigration, emigration, or other population changes. Models that represent a longer span of time may need to account for changes in population.
        </p>
        <p>
          Considering population change requires us to think more deeply about compartment R. We have referred to this compartment as <q>Removed</q>. Some models call the R compartment <q>Recovered</q>. In an outbreak where people all return to full health, calling the R compartment <q>Recovered</q> works well. In an outbreak that causes deaths, one modeling option is to include both deaths and recoveries in the same R compartment. In this case, the name <q>Removed</q> provides a better description. In either case, recognizing that <q>R</q> may stand for differently named compartments is a reminder to us about why we should fully describe each of our models, even if we believe SIR models are well known to our audience: even among SIR models, the interpretations can differ.
        </p>
        <p>For now, we continue to work with an SIR model in which population does not change. We note that some models do need to account for changes in population. As one example, models that represent a longer span of time may incorporate births and deaths. We will see such models later in this text.</p>
        <p>
          Another comment: though we have said our current SIR model probably refers to an outbreak over a relatively short time span, we purposely do not designate amounts of time that are <q>relatively short</q> or <q>longer</q>. This is a choice for the modeler. For each model, a human (the modeler, or perhaps a group working together) makes decisions about whether to list population changes based on length of time or other reasons. They then provide their decisions when describing their models, and they include some form of justification for each decision.
        </p>
        <p>
          Next, we go back to the SIR model we have been studying to work through some ways the model solutions can change as parameter values change.
        </p>
        <activity xml:id="activity-three-sets-of-parameters">
          <statement>
            <p>
              Use the code below to create three different graphs of solution curves to an SIR model in which <m>S(0)=75</m>, <m>I(0)=25</m>, <m>R(0)=0</m>, and <m>0 \leq t \leq 20</m>. The first set of values for <m>\beta</m> and <m>\gamma</m> appear in the code block; change the code to get the other two sets of values. It may help you to save screenshots of each of the three graphs, so you can more easily see all three at the same time.
            </p>
            <ul>
              <li>
                <p>
                  In the first graph, let <m>\beta = 0.03</m> and <m>\gamma = 0.25</m>.
                </p>
              </li>
              <li>
                <p>
                  In the second graph, let <m>\beta = 0.01</m> and <m>\gamma = 0.4</m>.
                </p>
              </li>
              <li>
                <p>
                  In the third graph, let <m>\beta = 0.005</m> and <m>\gamma = 0.5</m>.
                </p>
              </li>
            </ul>
            <p>
              Then respond to the prompts below the code block.
            </p>
            <sage>
              <input>
                #Import packages
                import numpy as np
                import matplotlib.pyplot as plt
                from scipy.integrate import odeint

                plt.cla() #Clear (delete) any past plots
                
                #Define the system of differential equations, and call it "model"
                def model(y, t):
                  S, I, R = y #Define y as consisting of S, I, and R, in that order
                  dydt = [-beta * S * I, beta * S * I - gamma * I, gamma * I] #These formulas are the right-hand sides of the SIR model
                  return dydt
                
                beta = 0.03 #Give a value to beta
                gamma = 0.25 #Give a value to gamma
                y0 = [75, 25, 0] #Set initial conditions for S, I, and R, in that order
                t_range = np.arange(0.0, 20.0, 0.1) #Set the time range to be t=0 to t=20, with "step through" increments of 0.1 when numerically solving
                
                sol = odeint(model, y0, t_range) #Give the name "sol" to the lists of numerical values in the solution, and give "odeint" the information needed to solve
                
                # Plotting commands are below
                plt.plot(t_range, sol[:, 0], color='blue', linewidth=2, label='S(t)')
                plt.plot(t_range, sol[:, 1], color='orange', linestyle='dashed', linewidth=2, label='I(t)')
                plt.plot(t_range, sol[:, 2], color='teal', linestyle='dashdot', linewidth=2, label='R(t)')
                plt.legend()
                plt.grid()
                plt.xlabel('time')
                plt.ylabel('populations')
                plt.show()
              </input>
              <output>
              (put the graph here!!)
              </output>
              </sage>

              <ol>
                <li>
                  <p>
                    What observations can you make, overall, about the three graphs? Take time with this question, and think expansively, before moving on to the next questions.
                  </p>
                </li>
                <li>
                  <p>
                    Discuss the similarities and differences in the <m>I(t)</m> curves in each of your three graphs. Include observations using our sign analysis from <xref ref="expl-rise-and-fall-of-an-epidemic"/>: when is <m>I(t)</m> rising or falling, and what does this have to do with the sign (<m>+</m>, <m>-</m>, or <m>0</m>) of <m>dI/dt</m>? 
                  </p>
                </li>
                <li>
                  <p>
                    Compare the long-term outcomes for <m>S(t)</m> and <m>R(t)</m> across the three graphs. What do you notice about the total number of people who ever became sick in each case?
                  </p>
                </li>
                <li>
                  <p>
                    Explore the role that changes to <m>\beta</m> make to the outcome in each graph. Similarly, think through how changes to <m>\gamma</m> contribute to changes. For each parameter, decide first how you <em>think</em> changing the parameter will change the solution curves. Then use the code block to make several changes to that parameter, and compare what you see with what you thought you would see.
                  </p>
                </li>
              </ol>
          </statement>
          <hint>
            <ol>
              <li>
                <p>
                  This is open-ended.
                </p>
              </li>
              <li>
                <p>
                  In the first two graphs, <m>I(t)</m> rises, then falls. For a sign analysis, first write out the differential equation for <m>dI/dt</m>. Then substitute in the values of <m>\beta</m> and <m>\gamma</m> and the initial values <m>S(0)=75</m> and <m>I(0)=25</m> to see that <m>\beta S I - \gamma I \gt 0</m>. Yet <m>S(t)</m> decreases rapidly, until <m>\beta S I - \gamma I \lt 0</m>, and at this time the <m>I(t)</m> curve falls. 
                </p>
                <p>
                  In the third graph, the <m>I(t)</m> graph has a negative slope from the very beginning. A sign analysis shows why this makes sense, based on the initial value of <m>dI/dt</m>.
                </p>
              </li>
              <li>
                <p>
                  In the first graph, everyone eventually gets sick. The long-term value of <m>S(t)</m> appears to be <m>0</m> and the long-term value of <m>R(t)</m> appears to be <m>100</m>, which is the total population.
                </p>
                <p>
                  In the second graph, not everyone gets sick in the outbreak. The <m>S(t)</m> curve appears to level out at a value of approximately <m>8</m>. Extending <c>t_range</c> beyond <m>t=20</m> can help for confirming this.
                </p>
                <p>
                  In the third graph, quite a few people avoid illness. Estimates for long-term values of <m>S(t)</m> and <m>R(t)</m> can confirm this.
                </p>
              </li>
              <li>
                <p>
                  There is much to say here. In general, increasing <m>\beta</m> makes more people become sick, and makes infection happen more rapidly. Decreasing <m>\gamma</m> leads to more infections. The <m>S(t)</m>, <m>I(t)</m>, and <m>R(t)</m> graphs are all affected by these changes, and the answer to this prompt should include descriptions of these changes.
                </p>
              </li>
            </ol>
          </hint>
        </activity>

        <p>
          Both <xref ref="activity-three-sets-of-parameters"/> and <xref ref="expl-rise-and-fall-of-an-epidemic"/> use <em>sign analysis</em>. This usage of the signs (<m>+</m>, <m>-</m>, or <m>0</m>) of a derivative can inform us about circumstances in which a population is increasing, decreasing, or remaining constant. Such knowledge about the relationship between signs and derivatives comes from calculus and is tremendously powerful for understanding epidemics through compartmental modeling.
        </p>
        <p>
          Let us take a moment to emphasize an assumption we make about signs when writing compartmental models. In many applications of mathematics, variables and parameters can take on the values of any real number. However, in compartmental models, we specify that variables and parameters cannot be negative because negative values would not make biological sense. For instance, populations of people cannot be negative, and length of time sick with a disease cannot be negative. Therefore, what we see is what we get: if no negative sign (<m>-</m>) is visible, then a term cannot be negative.
        </p>
        <p>
          Here is a summary of some of the key outcomes in the SIR model from our sign analysis so far. Notice that all these observations arise from calculus concepts.
        </p>
        <ul>
          <li>
            <p>
              Sign analysis tells us that <m>S(t)</m> cannot increase: since <m>dS/dt \leq 0</m>, then <m>S(t)</m> can only decrease or remain constant.
            </p>
          </li>
          <li>
            <p>
              Sign analysis tells us that <m>R(t)</m> cannot decrease: since <m>dR/dt \geq 0</m>, then <m>R(t)</m> can only increase or remain constant.
            </p>
          </li>
          <li>
            <p>
              Sign analysis tells us that <m>I(t)</m> has the ability to increase, decrease, or remain constant because the formula for <m>dI/dt</m> can take on values that are positive, negative, or zero.
            </p>
          </li>
          <li>
            <p>
              When <m>dI/dt = 0</m>, the graph of <m>I(t)</m> has a slope of <m>0</m>. In many simulations, there is a single value of <m>t</m> at which <m>dI/dt = 0</m> and the graph of <m>I(t)</m> turns from increasing to decreasing.
            </p>
          </li>
          <li>
            <p>
              Eventually, in this model, the value of <m>I(t)</m> will approach <m>0</m>, and then the values of <m>S(t)</m> and <m>R(t)</m> will level out because <m>dS/dt</m> and <m>dR/dt</m> will approach <m>0</m>. 
            </p>
          </li>
          <li>
            <p>
              You may have found yet other ways to connect derivative signs (<m>+</m>, <m>-</m>, or <m>0</m>) with model outcomes. 
            </p>
          </li>
        </ul>
        <p>
           In addition to looking at signs, we examined long-term outcomes in <xref ref="activity-three-sets-of-parameters"/>. This is a moment to wonder: what can mathematical approaches tell us about limiting the impact of an outbreak? We explore this question in depth in <xref ref="sec-the-basic-reproduction-number-R0"/>.
        </p>

      </section>

      <section xml:id="sec-the-basic-reproduction-number-R0">
        <title>The Basic Reproduction Number <m>\mathcal{R}_0</m></title>

        <p>
          It turns out that the SIR model, and many other compartmental models, can be connected with an epidemiological concept called the <term>basic reproduction number</term>. The basic reproduction number is <em>the average number of new infections caused by one infectious person in an otherwise entirely susceptible population</em>. This number is given the symbol <m>\mathcal{R}_0</m>, which is pronounced as <q>R zero</q> or <q>R nought</q>.
        </p>
        <p>
          In <xref ref="activity-formula-for-i-of-t-turning-around"/>, we begin to link our SIR model with the concept of <m>\mathcal{R}_0</m>.
        </p>
        
        <activity xml:id="activity-formula-for-i-of-t-turning-around">
          <statement>
            <p>
              This activity examines the <em>boundary</em> between rising and falling <m>I(t)</m> numbers in the SIR model we have been studying. We will see that this boundary relates to important information about the basic reproduction number <m>\mathcal{R}_0</m>. 
            </p>
            <p>
              Begin by using the code below to try different values of <m>\beta</m> and <m>\gamma</m>. Your goal is to find values for which the <m>I(t)</m> curve does not rise at first: instead, it stays level or falls. Keep the initial conditions the same, that is, <m>S(0)=1900</m>, <m>I(0)=100</m>, and <m>R(0)=0</m>. If changing the range of <m>t</m> values helps you see the outcome better, then change the end time to a smaller or larger value. However, keep the initial time <m>t=0</m>.   
            </p>
            <p>
              Can you find more than one combination of <m>\beta</m> and <m>\gamma</m> for which the <m>I(t)</m> curve does not rise?
            </p>
            <p>
              You may wish to test your conclusions by viewing model output. To do this, you can modify the Python code provided as part of <xref ref="activity-formula-for-i-of-t-turning-around"/>. Updating the end time of the model simulation may be helpful: rather than end at <m>t=15</m>, consider extending the model for a longer period of time.
            </p>
            <sage>
              <input>
                #Import packages
                import numpy as np
                import matplotlib.pyplot as plt
                from scipy.integrate import odeint

                plt.cla() #Clear (delete) any past plots
                
                #Define the system of differential equations, and call it "model"
                def model(y, t):
                  S, I, R = y #Define y as consisting of S, I, and R, in that order
                  dydt = [-beta * S * I, beta * S * I - gamma * I, gamma * I] #Provide the right-hand sides of the SIR model
                  return dydt
                
                beta = 0.01 #Give a value to beta
                gamma = 0.1 #Give a value to gamma
                y0 = [1900, 100, 0] #Set initial conditions for S, I, and R, in that order
                t_range = np.arange(0.0, 15.0, 0.1) #Set the time range to be t=0 to t=15, with time steps of 0.1 when numerically solving
                
                sol = odeint(model, y0, t_range) #Give the name "sol" to the lists of numerical values in the solution, and give "odeint" the information needed to solve
                
                # Plotting commands are below
                plt.plot(t_range, sol[:, 0], color='blue', linewidth=2, label='S(t)')
                plt.plot(t_range, sol[:, 1], color='orange', linestyle='dashed', linewidth=2, label='I(t)')
                plt.plot(t_range, sol[:, 2], color='teal', linestyle='dashdot', linewidth=2, label='R(t)')
                plt.legend()
                plt.grid()
                plt.xlabel('time')
                plt.ylabel('populations')
                plt.show()
              </input>
              <output>
              (put the graph here!!)
              </output>
              </sage>

              <p>
                Next, consider the equation <m>dI/dt = \beta SI - \gamma I</m> from the SIR model. Under what conditions must <m>dI/dt = 0</m>? Think about these conditions biologically: what interpretations can you give the conditions? 
              </p>
          </statement>
          <hint>
            <p>
              The first part of this is open-ended. There are many combinations of <m>\beta</m> and <m>\gamma</m> for which the <m>I(t)</m> curve falls from the start.
            </p>
            <p>
              For the second part of this, set the right-hand side of the <m>dI/dt</m> equation equal to 0 and factor:
            </p>
            <md>
              <mrow>\beta SI - \gamma I \amp = 0 </mrow>
              <mrow>(\beta S - \gamma ) I \amp = 0 </mrow>
            </md>
            <p>
              This results in two possibilities: either <m>\beta S - \gamma = 0</m> or <m>I=0</m>. There are multiple biological interpretations of each possibility.
            </p>
          </hint>
        </activity>  

        <p>
          Both <xref ref="activity-three-sets-of-parameters"/> and <xref ref="activity-formula-for-i-of-t-turning-around"/> should be leading you to the following conclusions.
        </p>
        <ul>
          <li>
            <p>
              Smaller values of <m>\beta</m> lead to less growth of the <m>I(t)</m> curve and can help contribute to fewer total people ever becoming Infectious. Smaller <m>\beta</m> corresponds to less infectivity.
            </p>
          </li>
          <li>
            <p>
              Larger values of <m>\gamma</m> also lead to less growth of the <m>I(t)</m> curve and can help contribute to fewer total people ever becoming Infectious. Larger <m>\gamma</m> corresponds to a higher rate of people moving from compartment I to compartment R. 
            </p>
          </li>
          <li>
            <p>
              Another way to think of the previous bullet point: smaller values of <m>1/\gamma</m> lead to less growth of the <m>I(t)</m> curve and can help contribute to fewer total people ever becoming Infectious. Given the relationship in <xref ref="eq-gamma-estimate"/>, we see that smaller <m>1/\gamma</m> corresponds to a shorter length of time that people are Infectious.
            </p>
          </li>
          <li>
            <p>
              If <m>\beta</m> and <m>1/\gamma</m> combine into a small enough value, the <m>I(t)</m> curve does not grow, even at the start of a model simulation.
            </p>
          </li>
          <li>
            <p>
              We find that <m>I(t)</m> never grows if <m>dI/dt \leq 0</m> at the start of a simulation, that is, when <m>t=0</m>. This means  
            </p>
            <md>
              <mrow>\beta S I - \gamma I \amp \leq 0 </mrow>
              <mrow>(\beta S - \gamma) I \amp \leq 0. </mrow>
            </md>
            <p>
              Since <m>I \geq 0</m>, the only way to achieve <m>(\beta S - \gamma) I \lt 0</m> is to have <m>(\beta S - \gamma) \lt 0</m>. 
            </p>
          </li>
          <li>
            <p>
              It would also be possible to have <m>(\beta S - \gamma) I = 0</m> if <m>I=0</m>, but once an outbreak begins, we no longer have <m>I=0</m>.
            </p>
          </li>
        </ul>
        <p>
          As a reminder, we said that the basic reproduction number <m>\mathcal{R}_0</m> is the average number of new infections caused by one infectious person <em>in an otherwise entirely susceptible population</em>. We are nearly ready to present the formula for <m>\mathcal{R}_0</m> in the SIR model
        </p>
        <md>
          <mrow>\frac{dS}{dt} \amp = -\beta S I </mrow>
          <mrow>\frac{dI}{dt} \amp = \beta S I - \gamma I </mrow>
          <mrow>\frac{dR}{dt} \amp = \gamma I. </mrow>
        </md>
        <p>
          However, we first emphasize that <m>\mathcal{R}_0</m> describes a phenomenon that occurs in an entirely susceptible population. When <m>\mathcal{R}_0</m> is described in the news or popular culture, as happened in many reports on COVID-19, the <q>entirely susceptible population</q> part of the <m>\mathcal{R}_0</m> definition is usually left out. 
        </p>
        <p>
          To incorporate the idea of an entirely susceptible population, we refer back to our definition of <em>total population</em> <m>N(t)</m>, which appeared in <xref ref="activity-total-population"/>. In that activity, we showed that <m>N(t)</m> remains constant in this SIR model. We can therefore write <m>N(t)</m> more simply as <m>N</m>, since the value of <m>N</m> does not change over time.
        </p>
        <p>
          We now have all the pieces we need to assemble a formula for <m>\mathcal{R}_0</m> in the SIR model <xref ref="eq-SIR-model-S"/>, <xref ref="eq-SIR-model-I"/>, and <xref ref="eq-SIR-model-R"/>:
        </p>
        <mdn>
          <mrow xml:id="eq-R0-sir">\mathcal{R}_0 \amp = \frac{\beta N}{\gamma} \mbox{ for our SIR model}. </mrow>
        </mdn>
        <p>
          It is possible to compute the formula for <m>\mathcal{R}_0</m> from the equations in a compartmental model. The most common way to do this is called the Next Generation Method. Because the Next Generation Method uses partial derivatives and techniques from linear algebra, it is described in the optional sections <xref ref="ch-the-next-generation-method-using-r0-to-determine-beta"/> and <xref ref="ch-the-next-generation-method-connecting-theory-with-practice"/>. In particular, <xref ref="ch-the-next-generation-method-using-r0-to-determine-beta"/> teaches the process in a way that can be used by students who are new to matrix operations and partial derivatives: there are a few math techniques to learn, and Python does the rest. Readers who include <xref ref="ch-the-next-generation-method-using-r0-to-determine-beta"/> will be able to solve for the formula for <m>\mathcal{R}_0</m> in their own models. As an alternative, the <m>\mathcal{R}_0</m> formulas for several commonly used compartmental models are provided directly throughout this text.  
        </p>
        <p>
          The numerical value of the <m>\mathcal{R}_0</m> formula relates closely to the trajectory of an outbreak. Investigate this in <xref ref="activity-r0-less-than-1"/>.
        </p>

        <activity xml:id="activity-r0-less-than-1">
          <statement>
            <p>
              Here, we connect two ideas: the circumstances under which <m>dI/dt=0</m>, according to our work in <xref ref="activity-formula-for-i-of-t-turning-around"/>, and the formula for <m>\mathcal{R}_0</m>, as given in <xref ref="eq-R0-sir"/>.
            </p>
            <p>
              Start with the following result from <xref ref="activity-formula-for-i-of-t-turning-around"/>: in order to have <m>dI/dt=0</m> when <m>I \neq 0</m>, it must be that <m>\beta S - \gamma = 0</m>. Show how to rearrange the equation <m>\beta S - \gamma = 0</m> algebraically to get 
            </p>
            <md>
              <mrow>\frac{\beta S}{\gamma} \amp = 1. </mrow>
            </md>
            <p>
              Then answer the following questions.   
            </p>
            <ul>
              <li>
                <p>
                  When <m>\frac{\beta S}{\gamma} \gt 1</m>, is <m>dI/dt</m> rising or falling?
                </p>
              </li>
              <li>
                <p>
                  When <m>\frac{\beta S}{\gamma} \lt 1</m>, is <m>dI/dt</m> rising or falling?
                </p>
              </li>
              <li>
                <p>
                  In a typical outbreak, what changes to cause <m>\frac{\beta S}{\gamma}</m> to transition in sign between being positive, negative, and <m>0</m>? What is the expected order of these signs, that is, out of <m>+</m>, <m>-</m>, and <m>0</m>, which happens first in an outbreak, which happens second, and which happens third? Why is this the order? 
                </p>
              </li>
            </ul>
            <p>
              After completing the above questions, next consider the formula from <xref ref="eq-R0-sir"/>, which says that <m>\mathcal{R}_0 = \frac{\beta N}{\gamma}</m>. Use the work you have already done in this activity, along with the definition of <m>\mathcal{R}_0</m> as being the average number of new infections caused by one infectious person <em>in an otherwise entirely susceptible population</em>, to describe what <m>\mathcal{R}_0</m> tells us about the behavior of <m>I(t)</m> early in an outbreak. 
            </p>
          </statement>
          <answer>
            <p>
              When <m>\frac{\beta S}{\gamma} \gt 1</m>, then <m>dI/dt \gt 0</m>, which means that the number of Infectious people is increasing. This typically happens early in an outbreak. As the outbreak continues, the value of <m>S</m> becomes smaller, so that eventually <m>\frac{\beta S}{\gamma} = 1</m> (which means <m>dI/dt = 0</m>), and then <m>\frac{\beta S}{\gamma} \lt 1</m> (which means <m>dI/dt \lt 0</m> and the number of Infectious people is decreasing).
            </p>
            <p>
              With one infectious person <em>in an otherwise entirely susceptible population</em>, it is approximately true that <m>S(t)=N</m>, that is, that the Susceptible population is essentially the entire population. Therefore, <m>\mathcal{R}_0</m> is a way of indicating what happens to the <m>I(t)</m> population <em>at the very start of an outbreak</em>. 
            </p>
          </answer>
        </activity>

        <p>
          As we have seen in <xref ref="activity-r0-less-than-1"/>, the value of <m>\mathcal{R}_0</m> tells us what happens at the very start of an outbreak. This relates to the definition of <m>\mathcal{R}_0</m>, which considers a single infectious person in an otherwise entirely susceptible population.
        </p>
        <p>
          To be more specific, when <m>\mathcal{R}_0 \gt 1</m>, the value of <m>dI/dt</m> is initially positive, which means that the value of <m>I(t)</m> initially increases. Only later, when there are fewer susceptibles, does the graph of <m>I(t)</m> level off and begin to fall. 
        </p>
        <p>
          Alternately, if <m>\mathcal{R}_0 \lt 1</m>, then the value of <m>dI/dt</m> is initially negative. In this case, the graph of <m>I(t)</m> never rises: it only falls.
        </p>
        <p>
          The value of <m>\mathcal{R}_0</m>, then, tells us whether to expect increasing numbers of Infectious individuals. The specific number <m>1</m> is the boundary between rising and falling values of <m>I(t)</m> when a new infection is first introduced to a susceptible population. We will further see that larger values of <m>\mathcal{R}_0</m> correspond to diseases that are more infectious. The concept of <m>\mathcal{R}_0</m> will be central to our study of outbreaks.  
        </p> 

         
        
      </section> 

      <exercises xml:id="exercises-ch-populations-and-R0">
        <exercise number="1">
          <p>
            Do some mathematical analysis of this SI model: 
          </p>
          <md>
            <mrow>\frac{dS}{dt} \amp = -\beta S I </mrow>
            <mrow>\frac{dI}{dt} \amp = \beta S I. </mrow>
          </md>
          <p>
            In particular,
          </p>
          <ol>
            <li>
              <p>
                Sum the differential equations and use your results to describe how the total population being modeled changes over time.  
              </p>
            </li>
            <li>
              <p>
                Perform a sign analysis on the <m>dS/dt</m> equation, indicating mathematically feasible ways in which the population <m>S(t)</m> can change during the time of the outbreak.  
              </p>
            </li>
            <li>
              <p>
                Perform a sign analysis on the <m>dI/dt</m> equation, indicating mathematically feasible ways in which the population <m>I(t)</m> can change during the time of the outbreak.  
              </p>
            </li>
            <li>
              <p>
                Investigate the role of <m>\beta</m> in changing the outcomes of the model. Describe ways in which changing <m>\beta</m> can change the outcomes, and describe what those changes are. Also describe ways in which the outcomes cannot be changed by changing <m>\beta</m>.  
              </p>
            </li>
          </ol>
        </exercise>
        <exercise number="2">
          <p>
            Imagine a new outbreak occurs in a small town of 5000 people. Let us suppose it makes sense to model this outbreak with an SIR model, where the compartments are Susceptible (people who are not sick but can become sick), Infectious (people who are currently able to spread the disease), and Removed (people who are no longer able to spread the disease and are unable to become sick again). At the start of the outbreak, a single person is Infectious, and the rest of the people are Susceptible.
          </p>
          <ol>
            <li>
              <p>
                Suppose that, in the early days of the outbreak, researchers estimate <m>\beta \approx 0.0001</m> and <m>\gamma \approx 0.2</m>. Compute the value of <m>\mathcal{R}_0</m> for this model. Then, based on the value of <m>\mathcal{R}_0</m> you compute, answer: what do you think will happen in the short term and in the long term of this outbreak?
              </p>
            </li>
            <li>
              <p>
                Now suppose that the value of <m>\beta</m> was instead approximated to be <m>0.00001</m>, yet it is still true that <m>\gamma \approx 0.2</m>. Compute the value of <m>\mathcal{R}_0</m> in this case. With this value of <m>\mathcal{R}_0</m>, what do you anticipate for the short-term and long-term outcomes of the outbreak?
              </p>
            </li>
            <li>
              <p>
                Now suppose this outbreak occurs in a town of 1000 people, with <m>\beta \approx 0.0001</m> and <m>\gamma \approx 0.2</m>. Compute the value of <m>\mathcal{R}_0</m> for the SIR model in this smaller town. Use this value of <m>\mathcal{R}_0</m> to describe what you think will happen in the short term and in the long term of this outbreak.
              </p>
            </li>
            <li>
              <p>
                Adapt the Python code shown earlier in this chapter to produce graphs of the outcomes of the SIR models in parts (a), (b), and (c) above. Write a few sentences about how well your descriptions of short-term and long-term model outcomes are supported, or not supported, by the graphs.
              </p>
            </li>
          </ol>
        </exercise>
        <exercise number="3">
          <p>
            Most diseases we know of have <m>\mathcal{R}_0 \gt 1</m>. This makes sense: without rising numbers of Infectious people, we do not experience an epidemic. However, in rare cases, a disease emerges for which <m>\mathcal{R}_0 \lt 1</m>. One example is MERS, which stands for Middle East Respiratory Syndrome. The first identified case of MERS was in 2012. There is still a lot to learn about MERS, but multiple estimates indicate that the value of <m>\mathcal{R}_0</m> for MERS is less than one.
          </p>
          <p>
            This activity is motivated by the existence of diseases with <m>\mathcal{R}_0 \lt 1</m>. Suppose we study a disease for which <m>\mathcal{R}_0 \approx 0.5</m> and <m>\gamma = 0.1</m>, that is, people are typically infectious for about ten days. Suppose we choose to model this disease with an SIR model similar to the models we have been using in this chapter: <q>S</q> stands for Susceptible, meaning people who are not sick but can become sick; <q>I</q> stands for Infectious, meaning people who are currently able to spread the disease, and <q>R stands for</q> Removed, meaning people who are no longer able to spread the disease and are unable to become sick again. In the case of a disease similar to MERS, the Removed compartment consists of both recoveries and deaths from the disease.
          </p>
          <ol>
            <li>
              <p>
                In an area with a population of 1000, use <xref ref="eq-R0-sir"/> to solve for the value of <m>\beta</m> for this SIR model.
              </p>
            </li>
            <li>
              <p>
                Suppose that at the start of the outbreak, 20 people are Infectious. Use the Python block below to visualize the outbreak over 200 days. Notice that the Python block includes three <c>print</c> commands. These print and label the last output values stored as <c>sol</c>, that is, the <m>S(t)</m>, <m>I(t)</m>, and <m>R(t)</m> values for the last value of time <m>t</m>, namely <m>t=200</m>.  
              </p>
              <p>
                <em>Use caution: by default, the Python block does not contain the correct value for <m>\beta</m>. Instead, replace the existing <m>\beta</m> value with the value you computed in part (a).</em>
              </p>
              <p>
                 Use the graphs to describe qualitatively what happens in this population that began with 20 Infectious people. Does the curve for the <m>I(t)</m> population begin falling from the very beginning? What happens to the curves for <m>S(t)</m> and <m>R(t)</m>? 
              </p>
            </li>
            <li>
              <p>
                Incorporate the output from the <c>print</c> command, along with the visual output of the graphs. How many people, in total, were Infectious at some point during the time of this model? How does this compare with the initial 20 cases? How do you reconcile this result with the behavior of the <m>I(t)</m> curve and with the knowledge that <m>\mathcal{R}_0 \lt 1</m> in this model?
              </p>
            </li>
          </ol> 
          <sage>
            <input>
              #Import packages
              import numpy as np
              import matplotlib.pyplot as plt
              from scipy.integrate import odeint

              plt.cla() #Clear (delete) any past plots
              
              #Define the system of differential equations, and call it "model"
              def model(y, t):
                S, I, R = y #Define y as consisting of S, I, and R, in that order
                dydt = [-beta * S * I, beta * S * I - gamma * I, gamma * I] #Provide the right-hand sides of the SIR model
                return dydt
              
              #This value for beta is not correct for MERS.
              #Instead, use the value you compute in part (a).
              beta = 0.01
              gamma = 0.1 #Give a value to gamma
              y0 = [980, 20, 0] #Set initial conditions for S, I, and R, in that order
              t_range = np.arange(0.0, 200.0, 0.1) #Set the time range and increment of time steps to be used for numerically solving
              
              sol = odeint(model, y0, t_range) #Give the name "sol" to the lists of numerical values in the solution, and give "odeint" the information needed to solve

              # Tell Python to print the last values produced of S, I, and R, to help show long-range outcomes of the model
              print("Long-term value of S = ", round(sol[-1,0]))
              print("Long-term value of I = ", round(sol[-1,1]))
              print("Long-term value of R = ", round(sol[-1,2]))
              
              # Plotting commands are below
              plt.plot(t_range, sol[:, 0], color='blue', linewidth=2, label='S(t)')
              plt.plot(t_range, sol[:, 1], color='orange', linestyle='dashed', linewidth=2, label='I(t)')
              plt.plot(t_range, sol[:, 2], color='teal', linestyle='dashdot', linewidth=2, label='R(t)')
              plt.legend()
              plt.grid()
              plt.xlabel('time')
              plt.ylabel('populations')
              plt.show()
            </input>
            <output>
            (put the graph here!!)
            </output>
            </sage>
        </exercise>
      </exercises>

    </chapter>

    
    <chapter xml:id="ch-vaccines-and-isolation-in-compartmental-models">
      <title>Vaccines and Isolation in Compartmental Models</title>

      <introduction xml:id="intro-vaccines-and-isolation-in-compartmental-models">
      <objectives>
        <ul>
          <li>
            <p>
              Explore the role of public health strategies in managing disease spread, using compartmental models
            </p>
          </li>
          <li>
            <p>
              Strengthen understanding of the meaning of <m>\mathcal{R}_0</m>, which involves a single Infectious person in an otherwise entirely Susceptible population
            </p>
          </li>
          <li>
            <p>
              Determine the threshold for what percentage of vaccine coverage reduces transmission enough so that the number of Infectious cases does not rise
            </p>
          </li>
          <!-- <li>
            <p>
              Introduce a new model compartment, often called <em>Isolated</em>, to reduce disease transmission by reducing the interaction of the Infectious and Susceptible populations 
            </p>
          </li> -->
        </ul>
      </objectives>

      <p>
        In the first few chapters of this text, we have introduced the basic <q>hows</q> for compartmental modeling, as well as a few of the <q>whys</q>. Now, we explore the <q>whys</q> even further.  
      </p>  

      <p>
        One of the most significant ways to use models is for trying and comparing possible public health strategies <em>in simulations</em> before actually carrying them out with real people. Professional-level models can be quite detailed and depend on large amounts of data, and compartmental models are just one of the many types of models implemented. In this chapter, we define and model two commonly used strategies, vaccines and isolation. 
      </p>

      <p>
        Begin in <xref ref="expl-activity-vaccines-and-isolation"/> by adjusting a model in a particular way to reduce the occurrence of new infections.
      </p>

      </introduction>
      
      <exploration xml:id="expl-activity-vaccines-and-isolation">
        <title>Reducing New Infections</title>
        <introduction>
          <p>
            This exploration seeks to reduce the number of new infections by directly reducing the transmission part of the compartmental SIR model shown in <xref ref="eq-SIR-model-S"/>, <xref ref="eq-SIR-model-I"/>, and <xref ref="eq-SIR-model-R"/>. To reduce transmission, we multiply by a term <m>(1-p)</m>:  
          </p>
          <md>
            <mrow>\frac{dS}{dt} \amp = - (1-p) \beta S I </mrow>
            <mrow>\frac{dI}{dt} \amp =  (1-p) \beta S I - \gamma I </mrow>
            <mrow>\frac{dR}{dt} \amp = \gamma I. </mrow>
          </md>
          <p>
            This change to the model reflects that the term <m>\beta SI</m> in the SIR model represents transmission of disease from the Infectious to the Susceptible population. To reduce transmission, we therefore change the specific term <m>\beta SI</m> by introducing the multiplier <m>(1-p)</m>. 
          </p> 
          <p>
            Work through the parts below to build understanding of the term <m>(1-p)</m> and the permissible values of <m>p</m>.
          </p>
        </introduction>

        <task>
          <statement>
            <p>
              Read the Python code below. Think through the factor <m>(1-p)</m> that is multiplied by <m>\beta S I</m> in both the <m>dS/dt</m> and <m>dI/dt</m> equations. We restrict the possible values of <m>p</m> so that it must be true that <m>0 \leq p \leq 1</m>.  
            </p>
            <p>
              After reading and evaluating the Python code, respond to the questions that follow.
            </p>

             <sage>
              <input>
                #Import packages
                import numpy as np
                import matplotlib.pyplot as plt
                from scipy.integrate import odeint

                plt.cla() #Clear (delete) any past plots
                
                #Define the system of differential equations, and call it "model"
                def model(y, t):
                  S, I, R = y #Define y as consisting of S, I, and R, in that order
                  dydt = [- (1-p) * beta * S * I, (1-p) * beta * S * I - gamma * I, gamma * I] #Provide the right-hand sides of the SIR model
                  return dydt
                
                beta = 0.0004 #Give a value to beta
                gamma = 0.1 #Give a value to gamma
                p = 0.0 #Give a value to p
                y0 = [1500, 500, 0] #Set initial conditions for S, I, and R, in that order
                t_range = np.arange(0.0, 20.0, 0.1) #Set the time range and increment of time steps to be used for numerically solving
                
                sol = odeint(model, y0, t_range) #Give the name "sol" to the lists of numerical values in the solution, and give "odeint" the information needed to solve
                
                # Plotting commands are below
                plt.plot(t_range, sol[:, 0], color='blue', linewidth=2, label='S(t)')
                plt.plot(t_range, sol[:, 1], color='orange', linestyle='dashed', linewidth=2, label='I(t)')
                plt.plot(t_range, sol[:, 2], color='teal', linestyle='dashdot', linewidth=2, label='R(t)')
                plt.legend()
                plt.grid()
                plt.xlabel('time')
                plt.ylabel('populations')
                plt.show()
              </input>
              <output>
              (put the graph here!!)
              </output>
              </sage>

            <ol>
              <li>
                <p>
                  Given the restriction that <m>0 \leq p \leq 1</m>, what is the range of possible values for the term <m>(1-p)</m>?
                </p>
              </li>
              <li>
                <p>
                  When we multiply the transmission term <m>\beta SI</m> by <m>(1-p)</m>, for viable values of <m>p</m>, what is the effect? Describe in terms of numbers, in terms of the graphical output of the Python code, and in terms of the impact on a disease outbreak.
                </p>
              </li>              
            </ol>

            
          </statement>
        </task>

        <task>
          <statement>
            <p>
              These questions get more specific about the value of <m>p</m>. Think logically and mathematically about your answers, and use the Python code freely to experiment with <m>p</m>. To help you build a strong sense of the role of <m>p</m> in the SIR model, you may wish to change the time range, include other information we have seen in past simulations, or make other changes to the code.
            </p>
          <ol>
            <li>
                <p>
                  What sorts of effects do you see from the term <m>(1-p)</m> when the value of <m>p</m> is relatively small, that is, <m>p</m> is just above <m>0</m>? In contrast, what sorts of effects do you see from the term <m>(1-p)</m> when the value of <m>p</m> is relatively large, that is, <m>p</m> is just below <m>1</m>?
                </p>
              </li>
              <li>
                <p>
                  What can you say about the boundary values of <m>p</m>? That is, what sorts of effects does the term <m>(1-p)</m> have on the SIR model when <m>p=0</m> or when <m>p=1</m>?
                </p>
              </li>
              <li>
                <p>
                  Pulling ideas together: as the value of <m>p</m> increases from <m>0</m> to <m>1</m>, what observations can you make about the output of the SIR model?
                </p>
              </li>
          </ol>
          </statement>
        </task>
        
      </exploration>

      <section xml:id="section-vaccines-in-compartmental-models">
        <title>Vaccines in Compartmental Models</title>

        <p>
          The modeling in this section focuses on <em>reducing transmission of a disease through the use of vaccines</em>. We use the multiplier <m>(1-p)</m> from <xref ref="expl-activity-vaccines-and-isolation"/>, along with the concept of <m>\mathcal{R}_0</m> from <xref ref="ch-population-values-and-the-basic-reproduction-number-R0"/>, to demonstrate the effect of vaccines on the number of people who ever become Infectious in a disease outbreak.
        </p>
        <p>
          As a reminder, the <em>basic reproduction number</em> <m>\mathcal{R}_0</m> is the average number of new infections caused by one infectious person in an otherwise entirely susceptible population. This means that <m>\mathcal{R}_0</m> is not a number we can use to directly describe a population that has been vaccinated against a disease, since a vaccinated population is not entirely susceptible. Instead, we introduce an <term>effective reproduction number</term> <m>\mathcal{R}_{\text{eff}}</m>, which is the average number of new infections caused by one infectious person in a population that may not be entirely susceptible, such as a population that has had access to vaccination.
        </p>
        <p>
          We cannot change the intrinsic value of <m>\mathcal{R}_0</m>, but with vaccination, we can work toward the goal of having <m>\mathcal{R}_{\text{eff}} \lt 1</m>. If <m>\mathcal{R}_{\text{eff}} \lt 1</m> in a model that includes vaccines or other public health interventions, then overall numbers of Infectious people do not rise over time. With a few lines of algebra, we can build a relationship between <m>\mathcal{R}_0</m>, <m>p</m>, and <m>\mathcal{R}_{\text{eff}}</m>. 
        </p> 
        <p>
          First, we should state a definition for <m>p</m>. We define <m>p</m> to be the fraction of people vaccinated against a disease, noting that the values of <m>p</m> are therefore restricted to <m>0 \leq p \leq 1</m>, where <m>p=0</m> means no one is vaccinated, and <m>p=1</m> means <m>100\%</m> of the population is vaccinated. Initially, we will think of vaccination as being <m>100\%</m> effective. 
          <aside>
            <p>
              Later, we update our models to include vaccines that are less than <m>100\%</m> effective.
            </p>
          </aside>
          When the fraction <m>p</m> of people are vaccinated, the remaining fracion <m>(1-p)</m> are not vaccinated. Since <m>\mathcal{R}_0</m> refers to an entirely susceptible population, but only the fraction <m>(1-p)</m> of the population is susceptible, we see that the average number of new infections caused by one infectious person in the vaccinated population is <m>(1-p)\mathcal{R}_0</m>. In other words:
        </p>
        
        <mdn>
          <mrow xml:id="eq-Reff-define">\mathcal{R}_{\text{eff}} \amp = (1-p)\mathcal{R}_0. </mrow>
        </mdn>

        <p>
          Our goal in the next few mathematical steps is to use <xref ref="eq-Reff-define"/> to determine a value of <m>p</m> for which <m>\mathcal{R}_{\text{eff}} \lt 1</m>. Such a value of <m>p</m> corresponds to a vaccination rate high enough that a disease cannot become an outbreak because <m>\mathcal{R}_{\text{eff}} \lt 1</m> means that the overall numbers in the population are not expected to rise. Read carefully through the following mathematical steps to see how this value of <m>p</m> is computed:
        </p>
        
        <!-- <md>
          <mrow> \text{Start with our goal:}  \amp \amp  \mathcal{R}_{\text{eff}} \amp \lt 1 </mrow>
          <mrow> \text{Substitute:}  \amp \amp (1-p)\mathcal{R}_0 \amp \lt 1 </mrow>
          <mrow> \text{Rearrange algebraically:}  \amp \amp \mathcal{R}_0 - p \mathcal{R}_0 \amp \lt 1 </mrow>
          <mrow> \text{Rearrange algebraically:}  \amp \amp p \mathcal{R}_0 \amp \gt \mathcal{R}_0 - 1 </mrow>
          <mrow> \text{Rearrange algebraically:}  \amp \amp p \amp \gt \frac{\mathcal{R}_0 - 1}{\mathcal{R}_0}. </mrow>
        </md> -->

        <md>
          <mrow> \mathcal{R}_{\text{eff}} \amp \lt 1 </mrow>
          <mrow> (1-p)\mathcal{R}_0 \amp \lt 1 </mrow>
          <mrow> \mathcal{R}_0 - p \mathcal{R}_0 \amp \lt 1 </mrow>
          <mrow> p \mathcal{R}_0 \amp \gt \mathcal{R}_0 - 1 </mrow>
          <mrow> p \amp \gt \frac{\mathcal{R}_0 - 1}{\mathcal{R}_0} </mrow>
          <mrow>p \amp \gt 1- \frac{1}{\mathcal{R}_0}. </mrow>
        </md>

        <p>
          In the lines above, we started with our goal of causing <m>\mathcal{R}_{\text{eff}}</m> to be less than one. We then made a substitution using <xref ref="eq-Reff-define"/> and rearranged algebraically until we found a formula showing values of <m>p</m> that satisfied our goal. Notice that to compute the next-to-last line, we divided by <m>\mathcal{R}_0</m> without changing the direction of the inequality, which assumed that <m>\mathcal{R}_0 \gt 0</m>. This assumption makes biological sense, and is important to point out mathematically, as biology and mathematics should support each other throughout the modeling process.        
        </p>

        <p>
          We now note a particular, special value of <m>p</m> that is the threshold between two outcomes, which makes it a <term>critical value</term>. The two outcomes are having, or not having, an outbreak. We therefore name this critical value of <m>p</m> to be <m>p_{\text{crit}}</m>:
        </p>

        <mdn>
          <mrow xml:id="eq-pcrit">p_{\text{crit}} \amp = 1- \frac{1}{\mathcal{R}_0}. </mrow> 
        </mdn>

        <p>
          Investigate the critical value <m>p_{\text{crit}}</m>, and the accompanying threshold between outbreak and no outbreak, in <xref ref="activity-pcrit"/>.
        </p>

        <activity xml:id="activity-pcrit">
          <statement>
            <p>
              Here
            </p>
            <p>
              Start    
            </p>
            <ul>
              <li>
                <p>
                  When 
                </p>
              </li>
              <li>
                <p>
                  In  
                </p>
              </li>
            </ul>
            <p>
              After 
            </p>
          </statement>
          <answer>
            <p>
              When  
            </p>
          </answer>
        </activity>

         <!-- While this does not mean that no one new can become sick after the initial cases, it means that the total numbers of Infectious people are not expected to rise, so people are becoming Removed faster than new people are becoming Infectious. (*** TURN THIS INTO AN EXERCISE ***) -->

        <p>
          START WITH BASICS OF P. THEN DISCUSS EFFICACY AND EFFECTIVENESS. THEN SHOW HOW TO BUILD JUST EFF/EFF INTO THE MODEL. FINALLY, MAYBE IN AN EXERCISE, INCLUDE BOTH VACCINE COVERAGE AND EFF/EFF, SIMULTANEOUSLY, IN A MODEL. (MAYBE MAKE IT AN EXERCISE TO SEE WHAT THAT FORMULA SHOULD BE???)
        </p> 
        
        <p>
          When vaccines are studied and approved for use, researchers demonstrate their <term>efficacy</term> and <term>effectiveness</term>. Both terms consider how many people within a population of vaccinated individuals get a disease, compared with how many people within a comparable population of unvaccinated individuals get the same disease. If, for instance, <m>75\%</m> fewer people in the vaccinated population get the disease, then we say the vaccine has an efficacy or effectiveness of <m>75\%</m>.
          <aside>
            <p>
              Notice what the <m>75\%</m> does NOT mean: it does NOT mean that only <m>75\%</m> of people are protected by the vaccine, or that the vaccine only <q>works</q> <m>75\%</m> of the time.              
            </p>            
          </aside>  
          The word <em>efficacy</em> specifies that the comparison of vaccinated and unvaccinated populations happens within a clinical trial. The word <em>effectiveness</em> indicates that the vaccine is being studied for populations in the real world. While clinical trials do include a range of different people, effectiveness often differs from efficacy.
        </p>
        <p>
          Nice explanations of the meanings of <em>efficacy</em> and <em>effectiveness</em> can be found at this <url href="https://www.who.int/news-room/feature-stories/detail/vaccine-efficacy-effectiveness-and-protection">Vaccine efficacy, effectiveness and protection</url> page from the World Health Organization.
        </p> 
        <p>
          Vaccine outcomes extend beyond affecting disease transmission. One common outcome is reducing the intensity of illness in individuals who have been vaccinated, yet who still become sick. This and other outcomes can also be included in models. However, such models tend to be more detailed than those we are studying right now. For this reason, we focus only on vaccine models that show reduced transmission.
        </p>
        <p>
          Putting together the ideas of efficacy and of <xref ref="expl-activity-vaccines-and-isolation"/>, we begin to see how to determine the value of the parameter <m>p</m> in the multiplier <m>(1-p)</m>. If a population is fully vaccinated against a disease<mdash/>that is, if <m>100\%</m> or very close to <m>100\%</m> of the population is vaccinated against the disease<mdash/>then 
        </p>


        <p>Vaccine ideas, herd immunity</p>

      </section>

      <section xml:id="section-isolation-in-compartmental-models">
        <title>Isolation in Compartmental Models</title>
        <p>Vaccine ideas, herd immunity</p>
      </section>

    </chapter>


    <chapter xml:id="ch-getting-the-answer-right-in-modeling">
      <title>Getting the Answer <q>Right</q> in Modeling</title>

      <introduction xml:id="intro-getting-the-answer-right-in-modeling">
        <objectives>
          <ul>
            <li>
              <p>
                Discuss how set-up and definitions matter
              </p>
            </li>
            <li>
              <p>
                Discuss context!!!  
              </p>
            </li>
            <li>
              <p>
                (Compare modeling with proofs or similar?)
              </p>
            </li>
          </ul>
        </objectives>
  
        <!-- Put isolation HERE?!?!?! -->

        <p> 
          In this chapter, we pause and step back to consider the overall process of <term>mathematical modeling</term>. 
        </p>
        <p>
          Mathematical modeling allows us to represent real-world scenarios with mathematical formulas. Models may primarily reflect what is happening in the world, giving us a mathematical way to describe what we see. Alternately, we may use models to think about how to change what is happening in the world. We can make changes mathematically, trying ideas within models, before ever trying to implement those ideas as policies or medical interventions involving actual people.  
        </p>
        <p>
          PUT AN EXPLORATION ACTIVITY IN HERE???
        </p>
        <p>
           Many people believe that mathematics is all about getting <q>the right answer</q>. With mathematical modeling, there may not be a <q>right answer</q>, or even a best answer. Instead, the answers we seek depend on the questions we ask, the priorities we set, the way we use models to explore these questions, and our ability to explain all these pieces of our thought process.
        </p>
        <p>
          You could say that modeling consists of four components: 
        </p>
        <ol>
          <li>
            <p>
              A <em>logical approach</em>;
            </p>
          </li>
          <li>
            <p>
              Stated <em>priorities</em>, which relate to both goals and ethics;
            </p>
          </li>
          <li>
            <p>
              Making <em>changes</em> to models as we gain more information, to better represent a situation, to answer different questions, or to try new scenarios;
            </p>
          </li>
          <li>
            <p>
              Well-worded <em>explanations</em> of every decision and result.
            </p>
          </li>
        </ol>
        <p>
          We work through each of these in the sections below.
        </p>
  
        </introduction>

        <section xml:id="section-the-logical-approach">
          <title>The Logical Approach</title>

          <p>
            Throughout mathematics, we set up statements in a particular logical way. We will see that researchers follow similar principles when describing mathematical models.
          </p>
          <p>
            Work through <xref ref="activity-mathematical-logic-sections"/> and <xref ref="activity-mathematical-logic-sections-advanced"/> to build familiarity with the steps of a logical mathematical explanation.
          </p>

          <activity xml:id="activity-mathematical-logic-sections">
            <statement>              
              <p>
                Mathematical statements are typically structured in terms of <q>if</q> and <q>then</q> statements, such as: <q><em>If</em> the weather forecast calls for rain, <em>then</em> I will bring my raincoat.</q> There may be several <q>if</q> statements, and these are collectively called <term>hypotheses</term>. There may be many <q>then</q> statements, and these are called <term>conclusions</term>.  
              </p>
              <p>
                For each of the following mathematical statements, specify which part is the <em>hypothesis</em>, that is, the <q>if</q> part of the statement. Also specify which part is the <em>conclusion</em>, that is, the <q>then</q> part.
              </p>
              <ol>
                <li>
                  <p>
                    If a polygon has six sides and six angles, then the polygon is a hexagon.
                  </p>
                </li>
                <li>
                  <p>
                    If we add two positive numbers <m>a</m> and <m>b</m>, the resulting number will be larger than either <m>a</m> or <m>b</m>.
                  </p>
                </li>
              </ol>
            </statement>
            <hint>
              <p>
                The first statement could be described as having one hypothesis or two hypotheses, depending on whether we characterize <q>six sides and six angles</q> as a single combined idea, or we prefer to split this idea into two separate hypotheses. There could be even more hypotheses listed, such as if we want to say that having a shape be a polygon is itself a hypothesis. Any reasonable answer here is valid: there is not just one way to designate hypotheses.    
              </p>
              <p>
                The second statement does not explicitly include the word <q>then</q>.   
              </p>
            </hint>
          </activity>

          <activity xml:id="activity-mathematical-logic-sections-advanced">
            <statement>              
              <p>
                For each of the following mathematical statements, specify the <em>hypotheses</em> and the <em>conclusions</em>. There may be multiple hypotheses and/or conclusions per statement. The words <q>if</q> and/or <q>then</q> may not appear explicitly.
              </p>
              <p>
                A note: you may recognize these statements, but it is completely OK if you do not recognize them. Naming the hypotheses and conclusions is possible even if the statements are unfamiliar.
              </p>
              <ol>
                <li>
                  <p>
                    If a right triangle has legs with lengths <m>a</m> and <m>b</m>, and if the same triangle's hypotenuse has length <m>c</m>, then the equation <m>a^2+b^2=c^2</m> is true.
                  </p>
                </li>
                <li>
                  <p>
                    Suppose a function <m>f(x)</m> is continuous for <m>x</m>-values satisfying <m>a \leq x \leq b</m>. In this case, <m>f</m> takes on every value between the numbers <m>f(a)</m> and <m>f(b)</m>.
                  </p>
                </li>
                <li>
                  <p>
                    Differentiable functions are continuous.
                  </p>
                </li>
              </ol>
            </statement>
            <hint>
              <ol>
                <li>
                  <p>
                    This is the most straightforward of the three statements in this activity. Most responses will probably have two hypothesis statements and one conclusion. It is possible to list even more hypotheses, such as <q>a triangle is a right triangle,</q> <q>one leg of the triangle has length <m>a</m>,</q> and so on.
                  </p>
                </li>
                <li>
                  <p>
                    This statement is roughly in <q>if-then</q> format already, with the <q>if</q> portion in the first sentence and the <q>then</q> portion in the second sentence.
                  </p>
                  <p>
                    As a note: this statement is inspired by the Intermediate Value Theorem in calculus, but it is not exactly the Intermediate Value Theorem, as it does not state that we are restricting ourselves to values of <m>x</m> for which <m>a \leq x \leq b</m> when stating that <m>f</m> takes on every value between <m>f(a)</m> and <m>f(b)</m>.
                  </p>
                </li>
                <li>
                  <p>
                    The logical structure for this statement is the same as in the rewritten statement: <q>If a function is differentiable, then that function is continuous.</q>
                  </p>
                </li>
              </ol>
            </hint>
          </activity>

          <p>
            The statements in <xref ref="activity-mathematical-logic-sections"/> and <xref ref="activity-mathematical-logic-sections-advanced"/> are traditionally mathematical. When discussing mathematical models, the statements may look somewhat different. Practice with modeling language in <xref ref="activity-mathematical-logic-in-modeling"/>.
          </p>

          <activity xml:id="activity-mathematical-logic-in-modeling">
            <statement>              
              <p>
                For each of the following paragraphs, specify the <em>hypotheses</em> and the <em>conclusions</em>. There may be multiple hypotheses and/or conclusions per paragraph. The words <q>if</q> and/or <q>then</q> may not appear explicitly.
              </p>
              <ol>
                <li>
                  <p>
                    Suppose we use an SIR model to represent an outbreak in a population of 10,000 people. In this model, the S compartment contains the Susceptibles, that is, people who are not sick but can become sick. The I compartment contains the Infectious, that is, people who are currently able to spread the disease. The R compartment contains the Removed, that is, people who are no longer able to spread the disease and are unable to become sick again. Suppose we estimate the parameters to be <m>\beta \approx 0.0001</m> and <m>\gamma \approx 0.4</m>. If, at the start of the outbreak, ten people are Infectious and the rest are Susceptible, then by the end of the outbreak, the model suggests that <m>1071</m> will remain Susceptible, that is, <m>1071</m> people will never have become Infectious. 
                  </p>
                </li>
                <li>
                  <p>
                    Suppose we use the same SIR model equations described above, with the same initial conditions and the same value of <m>\gamma</m>. However, public health measures are implemented, so that <m>\beta</m> is estimated to fall to approximately <m>0.00005</m>. In this situation, the model suggests that <m>6257</m> people will remain Susceptible at the end of the outbreak. 
                  </p>
                </li>
              </ol>
            </statement>
            <hint>
              <ol>
                <li>
                  <p>
                    There are many hypotheses here! Everything before the word <q>then</q> forms part of the hypotheses. The conclusion appears after <q>then</q>.
                  </p>
                </li>
                <li>
                  <p>
                    The hypotheses here include most of the information from the first scenario, except with a changed value of <m>\beta</m>. The conclusion begins after <q>In this situation</q>. 
                  </p>
                </li>
              </ol>
            </hint>
          </activity>

          <p>
            All this practice with hypotheses and conclusions leads us to a key idea. <em>When the hypotheses in a statement are not satisfied, we should not expect the conclusion in that statement to be satisfied.</em> Practice with this concept appears in <xref ref="activity-mathematical-logic-hypotheses-not-satisfied"/>.
          </p>

          <activity xml:id="activity-mathematical-logic-hypotheses-not-satisfied">
            <statement> 
              <p>
                Each of the following changes a statement from an earlier activity. Based on the change, comment on what we should expect regarding the statement's conclusion. 
              </p>             
              <ol>
                <li>
                  <p>
                    Recall the statement <q>If a polygon has six sides and six angles, then the polygon is a hexagon</q> from <xref ref="activity-mathematical-logic-sections"/>. Suppose you see a polygon that has seven sides and seven angles. Must this polygon be a hexagon?
                  </p>
                </li>
                <li>
                  <p>
                    Recall the statement <q>Suppose a function <m>f</m> is continuous for <m>x</m>-values satisfying <m>a \leq x \leq b</m>. In this case, <m>f</m> takes on every value between the numbers <m>f(a)</m> and <m>f(b)</m></q> from <xref ref="activity-mathematical-logic-sections-advanced"/>. Suppose a function <m>g</m> is not continuous at some of the <m>x</m>-values satisfying <m>a \leq x \leq b</m>. In this case, might there be some numbers between <m>f(a)</m> and <m>f(b)</m> for which <m>f</m> does not take on the value of those numbers?
                  </p>
                </li>
              </ol>
            </statement>
            <hint>
              <p>
                When any of the hypotheses are not satisfied, we should not expect the conclusion to be satisfied.
              </p>
            </hint>
          </activity>

          <p>
            The sheer number of assumptions in a model is notable. We comment again that if <em>any</em> hypotheses are not satisfied, then we should not assume that the conclusions must be true. Think through this in <xref ref="activity-mathematical-logic-hypotheses-not-satisfied-model"/>.
          </p>

          <activity xml:id="activity-mathematical-logic-hypotheses-not-satisfied-model">
            <statement>              
              <p>
                Recall the following from <xref ref="activity-mathematical-logic-in-modeling"/>.
              </p>
              <p>
                <q>Suppose we use an SIR model to represent an outbreak in a population of 10,000 people. In this model, the S compartment contains the Susceptibles, that is, people who are not sick but can become sick. The I compartment contains the Infectious, that is, people who are currently able to spread the disease. The R compartment contains the Removed, that is, people who are no longer able to spread the disease and are unable to become sick again. Suppose we estimate the parameters to be <m>\beta \approx 0.0001</m> and <m>\gamma \approx 0.4</m>. If, at the start of the outbreak, ten people are Infectious and the rest are Susceptible, then by the end of the outbreak, the model suggests that <m>1071</m> will remain Susceptible, that is, <m>1071</m> people will never have become Infectious.</q>
              </p>
              <p>
                Write at least five different ways that the hypotheses in the statement of this model may not be satisfied. In each of these cases, we should not expect the conclusion to be satisfied.
              </p>
            </statement>
          </activity>

          <p>
            We have learned in this section that a model includes statements to create a very specific scenario. Whatever conclusions there may be from the model, we should expect them to occur <em>only in the scenario created by the hypotheses</em>. If any of the hypotheses change, then we should not expect any of the same conclusions to occur.
          </p>
          <p>
            In mathematical statements and model scenarios: it is not completely impossible to see some of the same conclusions, even if we change the hypotheses. We are not saying that it is impossible to end up at the same conclusion. Instead, our emphasis is that we <em>should not expect</em> the conclusion to be the same. All our discussion about the model should include this logical connection between hypotheses and conclusions.
          </p>
          <p>
            In addition to the purely logical relationship between the <q>ifs</q> and <q>thens</q> of model statements, there are priorities built into any model. We discuss this in <xref ref="section-priorities-where-goals-meet-ethics"/>.
          </p>
  
        </section>


        <section xml:id="section-priorities-where-goals-meet-ethics">
          <title>Priorities: Where Goals Meet Ethics</title>
          <p>
            Each model is based on the priorities of the people who create the model. Recognizing this, and thinking about it from the start, makes us better modelers.
          </p>
          <p>
            The word <q>priorities</q> can take on many meanings. One key priority in model building is <em>answering a question</em>. For instance, in <xref ref="ch-vaccines-and-isolation-in-compartmental-models"/> we described models that address questions about how helpful vaccines or isolation can be in preventing an outbreak or reducing the effects of an outbreak. Different questions may require different models.
          </p>
          <p>
            There may be other priorities as well, and we may not realize when we start model building that we are even building in those priorities. A student project I once advised produced one very powerful example of priorities that we do not see initially. This project forms the idea behind <xref ref="activity-priorities-HIV-AIDS"/>.
            The goal of the project was to construct a model to address how a government could best use its resources to reduce the impact of HIV/AIDS in its population. The student based their model and their data collection on professional sources, using meticulous research. When the pieces were all in place and they began to use the model to optimize spending, <em>the results of the model showed</em> that the student's priorities had not been included in the model. This new understanding led the student to revise the model to better reflect their priorities.
          </p>

          <activity xml:id="activity-priorities-HIV-AIDS">
            <statement>              
              <p>
                This activity describes a process for constructing a model to address how a government can best use its resources to reduce the impact of HIV/AIDS in its population. The real-life project that inspires this activity involved an excellent student who did meticulous research in constructing their model. The student incorporated the following ideas into their model, with each of the ideas drawing from professionally published articles.
              </p>
              <ul>
                <li>
                  <p>
                    The model has five compartments.
                  </p>
                  <ul>
                    <li>
                      <p>
                        The S compartment is our familiar Susceptibles compartment, for people without HIV or AIDS.
                      </p>
                    </li>
                    <li>
                      <p>
                        The I compartment is for Infectious people, meaning those with HIV, who are not receiving antiretroviral therapy.
                      </p>
                    </li>
                    <li>
                      <p>
                        The I' compartment is for another category of Infectious people. This compartment is for people with HIV who are receiving antiretroviral therapy.
                      </p>
                    </li>
                    <li>
                      <p>
                        The A compartment is for people with AIDS who are not receiving antiretroviral therapy.
                      </p>
                    </li>
                    <li>
                      <p>
                        The A' compartment is for people with AIDS who are receiving antiretroviral therapy.
                      </p>
                    </li>
                  </ul>
                </li>
                <li>
                  <p>
                    Many modelers, at the time this student was working, indicated that patients with AIDS were typically too sick to spread the virus to others. Therefore patients with AIDS, according to models, did not contribute to new cases of HIV. The same hypothesis is part of this model: people in the I and I' compartments can cause new infections, but people in the A and A' compartments cannot.
                  </p>
                </li>
                <li>
                  <p>
                    When people first have HIV, they are in the I compartment. If they later begin treatment, they move to the I' compartment.
                  </p>
                </li>
                <li>
                  <p>
                    People can move back and forth between I and I', and between A and A'.
                  </p>
                </li>
                <li>
                  <p>
                    When someone in compartment I progresses in status from HIV to AIDS, they move to compartment A. Similarly, when someone in compartment I' progresses in status from HIV to AIDS, they move to compartment A'.
                  </p>
                </li>
                <li>
                  <p>
                    This model lasts many years, so it includes births and deaths. All births are assumed to be Susceptible. The death rates can differ from compartment to compartment.
                  </p>
                </li>
              </ul>

              <p>
                This model has many more pieces than the models we have seen before. It may take some time to think through all the pieces! Begin by taking a significant amount of time to view the compartmental diagram in <xref ref="fig-ED-HIV-AIDS-model"/> and read the ideas that led to the model's development. Be sure you understand them.
              </p>

              <figure xml:id="fig-ED-HIV-AIDS-model">
              <caption>Compartmental diagram of a model of HIV/AIDS, using descriptions instead of formulas for each arrow</caption>
              <image width="100%">
              <description>(Write this)</description>
              <latex-image>
              \begin{tikzpicture}
                \draw [thick] [black] (2,6) -- (4,6);
                \draw [thick] [black] (4,6) -- (4,8);
                \draw [thick] [black] (4,8) -- (2,8);
                \draw [thick] [black] (2,8) -- (2,6);
                \node [black] at (3,7) {\Huge $S$};
                \draw [thick] [black] (7,6) -- (9,6);
                \draw [thick] [black] (9,6) -- (9,8);
                \draw [thick] [black] (9,8) -- (7,8);
                \draw [thick] [black] (7,8) -- (7,6);
                \node [black] at (8,7) {\Huge $I$};
                \draw [thick] [black] (7,2) -- (9,2);
                \draw [thick] [black] (9,2) -- (9,4);
                \draw [thick] [black] (9,4) -- (7,4);
                \draw [thick] [black] (7,4) -- (7,2);
                \node [black] at (8,3) {\Huge $I'$};
                \draw [thick] [black] (12,6) -- (14,6);
                \draw [thick] [black] (14,6) -- (14,8);
                \draw [thick] [black] (14,8) -- (12,8);
                \draw [thick] [black] (12,8) -- (12,6);
                \node [black] at (13,7) {\Huge $A$};
                \draw [thick] [black] (12,2) -- (14,2);
                \draw [thick] [black] (14,2) -- (14,4);
                \draw [thick] [black] (14,4) -- (12,4);
                \draw [thick] [black] (12,4) -- (12,2);
                \node [black] at (13,3) {\Huge $A'$};
                \draw [thick] [->] (0,7.5) to (1.9,7.5); 
                \node at (1,7.8) {births};
                \draw [thick] [->] (1.9,6.5) to (0,6.5); 
                \node at (1,6.2) {deaths};
                \draw [thick] [->] (4.1,7) to (6.9,7); 
                \node at (5.5,7.3) {transmission};
                \node at (5.5,6.7) {due to $I$ and $I'$};
                \draw [thick] [->] (7.75,5.9) to (7.75,4.1); 
                \node at (6.25,5.5) {start treatment};
                \draw [thick] [->] (8.25,4.1) to (8.25,5.9); 
                \node at (9.75,4.5) {stop treatment};
                \draw [thick] [->] (8,1.9) to (8,0); 
                \node at (7.3,1) {deaths};
                \draw [thick] [->] (8,8.1) to (8,10); 
                \node at (7.3,9) {deaths};
                \draw [thick] [->] (9.1,7) to (11.9,7); 
                \node at (10.5,7.3) {HIV to AIDS};
                \node at (10.5,6.7) {transition};
                \draw [thick] [->] (9.1,3) to (11.9,3); 
                \node at (10.5,3.3) {HIV to AIDS};
                \node at (10.5,2.7) {transition};
                \draw [thick] [->] (12.75,5.9) to (12.75,4.1); 
                \node at (11.25,5.5) {start treatment};
                \draw [thick] [->] (13.25,4.1) to (13.25,5.9); 
                \node at (14.75,4.5) {stop treatment};
                \draw [thick] [->] (13,1.9) to (13,0); 
                \node at (12.3,1) {deaths};
                \draw [thick] [->] (13,8.1) to (13,10);
                \node at (12.3,9) {deaths};
                \end{tikzpicture}
                </latex-image>
                </image>
                </figure>

                <p>
                  Once you have a solid understanding of the pieces of the model, you may begin to have insight into the outcome that emerged from this model. The student working on this project did all the research needed to determine biologically reasonable parameters. When running simulations with the model, their goal was to think through government strategies for spending limited funds designated for health. They hoped to determine how those funds should be allocated, given a goal of reducing the number of new HIV infections as much as possible.
                </p>
                <p>
                  Can you guess what they found?
                </p>
                <p>
                  Take time to think of what the model might have indicated, regarding the answer to the student's questions about government funds. Only after thinking about it: check the Hint below to see what happened. Then spend more time, thinking about why this model gave this answer, and thinking about what would need to change in the model to give a different answer.
                </p>


            </statement>
            <hint>
              <p>
                The model indicated that no funds at all should be spent on treating patients with AIDS: no medicines, no hospital beds, nothing. 
              </p>
            </hint>
          </activity>

          <p>
            The example in <xref ref="activity-priorities-HIV-AIDS"/> is lengthy, but it provides an important insight. <em>We may think we know what questions we are answering with our models, but we should continue to interrogate our answers in relation to our goals, priorities, and ethics.</em> The outcome of the model in <xref ref="activity-priorities-HIV-AIDS"/> did not suit the goals or ethics of the student doing the project. The result from the mathematical model highlighted built-in priorities of the model that the student (and I) did not notice at first. When new infections are completely unaffected by the people in the A and A' compartments, then treating those people, or providing them any healthcare at all, is irrelevant to the goals of the model. However, leaving large numbers of people without healthcare was never the goal of this project. The model needed to be revised to account for this.
          </p>

          <p>
            All modeling involves revision. We restructure models when we spot errors, or when we are able to access better data, or when we begin by asking some questions and then shift to different questions. Updating models is the focus of <xref ref="section-making-changes-to-models"/>.
          </p>
  
  
          
        </section>


        
        <section xml:id="section-making-changes-to-models">
          <title>Making Changes to Models</title>
          <p>Talk about how set-up matters, definitions matter, context for any solutions is important, etc. Give some examples with different contexts/hypotheses/questions-being-asked.</p>
  
  
          
        </section>
      
      
      
        <section xml:id="section-writing-explanations-to-present-models-to-others">
        <title>Writing Explanations to Present Models to Others</title>
        <p>Talk about how set-up matters, definitions matter, context for any solutions is important, etc. Give some examples with different contexts/hypotheses/questions-being-asked.</p>


        <figure xml:id="fig-SEI-compartmental-diagram">
          <caption>One possible <m>SEI</m> (Susceptible, Exposed-and-incubating, Infectious) compartmental diagram</caption>
            <image width="70%">
            <description>(Write this)</description>
              <latex-image>
              \begin{tikzpicture}
                \draw [thick] [black] (0,0) -- (2,0);
                \draw [thick] [black] (2,0) -- (2,2);
                \draw [thick] [black] (2,2) -- (0,2);
                \draw [thick] [black] (0,2) -- (0,0);
                \node [black] at (1,1) {\Huge $S$};
                \draw [thick] [->] (2.1,1) to (3.9,1); 
                \node at (3,1.5) {\Large $\beta SI$};
                \draw [thick] [black] (4,0) -- (6,0);
                \draw [thick] [black] (6,0) -- (6,2);
                \draw [thick] [black] (6,2) -- (4,2);
                \draw [thick] [black] (4,2) -- (4,0);
                \node [black] at (5,1) {\Huge $E$};
                \draw [thick] [->] (6.1,1) to (7.9,1); 
                \node at (7,1.5) {\Large $\kappa E$};
                \draw [thick] [black] (8,0) -- (10,0);
                \draw [thick] [black] (10,0) -- (10,2);
                \draw [thick] [black] (10,2) -- (8,2);
                \draw [thick] [black] (8,2) -- (8,0);
                \node [black] at (9,1) {\Huge $I$};
              \end{tikzpicture}
              </latex-image>
             </image>
        </figure>
      </section>

    </chapter>

    <chapter xml:id="ch-preparing-influenza-data-to-compare-with-a-model">
      <title>Preparing Influenza Data to Compare With a Model</title>

      <section xml:id="section-ga">
        <title></title>
        <p>Use Bates flu data. Discuss converting from New Cases to S, I, R and possibly other compartments. Also discuss different time scales (here or elsewhere): converting data and parameters between days, weeks, months, years.</p>
      </section>

    </chapter>

    <chapter xml:id="ch-epidemic-vs-endemic-models">
      <title>Epidemic vs. Endemic Models</title>

      <section xml:id="section-ee">
        <title></title>
        <p>Talk about demographic effects. Emphasize here that this is why we aren't normalizing total population to 1</p>
      </section>

    </chapter>

    <chapter xml:id="ch-residual-sum-of-squares-improving-a-models-fit-to-data">
      <title>Residual Sum of Squares: Improving a Model's Fit to Data</title>

      <section xml:id="section-ra">
        <title></title>
        <p>Use Bates flu data? Introduce RSS. Discuss improving model fit and show how to do it. Emphasize (!!!!!!!) biological suitability of parameter choices, noise in data, etc. Consider developing a range of very good parameters, rather than imagining there is some set of "best" parameters.</p>
      </section>

    </chapter>

    <chapter xml:id="ch-akaike-information-criterion-comparing-different-models">
      <title>Akaike Information Criterion: Comparing Different Models</title>

      <section xml:id="section-ma">
        <title></title>
        <p>Use Bates flu data? Introduce AICc. Discuss comparing models and why we might want to do so. Discuss overfitting, Occam's Razor.</p>
      </section>

    </chapter>


  </part>

  <part xml:id="part-digging-deeper-mathematically">
    <title>Digging Deeper Mathematically</title>

    <chapter xml:id="ch-model-analysis-total-population-and-equilibrium-values">
      <title>Model Analysis: Total Population and Equilibrium Values</title>

      <section xml:id="section-1">
        <title></title>
        <p>Talk about summing models to understand total population (often = 0). Discuss solving for equilibrium values in some models. Refer to disease-free equilibrium in ALL models.</p>
      </section>

    </chapter>

    <chapter xml:id="ch-the-next-generation-method-using-r0-to-determine-beta">
      <title>The Next Generation Method: Using <m>\mathcal{R}_0</m> to Determine <m>\beta</m></title>

      <section xml:id="section-2">
        <title></title>
        <p>Show how to use the NGM and how to use the results to determine beta</p>
      </section>

    </chapter>

    <chapter xml:id="ch-tips-on-reading-a-scientific-paper">
      <title>Tips on Reading a Scientific Paper</title>

      <section xml:id="section-3a">
        <title></title>
        <p>The Maddie/Maddy talk! Turn into a chapter and give them credit</p>
      </section>

    </chapter>
    
    <chapter xml:id="ch-the-next-generation-method-connecting-theory-with-practice">
      <title>The Next Generation Method: Connecting Theory with Practice</title>

      <section xml:id="section-3">
        <title></title>
        <p>Provide more behind-the-scenes details of the NGM, including what different terms mean in the F, V^(-1), and F V^(-1) matrices</p>
      </section>

    </chapter>

    <chapter xml:id="ch-numerical-simulations-an-overview-of-how-computers-turn-equations-into-graphs">
      <title>Numerical Simulations: An Overview of How Computers Turn Equations into Graphs</title>

      <section xml:id="section-4">
        <title></title>
        <p>Show some basics of Euler's Method, including activities for students to try on their own. Allude to other methods. Provide some outside reading (?).</p>
      </section>
     
    </chapter>

    <chapter xml:id="ch-kermack-mckendrick-the-1927-paper">
      <title>Kermack-McKendrick: the 1927 Paper</title>

      <section xml:id="section-4a">
        <title></title>
        <p>Discuss the 1927 paper, including similarities and differences with the SIR and similar models we use today.</p>
      </section>
     
    </chapter>
  
  </part>

  <part xml:id="part-examples-and-case-studies">
    <title>Examples and Case Studies</title>

    <chapter xml:id="ch-introducing-an-incubation-period-in-the-zombie-app">
      <title>Introducing an Incubation Period in the Zombie App</title>

      <introduction xml:id="intro-incubation-period-in-zombie-app">
        <objectives>
          <ul>
            <li>
              <p>
                Use the zombie app in new ways to generate data for simulated outbreaks
              </p>
            </li>
            <li>
              <p>
                Develop hypotheses for how an incubation period will affect the timeline and outcomes of an outbreak 
              </p>
            </li>
            <li>
              <p>
                Compare your hypotheses about the incubation period with data from your simulations
              </p>
            </li>
          </ul>
        </objectives>
  
        <p>
          In the <url href="https://nelsong1997.github.io/zombie_game/">Zombie Game App</url> we originally used in <xref ref="ch-zombies-can-math-help" />, when a human is infected, they become a zombie the very next day.
        </p>
        <p>
          Suppose, instead, that humans experience an incubation period after being attacked by a zombie. During this incubation period, these individuals are neither a zombie (so not Infectious) nor Susceptible.
        </p>
        <p>
          <em>Take a few moments to think through how an incubation period would change the outcomes of the simulation.</em> Then begin <xref ref="sec-activity-introduce-an-incubation-period" />.
        </p>
  
        </introduction>


      <section xml:id="sec-activity-introduce-an-incubation-period">
        <title>Activity: Introduce an Incubation Period</title>
       
          <p>
            In this example, we assume that after a zombie infects a human, there is a <em>one-day incubation period</em>, meaning a one-day delay, before the human becomes a zombie. While the Zombie Game App can help generate data for such an outbreak, it does not have a direct way to incorporate the incubation period. We must therefore restart the app repeatedly and keep track of our own data, as described below.
          </p>  
          <p>  
            Start in <url href="https://nelsong1997.github.io/zombie_game/">the app</url> by beginning a game in which Human Start Count is set equal to 49 and Zombie Start Count is set equal to 1. Click <q>start</q> and write down the resulting number of new infections on Day 1: these are all the humans infected by our starting zombie. For instance, suppose there are two new infections from the interactions on Day 0, as circled in <xref ref="fig-zombie-SEI-Day-1" />. Then on Day 1, there should be 47 humans, 2 incubating individuals, and 1 zombie. The app says there are three zombies, but in our interpretation, 2 are incubating individuals, and 1 is a zombie. 
          </p>
          <figure width="90%" xml:id="fig-zombie-SEI-Day-1">
            <caption>Determining the number of New Infections on Day 1</caption>
            <image source="Zombie_SEI_Simulation_Day1.png" width="60%">
              <description>Table of data from one day of a simulation in the human-zombie game. There are two new infections on Day 1.</description>
            </image>
          </figure>
          <p>
            We therefore click <q>restart</q> on the app, so that we can enter a Human Start Count of 47 and a Zombie Start Count of 1. We do not include the 2 incubating individuals, since they do not affect the number of new zombies generated from Day 1 interactions. With these settings, we run the app for one round, generating new Infectious individuals once again. An example of this is shown in <xref ref="fig-zombie-SEI-Day-2" />. 
          </p>
          <figure width="90%" xml:id="fig-zombie-SEI-Day-2">
            <caption>Using the results of Day 1 to determine the number of New Infections on Day 2</caption>
            <image source="Zombie_SEI_Simulation_Day2.png" width="60%">
              <description>Table of data from one day of a simulation in the human-zombie game, using the outcome of Day 1 to determine new infections on Day 2. There is one new infection on Day 2.</description>
            </image>
          </figure>
          <p>
            The next step is where we begin to re-introduce the individuals who were infected on Day 0 but still incubating the zombie disease on Day 1. From <xref ref="fig-zombie-SEI-Day-2" /> we see that we should have 46 humans and 1 incubating individual on Day 2. We also have 3 zombies: the initial zombie, plus the 2 incubating individuals from Day 1. We therefore restart the model, entering a Human Start Count of 46 and a Zombie Start Count of 3. A possible outcome appears in <xref ref="fig-zombie-SEI-Day-3" />.
          </p>
          <figure width="90%" xml:id="fig-zombie-SEI-Day-3">
            <caption>Using the results of Days 1 and 2, including re-introducing incubating individuals as zombies, to determine the number of New Infections on Day 3</caption>
            <image source="Zombie_SEI_Simulation_Day3.png" width="60%">
              <description>Table of data from one day of a simulation in the human-zombie game, re-introducing incubating individuals as zombies, to determine new infections on Day 3. There are four new infections on Day 3.</description>
            </image>
          </figure>
          <p>
            From this step, we continue until the game has ended. It helps to generate a new table of data, keeping track of the numbers of each of the three types of individuals. This table can be on paper, in a spreadsheet, or in whatever other form you prefer. <xref ref="fig-zombie-SEI-Data" /> shows a sample of how the table might look.
          </p>
          <figure width="90%" xml:id="fig-zombie-SEI-Data">
            <caption>A sample full data set for simulating infections in a case where there is a one day incubation period as humans transition to zombies</caption>
            <image source="Zombie_SEI_Simulation_Data.png" width="90%">
              <description>Table of data from one sample simulation where humans have a one-day incubation period before becoming zombies. For days 0 to 10, the numbers of new infections are 1, 2, 1, 4, 5, 13, 8, 9, 5, 2, 0.</description>
            </image>
          </figure>
          <p>
            Ask yourself: what do you observe? Compare this simulation with simulations having no incubation period. Consider how many days the outbreak lasts. Make note of your observations, share your ideas with others, and consider the observations of other people trying this experiment. Try the experiment with a longer incubation period, such as 2, 3, or 4 days, and observe the ways these changes affect outcomes of the model.
          </p>
          <!-- <p>
            INCLUDE: a question about why the total population always equals 50, and about why this column is included in the sample data set
          </p> -->
      </section>

    </chapter>
    
    <chapter xml:id="ch-preparing-mumps-data-to-compare-with-a-six-compartment-model">
      <title>Preparing Mumps Data to Compare with a Six-Compartment Model</title>

      <section xml:id="section-6">
        <title></title>
        <p>Mumps data and SEIJAR model (and SEIR model)</p>
      </section>

    </chapter>

    <chapter xml:id="ch-modeling-the-spread-of-a-rumor">
      <title>Modeling the Spread of a Rumor</title>

      <section xml:id="section-7">
        <title></title>
        <p>Rumor - use multiple references, and write up our "own" model here</p>
      </section>

    </chapter>

    <chapter xml:id="ch-modeling-viral-videos">
      <title>Modeling Viral Videos</title>

      <section xml:id="section-8">
        <title></title>
        <p>References??? Show how to develop this</p>
      </section>

    </chapter>

    <chapter xml:id="ch-modeling-conspiracy-theories">
      <title>Modeling Conspiracy Theories</title>

      <section xml:id="section-9">
        <title></title>
        <p>Stuff with Steph and FBI! And... other refs available yet?</p>
      </section>

    </chapter>

    <chapter xml:id="ch-periodic-forcing">
      <title>Periodic Forcing</title>

      <section xml:id="section-10a">
        <title></title>
        <p>Measles in NYC or London!!! Etc. Discuss how it looks in the data, and how it can be modeled, and show some solutions.</p>
      </section>

    </chapter>

    <chapter xml:id="ch-superspreader-events">
      <title>Superspreader Events</title>

      <section xml:id="section-10c">
        <title></title>
        <p>Discuss COVID and other cases where superspreaders matter. How do these ideas fit with compartmental models?</p>
      </section>

    </chapter>
    
    <chapter xml:id="ch-vector-based-models-of-disease-spread">
      <title>Vector-Based Models of Disease Spread</title>

      <section xml:id="section-10">
        <title></title>
        <p>Perhaps dengue, chikungunya, etc.</p>
      </section>

    </chapter>

    <chapter xml:id="ch-modeling-spatial-variation-using-patches">
      <title>Modeling Spatial Variation Using Patches</title>

      <section xml:id="section-11">
        <title></title>
        <p>Pauline paper mentioned at Vandy talk?</p>
      </section>

    </chapter>

    <chapter xml:id="ch-an-hiv-model-where-the-infected-are-cells-rather-than-people">
      <title>An HIV Model Where the <q>Infected</q> are Cells Rather Than People</title>

      <section xml:id="section-10b">
        <title></title>
        <p>The compartments are stages of cell infection</p>
      </section>

    </chapter>

    <chapter xml:id="ch-a-peek-at-agent-based-models">
      <title>A Peek at Agent-Based Models</title>

      <section xml:id="section-10d">
        <title></title>
        <p>Show relationships between compartmental models and ABMs</p>
      </section>

    </chapter>

    <chapter xml:id="ch-connecting-with-network-models">
      <title>Connecting with Network Models</title>

      <section xml:id="section-10e">
        <title></title>
        <p>Show relationships between basic compartmental models and network models</p>
      </section>

    </chapter>

  </part>


  <part xml:id="part-supplemental-materials">
    <title>Supplemental Materials</title>

    <chapter xml:id="ch-data-sets">
      <title>Data Sets</title>

      <section xml:id="section-supp-aa">
        <title></title>
        <p>Include various data sets (or split these up elsewhere).</p>
      </section>

    </chapter>
    
    <chapter xml:id="ch-paper-assignments-and-grading-rubrics">
      <title>Paper Assignments and Grading Rubrics</title>

      <section xml:id="section-supp-a">
        <title></title>
        <p>Include paper assignments and rubrics. Possibly split this into separate chapters.</p>
      </section>

    </chapter>

    <chapter xml:id="ch-writing-tips-for-math-and-planning-for-peer-review">
      <title>Writing Tips for Math, and Planning for Peer Review</title>

      <section xml:id="section-supp-b">
        <title></title>
        <p>Take presentations I've given about mathematical writing, and include those ideas here. Seek additional references on this topic. Include materials I share with students about peer review, and describe WHY and HOW peer review is so great.</p>
      </section>

    </chapter>

    
    <chapter xml:id="ch-linear-algebra-introduction">
      <title>Linear Algebra Introduction</title>

      <section xml:id="section-supp-c">
        <title></title>
        <p>Just-in-time linear algebra for Next Generation Method etc.</p>
      </section>

    </chapter>


    <chapter xml:id="ch-other-resources">
      <title>Other Resources</title>

      <section xml:id="section-supp-d">
        <title></title>
        <p>Annotated bibliography</p>
      </section>

    </chapter>



  </part>



    <backmatter xml:id="backmatter">
      <title>Backmatter</title>

      <glossary>
        <title>Glossary of Mathematical Epidemiology Terms</title>

        <headnote>
          <p>
            This glossary includes both definitions and, in many cases, examples along with fuller descriptions. The terms are listed in alphabetical order. At the end of each definition, a chapter number in parentheses indicates where the term first appeared in the text. The definitions and descriptions of the terms relate to their usage in the types of models described in this text: readers should know that some of the terms may have more broadly defined meanings in other mathematical contexts.
          </p>
          
        </headnote>

        
        
        <gi>
          <title>Basic Reproduction Number</title>

          <p>
            The basic reproduction number is the average number of new infections caused by one infectious person in an otherwise entirely susceptible population. The symbol <m>\mathcal{R}_0</m>, pronounced <q>R zero</q> or <q>R nought</q>, represents the concept of the basic reproduction number, both in writing and in mathematical formulas.  (Chapter 5)
          </p>

        </gi>


        <gi>
          <title>Compartmental Diagram</title>

          <p>
            A compartmental diagram is an image, typically consisting of labeled boxes and arrows, that visually represents the flow of individuals through a <em>compartmental model</em>. Examples include <xref ref="fig-SI-compartmental-diagram"/> and <xref ref="fig-SIR-compartmental-diagram"/>. (Chapter 4)
          </p>

        </gi>

        

        <gi>
          <title>Compartmental Model</title>

          <p>
            A compartmental model is a style of mathematical model in which the subjects of the model are grouped into categories called <em>compartments</em>. Such a model follows the overall outcomes for each compartment, but does not typically track the outcomes of smaller groups such as individuals. The compartmental models in this text use differential equations to demonstrate the interactions and rates governing how many individuals move from one group to another at specific points in time.  As one example of a compartmental model, an SIR model consists of three compartments: S, I, and R. Most often in this text, compartment S represents Susceptible individuals, compartment I represents Infectious individuals, and compartment R represents Removed individuals. (Chapter 4)
          </p>

        </gi>

        

        <gi>
          <title>Compartments</title>

          <p>
            In most models within this text, individuals are placed into categories called compartments. The individuals can typically move out of some compartments and into others, and the differential equations in compartmental models are sets of rules for the ways in which individuals are able to make such moves between compartments.  (Chapter 4)
          </p>

        </gi>

        <gi>
          <title>Continuous</title>

          <p>
            We tend to think of real-world time as continuous, meaning time does not keep stopping and starting. The compartmental models we use in most of this book show continuous time. While this sense of time matches the real world, we need to think about how to reconcile it with data sets, which typically involve discrete time steps, such as days or weeks.  (Chapter 2)
          </p>

        </gi>


        <gi>
          <title>Discrete</title>

          <p>
            We can think of time as discrete when we describe it as separate steps, such as Day 0, Day 1, or Day 2. Many data sets we work with report data in discrete time steps, such as by day or by week. We need to think through how to reconcile discrete data sets with the continuous models we most often use in this text. (Chapter 2)
          </p>

        </gi>

        
        <gi>
          <title>Effective Reproduction Number</title>

          <p>
            The effective reproduction number is the average number of new infections caused by one infectious person in a population that is not entirely susceptible. The most common reason for a population to not be entirely susceptible is when some of the people have some form of immunity. Reasons for immunity may include vaccination and/or some of the people in the population previously having the disease being studied. The symbol <m>\mathcal{R}_{\text{eff}}</m> represents the effective reproduction number. (Chapter 6)
          </p>

        </gi>



        <gi>
          <title>Graphical Solution</title>

          <p>
            A graphical solution to a differential equation, or system of differential equations, is a curve or curves showing the behavior of the differential equation(s), based on specific parameter values and initial conditions. When parameter values change, or when initial conditions change, the graphical solution typically changes as well. A graphical solution is often called a <em>solution</em>, and readers should use context to know whether the word <em>solution</em> refers to a graphical solution, a numerical solution, or a formula. (Chapter 3)
          </p>

        </gi>

        
        <gi>
          <title>Initial Conditions</title>

          <p>
            Initial conditions are the starting values of the dependent variables in differential equations. Within this text, our dependent variables are typically populations such as <m>S(t)</m> or <m>I(t)</m>, and the start of solutions is usually the time <m>t=0</m>. This means the initial conditions are the values <m>S(0)</m> and <m>I(0)</m>. Initial conditions are used when computing a numerical solution: the numerical solution begins with the initial conditions and then <q>steps through</q> time, computing the later values of each dependent variable using both the earlier values and the information in the differential equations about how each dependent variable changes. (Chapter 3)
          </p>

        </gi>


        <gi>
          <title>Numerical Solution</title>

          <p>
            A numerical solution to a differential equation, or system of differential equations, is a set of lists of numbers that result from approximating the outcome of the differential equation(s), given specific parameter values and initial conditions. When parameter values change, or when initial conditions change, the numerical solution typically changes as well. The lists of numbers for an SIR model, for instance, typically show the values of <m>S(t)</m>, <m>I(t)</m>, and <m>R(t)</m> at many values of time <m>t</m> within the range of time values of interest. We may print some or all of the values in the lists, or we may use graphing to present the information in the lists. A numerical solution is often called a <em>solution</em>, and readers should use context to know whether the word <em>solution</em> refers to a graphical solution, a numerical solution, or a formula. (Chapter 3)
          </p>

        </gi>


        
        <gi>
          <title>Parameters</title>

          <p>
            Parameters in a model are numbers, determined using biological information, that represent some aspect of how a disease progresses. In this text, most parameters are shown as Greek letters, such as <m>\beta</m> or <m>\gamma</m>. A few parameters in this text represent percentages, such as the percentage of a population that is vaccinated against a disease, and these parameters are typically represented by lowercase letters such as <m>p</m> or <m>q</m>. Parameters are different than variables: the variables in our models are typically the independent variable <m>t</m> for time, and dependent variables such as <m>S</m>, <m>I</m>, <m>R</m>, and others, for populations.  (Chapter 4)
          </p>

        </gi>

        
        
        <gi>
          <title>Rate</title>

          <p>
            A rate is, in general, a ratio between two different things. In this text, rates are parameters having units <m>1/\text{time}</m>. In a model, the rate is typically multiplied by a population such as <m>I</m> or <m>R</m> to show the flow of that population out of one compartment and into another compartment. (Chapter 4)
          </p>

        </gi>

        
        <gi>
          <title>Sign Analysis</title>

          <p>
            The word <q>sign</q> in sign analysis refers to whether terms in differential equations are positive (<m>+</m>), negative (<m>-</m>), or zero (<m>0</m>). In sign analysis, we use these signs to build understanding of the differential equation. Often, our goal is to learn whether the solution to the differential equation is rising, falling, or level at some time <m>t</m>. This understanding may help us identify which solution curve goes with which differential equation, may show when a disease starts with an outbreak or can never experience an outbreak, and may indicate many other outcomes of models. Sign analysis is powerful because it depends only on the signs of terms, without forcing us to rely on detailed data sets that may not always be available. (Chapter 5)
          </p>

        </gi>



        <gi>
          <title>SI Model</title>

          <p>
            An SI model is a compartmental model having two compartments, labeled S and I. Most often in this text, S stands for <em>Susceptible</em> and I stands for <em>Infectious</em>, though the compartments can have other interpretations. The letters S and I are each pronounced when we say <q>SI model</q>: <q>Ess</q> <q>Eye</q> model. (Chapter 2)
          </p>

        </gi>

        
        <gi>
          <title>Total Population</title>

          <p>
            The total population of a compartmental model is the sum of the populations in each compartment. We typically use the variable <m>N</m> to refer to total population, and we write <m>N(t)</m> to mean total population at time <m>t</m>. (Chapter 5)
          </p>

        </gi>

        
        


      </glossary>

      <colophon>
        <p> This book was authored in <pretext />. </p>
      </colophon>

    </backmatter>

  </book>
</pretext>
