<chapter xml:id="ch-isolation" xmlns:xi="http://www.w3.org/2001/XInclude">
    <title>* Isolation</title>

    <p>
      <term>***This chapter is under construction.***</term>
    </p>

    <introduction xml:id="intro-isolation">
        <objectives>
          <ul>
            <li>
              <p>
                Learn strategies for modeling <em>isolation</em>, that is, the separation of Infectious people from the rest of the population, in order to prevent them from spreading the disease to others
              </p>
            </li>
            <li>
              <p>
                Revisit how to use a model's parameter-based formula for <m>\mathcal{R}_0</m> when computing biologically-feasible values for the transmission parameter <m>\beta</m>, as this computation requires additional thought when isolation is part of the model
              </p>
            </li>
            <li>
              <p>
                Consider that isolation may be complete or incomplete, and develop modeling methods for each scenario
              </p>
            </li>
          </ul>
        </objectives>
    
        <p>
          This chapter functions, along with <xref ref="ch-vaccines"/> and <xref ref="ch-incubation-periods"/>, as a sort of trilogy of methods for making models more realistic and for building public health interventions into models. As with vaccines, isolation of the infected is a public health approach used widely for the reduction of disease spread. As with incubation periods, isolation in a model can help that model to better fit data because the model more fully replicates what is happening in the world. 
        </p>

        <p>
          As we proceed through this chapter, we will consider complete isolation, when Infectious people have no contact at all with Susceptibles. We will also consider incomplete isolation, when Infectious people significantly reduce their contact with the general population but still have some chance of infecting Susceptibles. An example of incomplete isolation is staying home when sick, yet still interacting somewhat with roommates, family members, or others who share living space or deliver food. We will additionally spend time on thinking about how to use our parameter-based formula for <m>\mathcal{R}_0</m> in isolation models, and we will distinguish between the outbreak interventions of isolation and quarantine.
        </p>
        
        <exploration xml:id="expl-activity-isolation">
          <title>What if People Choose to Isolate?</title>
          <introduction>
            <p>
              In this activity, use the knowledge you have been building about mathematical modeling to develop two possible mathematical models, one for complete isolation and one for incomplete isolation. We set these models in fictional small, remote towns, where people interact with each other frequently, but there are not a lot of visitors to town or travel of town residents elsewhere. We therefore focus the model just on the town's residents. We also focus this model on an outbreak of a fictional ``Disease X'', for which <m>\mathcal{R}_0 \approx 4</m> and the infectious period is approximately 8 days.
            </p>            
          </introduction>
    
          <task>
            <statement>
              <p>
                First, consider ``Town A'', which has 6,000 residents, and imagine a scenario of complete isolation. That is, suppose that as soon as people know they are sick with Disease X, they isolate completely, having no contact with anyone else. Fortunately, Town A has found a way to deliver food and supplies, and to otherwise care for, people who are sick. Unfortunately, people are infectious with Disease X two days before they know they are sick, so they cannot isolate yet during those two days.
              </p>
              
            <ol>
              <li>
                  <p>
                    Write an SIR model for this outbreak, without (yet) including isolation. (Do not include vaccine or incubation period in your model.) Determine all parameter values for your model.
                  </p>
                </li>
                <li>
                  <p>
                    Adjust your SIR model to incorporate isolation, which in Town A is complete as soon as Infectious individuals know they are sick. Show both the differential equations and compartmental diagram for your adjusted model. Determine all parameter values for this adjusted model.
                  </p>
                </li>
            </ol>
            </statement>
          </task>
          <task>
            <statement>
              <p>
                Next, consider ``Town B'', which has 8,000 residents, and think of ways to model incomplete isolation. Suppose that Disease X appears in Town B, but Town B's people do not have a way to care for or deliver supplies to people who are sick. This means that friends, family members, care workers, or others interact somewhat with the Infectious who know they are sick. Therefore, isolation is not complete, though individuals do reduce their interactions with others as soon as they know they are sick, that is, typically two days after first becoming contagious.
              </p>
              
            <ol>
              <li>
                <p>
                  Adjust your original SIR model, which did not have isolation, to incorporate the incomplete isolation described for Town B. (Do not include vaccine or incubation period in your model.) Show both the differential equations and a compartmental diagram for your adjusted model. Determine all parameter values for this adjusted model.
                </p>
              </li>
              <li>
                <p>
                  Discuss the differences between your models for complete and incomplete isolation, and discuss the reasons for your modeling choices.
                </p>
              </li>
            </ol>
            </statement>
          </task>
          
        </exploration>
    
      </introduction>

    <section xml:id="sec-complete-isolation">
      <title>Complete Isolation</title>
      <p>Part (a) of <xref ref="expl-activity-isolation" /> seeks a possible model of complete isolation, in which people truly and completely isolate for some portion of their Infectious period. There are multiple ways to model this. <xref ref="activity-two-complete-isolation-models" /> describes two possible approaches for you to consider.</p>

      <activity xml:id="activity-two-complete-isolation-models">
        <statement>
          <p>
            Examine the two models shown below. Each is a possible way to adapt a standard SIR model to represent the concept of complete isolation. Pay attention to the compartments, arrows, and parameter value descriptions.  
          </p>
          <figure xml:id="fig-SIR-complete-isolation-1">
            <caption>A compartmental diagram showing one possible approach to modeling complete isolation. Infectious people move to a new compartment, labeled J for Isolation, since I is already used for Infectious. Parameters <m>\epsilon</m> and <m>\eta</m> have values determined by how long people typically remain in each of the compartments I and J, respectively.</caption>
              <image width="80%">
              <description>A compartmental diagram showing one possible approach to modeling complete isolation. The compartments are S, I, J, and R. Infectious people move to a new compartment, labeled J for Isolation, since I is already used for Infectious. The parameters epsilon and eta replace gamma, and the times associated with the values of epsilon and eta represent how long people typically remain in each of the compartments I and J, respectively. </description>
                <latex-image>
                \begin{tikzpicture}
                \draw [thick] [black] (0,0) -- (2,0);
                \draw [thick] [black] (2,0) -- (2,2);
                \draw [thick] [black] (2,2) -- (0,2);
                \draw [thick] [black] (0,2) -- (0,0);
                \node [black] at (1,1) {\Huge $S$};
                \draw [thick] [->] (2.1,1) to (3.9,1); 
                \node at (3,1.5) {\Large $\beta SI$};
                \draw [thick] [black] (4,0) -- (6,0);
                \draw [thick] [black] (6,0) -- (6,2);
                \draw [thick] [black] (6,2) -- (4,2);
                \draw [thick] [black] (4,2) -- (4,0);
                \node [black] at (5,1) {\Huge $I$};
                \draw [thick] [->] (6.1,1) to (7.9,1); 
                \node at (7,1.5) {\Large $\epsilon I$};
                \draw [thick] [black] (8,0) -- (10,0);
                \draw [thick] [black] (10,0) -- (10,2);
                \draw [thick] [black] (10,2) -- (8,2);
                \draw [thick] [black] (8,2) -- (8,0);
                \node [black] at (9,1) {\Huge $J$};
                \draw [thick] [->] (10.1,1) to (11.9,1); 
                \node at (11,1.5) {\Large $\eta J$};
                \draw [thick] [black] (12,0) -- (14,0);
                \draw [thick] [black] (14,0) -- (14,2);
                \draw [thick] [black] (14,2) -- (12,2);
                \draw [thick] [black] (12,2) -- (12,0);
                \node [black] at (13,1) {\Huge $R$};
                \end{tikzpicture}
                </latex-image>
               </image>
          </figure>
          <figure xml:id="fig-SIR-complete-isolation-2">
            <caption>A compartmental diagram showing a second possible approach to modeling complete isolation. Here, people move directly to compartment R when they isolate, since they can no longer spread disease due to complete isolation. The value of <m>\gamma</m> is adjusted compared to an SIR model with no isolation, and is labeled <m>\widetilde{\gamma}</m>, to indicate that the transition time from compartment I to compartment R is likely different than the time indicated by parameter <m>\gamma</m> in an SIR model with no isolation.</caption>
              <image width="70%">
              <description>A compartmental diagram showing a second possible approach to modeling complete isolation. The compartments are S, I, and R. Here, people move directly to compartment R when they isolate, since they can no longer spread disease due to complete isolation. The value of gamma is adjusted compared to an SIR model with no isolation, and is relabeled as gamma with a tilde over it, to indicate a more rapid transition from compartment I to compartment R.</description>
                <latex-image>
                \begin{tikzpicture}
                \draw [thick] [black] (0,0) -- (2,0);
                \draw [thick] [black] (2,0) -- (2,2);
                \draw [thick] [black] (2,2) -- (0,2);
                \draw [thick] [black] (0,2) -- (0,0);
                \node [black] at (1,1) {\Huge $S$};
                \draw [thick] [->] (2.1,1) to (3.9,1); 
                \node at (3,1.5) {\Large $\beta SI$};
                \draw [thick] [black] (4,0) -- (6,0);
                \draw [thick] [black] (6,0) -- (6,2);
                \draw [thick] [black] (6,2) -- (4,2);
                \draw [thick] [black] (4,2) -- (4,0);
                \node [black] at (5,1) {\Huge $I$};
                \draw [thick] [->] (6.1,1) to (7.9,1); 
                \node at (7,1.5) {\Large $\widetilde{\gamma} I$};
                \draw [thick] [black] (8,0) -- (10,0);
                \draw [thick] [black] (10,0) -- (10,2);
                \draw [thick] [black] (10,2) -- (8,2);
                \draw [thick] [black] (8,2) -- (8,0);
                \node [black] at (9,1) {\Huge $R$};
                \end{tikzpicture}
                </latex-image>
               </image>
          </figure>
          <p>
            Use these two models to respond to the prompts below.
          </p>
          <ol>
            <li>
              <p>
                Compare and contrast the two models. Identify and describe any advantages or disadvantages you perceive for either model. 
              </p>     
            </li>
            <li>
              <p>
                Suppose that an outbreak without isolation would use a standard SIR model having parameter values <m>\beta = 0.005</m> and <m>\gamma = 1/10</m>. Further suppose that for that same outbreak, with isolation, people isolate three days after becoming Infectious. What would be the values of <m>\beta</m>, <m>\epsilon</m>, and <m>\eta</m> for the model in <xref ref="fig-SIR-complete-isolation-1"/>? And what would be the values of <m>\beta</m> and <m>\widetilde{\gamma}</m> in <xref ref="fig-SIR-complete-isolation-2"/>?
              </p>
            </li>
          </ol>
                     
        </statement>
        <answer>
          <ol>
            <li>
              <p>
                This is an open-ended question. Possible answers may include preferring the simplicity of the second model, or preferring the detail in the first model of tracking how many people are isolating rather than removed. Responses may also refer to preferences for computing <m>\epsilon</m> and <m>\eta</m> separately, or for computing only <m>\widetilde{\gamma}</m>. There are many additional possible responses.
              </p>
            </li>
            <li>
              <p>
                For both models, the value of <m>\beta</m> should not change. 
              </p>
              <p>
                For the model in <xref ref="fig-SIR-complete-isolation-1"/>, we notice that <m>\gamma = 1/10</m> indicates a ten-day contagious period for the disease. We split up this time into the Infectious and Isolated compartments. Since people stay in the Infectious compartment for three days, we set <m>\epsilon = 1/3</m>, using the ideas from <xref ref="eq-gamma-estimate"/>, <xref ref="eq-gamma-estimate-2"/>, <xref ref="eq-kappa-estimate"/>, and <xref ref="eq-kappa-estimate-2"/>. This leaves seven days for people to stay in the Isolated compartment, to add up to their total of ten days, and so we set <m>\eta = 1/7</m>.
              </p>
              <p>
                For the model in <xref ref="fig-SIR-complete-isolation-2"/>, set <m>\widetilde{\gamma} = 1/3</m>, for a similar reason to setting <m>\epsilon = 1/3</m> for the model in <xref ref="fig-SIR-complete-isolation-1"/>. This reduces the length of time people spend in the Infectious compartment, and we consider these people to be Removed for the rest of the time they are contagious.
              </p>
            </li>
          </ol>
          
        </answer>
      </activity>

      <p>
        The models shown in <xref ref="activity-two-complete-isolation-models"/> are two common ways to show complete isolation. In both models, everyone isolates, and isolation completely prevents disease spread. 
      </p>

      <p>
        Let us take a moment to discuss the parameter values computed for the models in <xref ref="fig-SIR-complete-isolation-1"/> and <xref ref="fig-SIR-complete-isolation-2"/>. As with <m>\gamma</m> in <xref ref="ch-compartmental-diagrams"/> and <m>\kappa</m> in <xref ref="ch-incubation-periods"/>, the values for parameters <m>\widetilde{\gamma}</m>, <m>\epsilon</m>, and <m>\eta</m> are determined by the length of time spent in a compartment. Specifically, each of these parameters has a value that is the reciprocal of the time spent in that compartment, and we make sure the units of time match. For example, if we are using the model in <xref ref="fig-SIR-complete-isolation-1"/> and expect the typical person to isolate for seven days, and if our unit of time in the model is days, then <m>\eta = 1/7</m>. However, if we have a different unit of time, then we adjust, in a way similar to that shown in the first exercise in <xref ref="exercises-ch-incubation-period"/>.
      </p>
      <p>
        We also address our expectation that real-life biological information about a disease outbreak should correspond with the parameter-based formula for <m>\mathcal{R}_0</m> that we first studied in <xref ref="ch-model-analysis-and-the-basic-reproduction-number-R0"/>. This is more complicated. Real-life estimates of <m>\mathcal{R}_0</m> for past outbreaks include the possibility of some people staying home when sick. However, widespread isolation can be a strategy to reduce disease spread. Here are thoughts on how to proceed.
      </p>
      <ul>
        <li>
          <p>
            When using the parameter-based formula for <m>\mathcal{R}_0</m> to compute the value of parameter <m>\beta</m> for an outbreak, start with a model that does not include intervention by large numbers of individuals or by an entire community. For instance, with an outbreak modeled using either of the strategies in <xref ref="activity-two-complete-isolation-models"/>, use a standard SIR model for computing <m>\beta</m>. This computation uses the formula in <xref ref="eq-R0-sir"/>. 
          </p>
        </li>
        <li>
          <p>
            The reason for using a model without intervention is this: <m>\mathcal{R}_0</m> is, as we learned, <em>the average number of new infections caused by one infectious person in an otherwise entirely susceptible population</em>. Interventions, such as vaccines or widespread isolation, change the ability of a disease to infect large numbers of people. Historical values of <m>\mathcal{R}_0</m> computed from past outbreaks do not include such interventions.
          </p>
        </li> 
        <li>
          <p>
            Once you have used a standard, intervention-free version of your model, along with that model's parameter-based formula for <m>\mathcal{R}_0</m>, to estimate <m>\beta</m>, you can then incorporate isolation in your model. Possible models include those shown in <xref ref="fig-SIR-complete-isolation-1" /> and <xref ref="fig-SIR-complete-isolation-2" />. For these, do not change the value of <m>\beta</m> you have already computed, but do incorporate appropriate values of <m>\widetilde{\gamma}</m> or <m>\epsilon</m> and <m>\eta</m>. Designating parameter values in this way will allow your models to show the effects of isolation as intervention. 
          </p>
        </li>
        <li>
          <p>
            In the next section, we will show other ways to model intervention. Continue to use these approaches to determining parameter values. That is, estimate <m>\beta</m> first, in a appropriately corresponding model without intervention. Then adjust that model to include intervention, but do not change <m>\beta</m>.
          </p>
        </li>
      </ul>
      
      
      <!-- <activity xml:id="activity-sir-model-flu">
        <statement>
          <p>
            Each academic year, many college campuses experience one or more outbreaks of influenza, also referred to as flu. According to the <url href="https://www.cdc.gov/flu/about/keyfacts.htm">Centers for Disease Control and Prevention (CDC)</url>, flu symptoms may include fever, chills, cough, aches, runny or stuffy nose, and more. Also according to the CDC, influenza spreads via tiny droplets when people sneeze or cough or talk, as well as when people touch surfaces that have the virus on them and then touching parts of their face such as the mouth, nose, and eyes. 
          </p>
          <p>
            To gather information about the incubation period of flu and about how long flu is contagious, visit <url href="https://www.cdc.gov/flu/about/keyfacts.htm">this ``key facts'' page from the CDC</url>. To locate the range of <m>\mathcal{R}_0</m> values for typical influenza outbreaks, visit <url href="https://www.vdh.virginia.gov/coronavirus/2022/01/07/covid-19-and-influenza-surveillance">this page from the Virginia Department of Health</url>. For all of these values that help with modeling, you are welcome to search online for other sources: the links provided here are sufficient, but are not the only way to gather the information we seek.
          </p>
          <p>
            Use the idea of a campus outbreak to think about (at least) two ways to model isolation, guided by the prompts below.
          </p>
          <ol>
            <li>
              <p>
                Choose either the SIR or SEIR model for the spread of flu. Use the online facts you have gathered to decide whether or not to include an incubation period in your model. Be sure to explain your reasoning. (There is not a right or wrong answer here: either choice can make sense, yet it is important to justify your decision using facts about the flu.) Provide the range of parameter values for each parameter in your model, and cite your sources.
              </p>     
            </li>
            <li>
              <p>
                In many cases, people with the flu know they are sick and have the opportunity to isolate. Let us suppose that every person in an outbreak isolates after they have been sick for one day, and that they isolate perfectly. (This is unlikely in reality, but we can model this  to see the outcome.) Update your model accordingly, changing only the value of <m>\gamma</m> (which relates to the time spent in the <m>I(t)</m> population) so that people move more rapidly from compartment I to compartment R.
              </p>
            </li>
            <li>
              <p>
                Try your model in Python (INCLUDE HOW MANY PEOPLE IN THE POPULATION - and also vaccine???), first using your initial model for influenza, and then using your updated <m>\gamma</m> value to represent the complete isolation of Infectious people after only one day. Describe your results. 
              </p>
            </li>
          </ol>

          <sage>
            <input>
              #Import packages
              import numpy as np
              import matplotlib.pyplot as plt
              from scipy.integrate import odeint

              plt.cla() #Clear (delete) any past plots

              #Define the system of differential equations, and call it "model"
              def model(y, t):
                S, E, I, R = y #Define y as consisting of S, E, I, and R, in that order
                dydt = [- beta * S * I, beta * S * I - kappa * E, kappa * E - gamma * I, gamma * I] #Provide the right-hand sides of the SEIR model
                return dydt

              # The parameter values below are set to 0.0. Enter the values you have computed to see how the model proceeds
              R0 = 0.0 #Give a value to R0
              kappa = 0.0 #Give a value to kappa
              gamma = 0.0 #Give a value to gamma
              S_init = 9995 #Give an initial value to population S
              E_init = 0 #Give an initial value to population E
              I_init = 5 #Give an initial value to population I
              R_init = 0 #Give an initial value to population R
              beta = R0 * gamma / (S_init + E_init + I_init + R_init) #Solve for beta, using the R0 formula
              y0 = [S_init, E_init, I_init, R_init] #Put initial conditions for S, E, I, and R into "y0" for use below in "odeint"

              # The time range below is set for one year. Make it longer or shorter, as needed, to better see the full dynamics of the model
              t_range = np.arange(0.0, 365.0, 0.1) #Set the time range and increment of time steps to be used for numerically solving

              sol = odeint(model, y0, t_range) #Give the name "sol" to the lists of numerical values in the solution, and give "odeint" the information needed to solve

              # Tell Python to print the last values produced of S, I, and R, to help show long-range outcomes of the model
              print("Long-term value of S = ", round(sol[-1,0]))
              print("Long-term value of E = ", round(sol[-1,1]))
              print("Long-term value of I = ", round(sol[-1,2]))
              print("Long-term value of R = ", round(sol[-1,3]))

              # Plotting commands are below
              plt.plot(t_range, sol[:, 0], color='blue', linewidth=2, label='S(t)')
              plt.plot(t_range, sol[:, 1], color='magenta', linestyle='dotted', linewidth=2, label='E(t)')
              plt.plot(t_range, sol[:, 2], color='orange', linestyle='dashed', linewidth=2, label='I(t)')
              plt.plot(t_range, sol[:, 3], color='teal', linestyle='dashdot', linewidth=2, label='R(t)')
              plt.legend()
              plt.grid()
              plt.xlabel('time')
              plt.ylabel('populations')
              plt.show()
            </input>
            <output>
            
            </output>
          </sage>
                     
        </statement>
        <answer>
          <ol>
            <li>
              <p>
                The incubation period is usually 7 to 10 days, so <m>\kappa</m> is in the range <m>\frac{1}{10}- \frac{1}{7}</m>. (The incubation period can be shorter or longer, and if you included this information, you will have a wider range of values for <m>\kappa</m>. This is also valid.)
              </p>
              <p>
                Pertussis begins to be contagious when cold symptoms appear, and the phase for cold symptoms is one to two weeks. Pertussis is most contagious for up to three weeks after the intense coughing phase begins. Adding these phases together, pertussis is contagious, or most contagious, for four to five weeks, meaning 28 to 35 days. So <m>\gamma</m> is in the range <m>\frac{1}{35}- \frac{1}{28}</m>. (Saying <q>up to</q> three weeks suggests people may not be contagious the full three weeks. And pertussis may be contagious, at a lower level, more than three weeks after severe cough begins. You may have built either of these facts into your answer, which may lead to a different answer.)
              </p>
            </li>
            <li>
              <p>
                Rearranging <xref ref="eq-R0-seir"/> leads to <m>\beta = \gamma \mathcal{R}_0 / N</m>. Using the range of values <m>5.5 \leq \mathcal{R}_0 \leq 17</m> and <m>\frac{1}{35} \leq \gamma \leq \frac{1}{28}</m>, along with <m>N = 10,000</m>, gives the range of values <m>0.000157 \leq \beta \leq 0.000607</m>. Your range of <m>\beta</m> values should be based on the parameter values you determined.
              </p>
            </li>
            <li>
              <p>
                This is open-ended. Make as many observations as you can.
              </p>
            </li>
          </ol>
          
        </answer>
      </activity> -->




    </section>

  </chapter>