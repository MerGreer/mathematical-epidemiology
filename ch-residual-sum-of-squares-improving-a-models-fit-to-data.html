<!DOCTYPE html>
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<html lang="en-US" dir="ltr">
<head xmlns:og="http://ogp.me/ns#" xmlns:book="https://ogp.me/ns/book#">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>* Residual Sum of Squares: Improving a Model’s Fit to Data</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:type" content="book">
<meta property="book:title" content="Mathematical Epidemiology and More">
<meta property="book:author" content="Meredith L. Greer">
<script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script><script>
var runestoneMathReady = new Promise((resolve) => window.rsMathReady = resolve);
window.MathJax = {
  "tex": {
    "inlineMath": [
      [
        "\\(",
        "\\)"
      ]
    ],
    "tags": "none",
    "tagSide": "right",
    "tagIndent": ".8em",
    "packages": {
      "[+]": [
        "base",
        "extpfeil",
        "ams",
        "amscd",
        "color",
        "newcommand",
        "knowl"
      ]
    }
  },
  "options": {
    "ignoreHtmlClass": "tex2jax_ignore|ignore-math",
    "processHtmlClass": "process-math",
    "renderActions": {
      "findScript": [
        10,
        function (doc) {
            document.querySelectorAll('script[type^="math/tex"]').forEach(function(node) {
                var display = !!node.type.match(/; *mode=display/);
                var math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                var text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = {node: text, delim: '', n: 0};
                math.end = {node: text, delim: '', n: 0};
                doc.math.push(math);
            });
        },
        ""
      ]
    }
  },
  "chtml": {
    "scale": 0.98,
    "mtextInheritFont": true
  },
  "loader": {
    "load": [
      "input/asciimath",
      "[tex]/extpfeil",
      "[tex]/amscd",
      "[tex]/color",
      "[tex]/newcommand",
      "[pretext]/mathjaxknowl3.js"
    ],
    "paths": {
      "pretext": "_static/pretext/js/lib"
    }
  },
  "startup": {
    pageReady() {
      return MathJax.startup.defaultPageReady().then(function () {
      console.log("in ready function");
      rsMathReady();
      }
    )}
  }
};
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><script>// Make *any* pre with class 'sagecell-sage' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({
  "inputLocation": "pre.sagecell-sage",
  "linked": true,
  "linkKey": "linked-sage",
  "autoeval": false,
  "languages": [
    "sage"
  ],
  "evalButtonText": "Evaluate (Sage)"
});
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js" integrity="sha512-4xUl/d6D6THrAnXAwGajXkoWaeMNwEKK4iNfq5DotEbLPAfk6FSxSP3ydNxqDgCw1c/0Z1Jg6L8h2j+++9BZmg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="lunr-pretext-search-index.js" async=""></script><script src="_static/pretext/js/pretext_search.js"></script><link href="_static/pretext/css/pretext_search.css" rel="stylesheet" type="text/css">
<script src="_static/pretext/js/lib/jquery.min.js"></script><script src="_static/pretext/js/lib/jquery.sticky.js"></script><script src="_static/pretext/js/lib/jquery.espy.min.js"></script><script src="_static/pretext/js/pretext.js"></script><script src="_static/pretext/js/pretext_add_on.js?x=1"></script><script src="_static/pretext/js/user_preferences.js"></script><script src="_static/pretext/js/lib/knowl.js"></script><!--knowl.js code controls Sage Cells within knowls--><script>sagecellEvalName='Evaluate (Sage)';
</script><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@400;700&amp;family=Noto+Serif:ital,wght@0,400;0,700;1,400;1,700&amp;family=Tinos:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet">
<link href="https://fonts.cdnfonts.com/css/dejavu-serif" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Roboto+Serif:opsz,wdth,wght@8..144,50..150,100..900&amp;display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Open+Sans:wdth,wght@75..100,300..800&amp;display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200">
<link href="_static/pretext/css/pretext.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/pretext_add_on.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/shell_default.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/banner_default.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/navbar_default.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/toc_default.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/knowls_default.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/style_default.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/colors_blue_red.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/setcolors.css" rel="stylesheet" type="text/css">
<style>
#expl-reading-about-disease-in-the-news-and-popular-media-4-1-2 { counter-set: expl-reading-about-disease-in-the-news-and-popular-media-4-1-2 0; }
#expl-reading-about-disease-in-the-news-and-popular-media-4-1-2 > li::marker { content: ""counter(expl-reading-about-disease-in-the-news-and-popular-media-4-1-2,decimal)"."; }
#expl-reading-about-disease-in-the-news-and-popular-media-4-1-2 > li { counter-increment: expl-reading-about-disease-in-the-news-and-popular-media-4-1-2; }
#sec-Follow-Up-By-Seeking-More-Precise-Data-4-1-1-1 { counter-set: sec-Follow-Up-By-Seeking-More-Precise-Data-4-1-1-1 0; }
#sec-Follow-Up-By-Seeking-More-Precise-Data-4-1-1-1 > li::marker { content: ""counter(sec-Follow-Up-By-Seeking-More-Precise-Data-4-1-1-1,decimal)"."; }
#sec-Follow-Up-By-Seeking-More-Precise-Data-4-1-1-1 > li { counter-increment: sec-Follow-Up-By-Seeking-More-Precise-Data-4-1-1-1; }
#exer-begin-zombie-app-1-2 { counter-set: exer-begin-zombie-app-1-2 0; }
#exer-begin-zombie-app-1-2 > li::marker { content: ""counter(exer-begin-zombie-app-1-2,decimal)"."; }
#exer-begin-zombie-app-1-2 > li { counter-increment: exer-begin-zombie-app-1-2; }
#sec-we-now-have-data-qualitative-musings-5-1-2 { counter-set: sec-we-now-have-data-qualitative-musings-5-1-2 0; }
#sec-we-now-have-data-qualitative-musings-5-1-2 > li::marker { content: ""counter(sec-we-now-have-data-qualitative-musings-5-1-2,decimal)"."; }
#sec-we-now-have-data-qualitative-musings-5-1-2 > li { counter-increment: sec-we-now-have-data-qualitative-musings-5-1-2; }
#sec-a-first-model-6-1-2 { counter-set: sec-a-first-model-6-1-2 0; }
#sec-a-first-model-6-1-2 > li::marker { content: ""counter(sec-a-first-model-6-1-2,decimal)"."; }
#sec-a-first-model-6-1-2 > li { counter-increment: sec-a-first-model-6-1-2; }
#sec-a-first-model-18-1-3 { counter-set: sec-a-first-model-18-1-3 0; }
#sec-a-first-model-18-1-3 > li::marker { content: ""counter(sec-a-first-model-18-1-3,decimal)"."; }
#sec-a-first-model-18-1-3 > li { counter-increment: sec-a-first-model-18-1-3; }
#exercises-ch-zombies-can-math-help-1-2 { counter-set: exercises-ch-zombies-can-math-help-1-2 0; }
#exercises-ch-zombies-can-math-help-1-2 > li::marker { content: "("counter(exercises-ch-zombies-can-math-help-1-2,lower-alpha)")"; }
#exercises-ch-zombies-can-math-help-1-2 > li { counter-increment: exercises-ch-zombies-can-math-help-1-2; }
#exercises-ch-zombies-can-math-help-2-2 { counter-set: exercises-ch-zombies-can-math-help-2-2 0; }
#exercises-ch-zombies-can-math-help-2-2 > li::marker { content: "("counter(exercises-ch-zombies-can-math-help-2-2,lower-alpha)")"; }
#exercises-ch-zombies-can-math-help-2-2 > li { counter-increment: exercises-ch-zombies-can-math-help-2-2; }
#exercises-ch-zombies-can-math-help-3-2 { counter-set: exercises-ch-zombies-can-math-help-3-2 0; }
#exercises-ch-zombies-can-math-help-3-2 > li::marker { content: "("counter(exercises-ch-zombies-can-math-help-3-2,lower-alpha)")"; }
#exercises-ch-zombies-can-math-help-3-2 > li { counter-increment: exercises-ch-zombies-can-math-help-3-2; }
#sec-solving-differential-equations-using-graphs-10 { counter-set: sec-solving-differential-equations-using-graphs-10 0; }
#sec-solving-differential-equations-using-graphs-10 > li::marker { content: ""counter(sec-solving-differential-equations-using-graphs-10,decimal)"."; }
#sec-solving-differential-equations-using-graphs-10 > li { counter-increment: sec-solving-differential-equations-using-graphs-10; }
#exer-first-odeint-code-2-1-1 { counter-set: exer-first-odeint-code-2-1-1 0; }
#exer-first-odeint-code-2-1-1 > li::marker { content: ""counter(exer-first-odeint-code-2-1-1,decimal)"."; }
#exer-first-odeint-code-2-1-1 > li { counter-increment: exer-first-odeint-code-2-1-1; }
#exercises-visualization-graphing-model-results-and-data-1-1-2 { counter-set: exercises-visualization-graphing-model-results-and-data-1-1-2 0; }
#exercises-visualization-graphing-model-results-and-data-1-1-2 > li::marker { content: "("counter(exercises-visualization-graphing-model-results-and-data-1-1-2,lower-alpha)")"; }
#exercises-visualization-graphing-model-results-and-data-1-1-2 > li { counter-increment: exercises-visualization-graphing-model-results-and-data-1-1-2; }
#exercises-visualization-graphing-model-results-and-data-2-2 { counter-set: exercises-visualization-graphing-model-results-and-data-2-2 0; }
#exercises-visualization-graphing-model-results-and-data-2-2 > li::marker { content: "("counter(exercises-visualization-graphing-model-results-and-data-2-2,lower-alpha)")"; }
#exercises-visualization-graphing-model-results-and-data-2-2 > li { counter-increment: exercises-visualization-graphing-model-results-and-data-2-2; }
#exercises-visualization-graphing-model-results-and-data-3-2 { counter-set: exercises-visualization-graphing-model-results-and-data-3-2 0; }
#exercises-visualization-graphing-model-results-and-data-3-2 > li::marker { content: "("counter(exercises-visualization-graphing-model-results-and-data-3-2,lower-alpha)")"; }
#exercises-visualization-graphing-model-results-and-data-3-2 > li { counter-increment: exercises-visualization-graphing-model-results-and-data-3-2; }
#activity-sir-diagram-and-des-1-2 { counter-set: activity-sir-diagram-and-des-1-2 0; }
#activity-sir-diagram-and-des-1-2 > li::marker { content: ""counter(activity-sir-diagram-and-des-1-2,decimal)"."; }
#activity-sir-diagram-and-des-1-2 > li { counter-increment: activity-sir-diagram-and-des-1-2; }
#activity-sir-diagram-and-des-2-1 { counter-set: activity-sir-diagram-and-des-2-1 0; }
#activity-sir-diagram-and-des-2-1 > li::marker { content: ""counter(activity-sir-diagram-and-des-2-1,decimal)"."; }
#activity-sir-diagram-and-des-2-1 > li { counter-increment: activity-sir-diagram-and-des-2-1; }
#activity-sir-diagram-and-des-3-1 { counter-set: activity-sir-diagram-and-des-3-1 0; }
#activity-sir-diagram-and-des-3-1 > li::marker { content: ""counter(activity-sir-diagram-and-des-3-1,decimal)"."; }
#activity-sir-diagram-and-des-3-1 > li { counter-increment: activity-sir-diagram-and-des-3-1; }
#activity-introducing-units-1-4 { counter-set: activity-introducing-units-1-4 0; }
#activity-introducing-units-1-4 > li::marker { content: ""counter(activity-introducing-units-1-4,decimal)"."; }
#activity-introducing-units-1-4 > li { counter-increment: activity-introducing-units-1-4; }
#activity-introducing-units-2-1 { counter-set: activity-introducing-units-2-1 0; }
#activity-introducing-units-2-1 > li::marker { content: ""counter(activity-introducing-units-2-1,decimal)"."; }
#activity-introducing-units-2-1 > li { counter-increment: activity-introducing-units-2-1; }
#activity-three-sets-of-parameters-1-5 { counter-set: activity-three-sets-of-parameters-1-5 0; }
#activity-three-sets-of-parameters-1-5 > li::marker { content: ""counter(activity-three-sets-of-parameters-1-5,decimal)"."; }
#activity-three-sets-of-parameters-1-5 > li { counter-increment: activity-three-sets-of-parameters-1-5; }
#activity-three-sets-of-parameters-2-1 { counter-set: activity-three-sets-of-parameters-2-1 0; }
#activity-three-sets-of-parameters-2-1 > li::marker { content: ""counter(activity-three-sets-of-parameters-2-1,decimal)"."; }
#activity-three-sets-of-parameters-2-1 > li { counter-increment: activity-three-sets-of-parameters-2-1; }
#activity-formula-for-i-of-t-turning-around-1-2 { counter-set: activity-formula-for-i-of-t-turning-around-1-2 0; }
#activity-formula-for-i-of-t-turning-around-1-2 > li::marker { content: ""counter(activity-formula-for-i-of-t-turning-around-1-2,decimal)"."; }
#activity-formula-for-i-of-t-turning-around-1-2 > li { counter-increment: activity-formula-for-i-of-t-turning-around-1-2; }
#activity-formula-for-i-of-t-turning-around-2-1 { counter-set: activity-formula-for-i-of-t-turning-around-2-1 0; }
#activity-formula-for-i-of-t-turning-around-2-1 > li::marker { content: ""counter(activity-formula-for-i-of-t-turning-around-2-1,decimal)"."; }
#activity-formula-for-i-of-t-turning-around-2-1 > li { counter-increment: activity-formula-for-i-of-t-turning-around-2-1; }
#exercises-ch-populations-and-R0-1-4 { counter-set: exercises-ch-populations-and-R0-1-4 0; }
#exercises-ch-populations-and-R0-1-4 > li::marker { content: "("counter(exercises-ch-populations-and-R0-1-4,lower-alpha)")"; }
#exercises-ch-populations-and-R0-1-4 > li { counter-increment: exercises-ch-populations-and-R0-1-4; }
#exercises-ch-populations-and-R0-2-2 { counter-set: exercises-ch-populations-and-R0-2-2 0; }
#exercises-ch-populations-and-R0-2-2 > li::marker { content: "("counter(exercises-ch-populations-and-R0-2-2,lower-alpha)")"; }
#exercises-ch-populations-and-R0-2-2 > li { counter-increment: exercises-ch-populations-and-R0-2-2; }
#exercises-ch-populations-and-R0-3-3 { counter-set: exercises-ch-populations-and-R0-3-3 0; }
#exercises-ch-populations-and-R0-3-3 > li::marker { content: "("counter(exercises-ch-populations-and-R0-3-3,lower-alpha)")"; }
#exercises-ch-populations-and-R0-3-3 > li { counter-increment: exercises-ch-populations-and-R0-3-3; }
#expl-activity-vaccines-3-1-4 { counter-set: expl-activity-vaccines-3-1-4 0; }
#expl-activity-vaccines-3-1-4 > li::marker { content: ""counter(expl-activity-vaccines-3-1-4,decimal)"."; }
#expl-activity-vaccines-3-1-4 > li { counter-increment: expl-activity-vaccines-3-1-4; }
#expl-activity-vaccines-4-1-2 { counter-set: expl-activity-vaccines-4-1-2 0; }
#expl-activity-vaccines-4-1-2 > li::marker { content: ""counter(expl-activity-vaccines-4-1-2,decimal)"."; }
#expl-activity-vaccines-4-1-2 > li { counter-increment: expl-activity-vaccines-4-1-2; }
#activity-pcrit-1-2 { counter-set: activity-pcrit-1-2 0; }
#activity-pcrit-1-2 > li::marker { content: ""counter(activity-pcrit-1-2,decimal)"."; }
#activity-pcrit-1-2 > li { counter-increment: activity-pcrit-1-2; }
#activity-pcrit-2-1 { counter-set: activity-pcrit-2-1 0; }
#activity-pcrit-2-1 > li::marker { content: ""counter(activity-pcrit-2-1,decimal)"."; }
#activity-pcrit-2-1 > li { counter-increment: activity-pcrit-2-1; }
#activity-pcrit2-1-6 { counter-set: activity-pcrit2-1-6 0; }
#activity-pcrit2-1-6 > li::marker { content: ""counter(activity-pcrit2-1-6,decimal)"."; }
#activity-pcrit2-1-6 > li { counter-increment: activity-pcrit2-1-6; }
#activity-pcrit2-2-1 { counter-set: activity-pcrit2-2-1 0; }
#activity-pcrit2-2-1 > li::marker { content: ""counter(activity-pcrit2-2-1,decimal)"."; }
#activity-pcrit2-2-1 > li { counter-increment: activity-pcrit2-2-1; }
#activity-vaccine-effectiveness-1-6 { counter-set: activity-vaccine-effectiveness-1-6 0; }
#activity-vaccine-effectiveness-1-6 > li::marker { content: ""counter(activity-vaccine-effectiveness-1-6,decimal)"."; }
#activity-vaccine-effectiveness-1-6 > li { counter-increment: activity-vaccine-effectiveness-1-6; }
#activity-vaccine-effectiveness-1-6-1-1-1 { counter-set: activity-vaccine-effectiveness-1-6-1-1-1 0; }
#activity-vaccine-effectiveness-1-6-1-1-1 > li::marker { content: "("counter(activity-vaccine-effectiveness-1-6-1-1-1,lower-alpha)")"; }
#activity-vaccine-effectiveness-1-6-1-1-1 > li { counter-increment: activity-vaccine-effectiveness-1-6-1-1-1; }
#activity-vaccine-effectiveness-2-1 { counter-set: activity-vaccine-effectiveness-2-1 0; }
#activity-vaccine-effectiveness-2-1 > li::marker { content: ""counter(activity-vaccine-effectiveness-2-1,decimal)"."; }
#activity-vaccine-effectiveness-2-1 > li { counter-increment: activity-vaccine-effectiveness-2-1; }
#activity-vaccine-effectiveness-2-1-1-1 { counter-set: activity-vaccine-effectiveness-2-1-1-1 0; }
#activity-vaccine-effectiveness-2-1-1-1 > li::marker { content: "("counter(activity-vaccine-effectiveness-2-1-1-1,lower-alpha)")"; }
#activity-vaccine-effectiveness-2-1-1-1 > li { counter-increment: activity-vaccine-effectiveness-2-1-1-1; }
#exercises-ch-vaccines-1-3 { counter-set: exercises-ch-vaccines-1-3 0; }
#exercises-ch-vaccines-1-3 > li::marker { content: "("counter(exercises-ch-vaccines-1-3,lower-alpha)")"; }
#exercises-ch-vaccines-1-3 > li { counter-increment: exercises-ch-vaccines-1-3; }
#exercises-ch-vaccines-2-2 { counter-set: exercises-ch-vaccines-2-2 0; }
#exercises-ch-vaccines-2-2 > li::marker { content: "("counter(exercises-ch-vaccines-2-2,lower-alpha)")"; }
#exercises-ch-vaccines-2-2 > li { counter-increment: exercises-ch-vaccines-2-2; }
#exercises-ch-vaccines-3-2 { counter-set: exercises-ch-vaccines-3-2 0; }
#exercises-ch-vaccines-3-2 > li::marker { content: "("counter(exercises-ch-vaccines-3-2,lower-alpha)")"; }
#exercises-ch-vaccines-3-2 > li { counter-increment: exercises-ch-vaccines-3-2; }
#exercises-ch-vaccines-3-2-1-4 { counter-set: exercises-ch-vaccines-3-2-1-4 0; }
#exercises-ch-vaccines-3-2-1-4 > li::marker { content: ""counter(exercises-ch-vaccines-3-2-1-4,lower-roman)"."; }
#exercises-ch-vaccines-3-2-1-4 > li { counter-increment: exercises-ch-vaccines-3-2-1-4; }
#exercises-ch-vaccines-3-2-2-3 { counter-set: exercises-ch-vaccines-3-2-2-3 0; }
#exercises-ch-vaccines-3-2-2-3 > li::marker { content: ""counter(exercises-ch-vaccines-3-2-2-3,lower-roman)"."; }
#exercises-ch-vaccines-3-2-2-3 > li { counter-increment: exercises-ch-vaccines-3-2-2-3; }
#expl-activity-incubation-3-1-2 { counter-set: expl-activity-incubation-3-1-2 0; }
#expl-activity-incubation-3-1-2 > li::marker { content: ""counter(expl-activity-incubation-3-1-2,decimal)"."; }
#expl-activity-incubation-3-1-2 > li { counter-increment: expl-activity-incubation-3-1-2; }
#expl-activity-incubation-4-1-3 { counter-set: expl-activity-incubation-4-1-3 0; }
#expl-activity-incubation-4-1-3 > li::marker { content: ""counter(expl-activity-incubation-4-1-3,decimal)"."; }
#expl-activity-incubation-4-1-3 > li { counter-increment: expl-activity-incubation-4-1-3; }
#activity-seir-model-intro-1-2 { counter-set: activity-seir-model-intro-1-2 0; }
#activity-seir-model-intro-1-2 > li::marker { content: ""counter(activity-seir-model-intro-1-2,decimal)"."; }
#activity-seir-model-intro-1-2 > li { counter-increment: activity-seir-model-intro-1-2; }
#activity-seir-model-intro-2-1 { counter-set: activity-seir-model-intro-2-1 0; }
#activity-seir-model-intro-2-1 > li::marker { content: ""counter(activity-seir-model-intro-2-1,decimal)"."; }
#activity-seir-model-intro-2-1 > li { counter-increment: activity-seir-model-intro-2-1; }
#activity-seir-model-play-with-kappa-1-2 { counter-set: activity-seir-model-play-with-kappa-1-2 0; }
#activity-seir-model-play-with-kappa-1-2 > li::marker { content: ""counter(activity-seir-model-play-with-kappa-1-2,decimal)"."; }
#activity-seir-model-play-with-kappa-1-2 > li { counter-increment: activity-seir-model-play-with-kappa-1-2; }
#activity-seir-model-play-with-kappa-2-1 { counter-set: activity-seir-model-play-with-kappa-2-1 0; }
#activity-seir-model-play-with-kappa-2-1 > li::marker { content: ""counter(activity-seir-model-play-with-kappa-2-1,decimal)"."; }
#activity-seir-model-play-with-kappa-2-1 > li { counter-increment: activity-seir-model-play-with-kappa-2-1; }
#activity-seir-model-pertussis-setup-1-2 { counter-set: activity-seir-model-pertussis-setup-1-2 0; }
#activity-seir-model-pertussis-setup-1-2 > li::marker { content: ""counter(activity-seir-model-pertussis-setup-1-2,decimal)"."; }
#activity-seir-model-pertussis-setup-1-2 > li { counter-increment: activity-seir-model-pertussis-setup-1-2; }
#activity-seir-model-pertussis-setup-2-1 { counter-set: activity-seir-model-pertussis-setup-2-1 0; }
#activity-seir-model-pertussis-setup-2-1 > li::marker { content: ""counter(activity-seir-model-pertussis-setup-2-1,decimal)"."; }
#activity-seir-model-pertussis-setup-2-1 > li { counter-increment: activity-seir-model-pertussis-setup-2-1; }
#exercises-ch-incubation-period-1-2 { counter-set: exercises-ch-incubation-period-1-2 0; }
#exercises-ch-incubation-period-1-2 > li::marker { content: "("counter(exercises-ch-incubation-period-1-2,lower-alpha)")"; }
#exercises-ch-incubation-period-1-2 > li { counter-increment: exercises-ch-incubation-period-1-2; }
#exercises-ch-incubation-period-2-3 { counter-set: exercises-ch-incubation-period-2-3 0; }
#exercises-ch-incubation-period-2-3 > li::marker { content: "("counter(exercises-ch-incubation-period-2-3,lower-alpha)")"; }
#exercises-ch-incubation-period-2-3 > li { counter-increment: exercises-ch-incubation-period-2-3; }
#expl-activity-isolation-3-1-2 { counter-set: expl-activity-isolation-3-1-2 0; }
#expl-activity-isolation-3-1-2 > li::marker { content: ""counter(expl-activity-isolation-3-1-2,decimal)"."; }
#expl-activity-isolation-3-1-2 > li { counter-increment: expl-activity-isolation-3-1-2; }
#expl-activity-isolation-4-1-2 { counter-set: expl-activity-isolation-4-1-2 0; }
#expl-activity-isolation-4-1-2 > li::marker { content: ""counter(expl-activity-isolation-4-1-2,decimal)"."; }
#expl-activity-isolation-4-1-2 > li { counter-increment: expl-activity-isolation-4-1-2; }
#activity-two-complete-isolation-models-1-5 { counter-set: activity-two-complete-isolation-models-1-5 0; }
#activity-two-complete-isolation-models-1-5 > li::marker { content: ""counter(activity-two-complete-isolation-models-1-5,decimal)"."; }
#activity-two-complete-isolation-models-1-5 > li { counter-increment: activity-two-complete-isolation-models-1-5; }
#activity-two-complete-isolation-models-2-1 { counter-set: activity-two-complete-isolation-models-2-1 0; }
#activity-two-complete-isolation-models-2-1 > li::marker { content: ""counter(activity-two-complete-isolation-models-2-1,decimal)"."; }
#activity-two-complete-isolation-models-2-1 > li { counter-increment: activity-two-complete-isolation-models-2-1; }
#sec-complete-isolation-models-and-parameter-estimation-7 { counter-set: sec-complete-isolation-models-and-parameter-estimation-7 0; }
#sec-complete-isolation-models-and-parameter-estimation-7 > li::marker { content: ""counter(sec-complete-isolation-models-and-parameter-estimation-7,decimal)"."; }
#sec-complete-isolation-models-and-parameter-estimation-7 > li { counter-increment: sec-complete-isolation-models-and-parameter-estimation-7; }
#activity-two-incomplete-isolation-models-1-5 { counter-set: activity-two-incomplete-isolation-models-1-5 0; }
#activity-two-incomplete-isolation-models-1-5 > li::marker { content: ""counter(activity-two-incomplete-isolation-models-1-5,decimal)"."; }
#activity-two-incomplete-isolation-models-1-5 > li { counter-increment: activity-two-incomplete-isolation-models-1-5; }
#activity-two-incomplete-isolation-models-2-1 { counter-set: activity-two-incomplete-isolation-models-2-1 0; }
#activity-two-incomplete-isolation-models-2-1 > li::marker { content: ""counter(activity-two-incomplete-isolation-models-2-1,decimal)"."; }
#activity-two-incomplete-isolation-models-2-1 > li { counter-increment: activity-two-incomplete-isolation-models-2-1; }
#activity-sir-model-flu-1-4 { counter-set: activity-sir-model-flu-1-4 0; }
#activity-sir-model-flu-1-4 > li::marker { content: ""counter(activity-sir-model-flu-1-4,decimal)"."; }
#activity-sir-model-flu-1-4 > li { counter-increment: activity-sir-model-flu-1-4; }
#activity-sir-model-flu-2-1 { counter-set: activity-sir-model-flu-2-1 0; }
#activity-sir-model-flu-2-1 > li::marker { content: ""counter(activity-sir-model-flu-2-1,decimal)"."; }
#activity-sir-model-flu-2-1 > li { counter-increment: activity-sir-model-flu-2-1; }
#exercises-ch-isolation-1-2 { counter-set: exercises-ch-isolation-1-2 0; }
#exercises-ch-isolation-1-2 > li::marker { content: "("counter(exercises-ch-isolation-1-2,lower-alpha)")"; }
#exercises-ch-isolation-1-2 > li { counter-increment: exercises-ch-isolation-1-2; }
#exercises-ch-isolation-2-2 { counter-set: exercises-ch-isolation-2-2 0; }
#exercises-ch-isolation-2-2 > li::marker { content: "("counter(exercises-ch-isolation-2-2,lower-alpha)")"; }
#exercises-ch-isolation-2-2 > li { counter-increment: exercises-ch-isolation-2-2; }
#activity-incidence-prevalence-1-4 { counter-set: activity-incidence-prevalence-1-4 0; }
#activity-incidence-prevalence-1-4 > li::marker { content: ""counter(activity-incidence-prevalence-1-4,decimal)"."; }
#activity-incidence-prevalence-1-4 > li { counter-increment: activity-incidence-prevalence-1-4; }
#activity-incidence-prevalence-2-1 { counter-set: activity-incidence-prevalence-2-1 0; }
#activity-incidence-prevalence-2-1 > li::marker { content: ""counter(activity-incidence-prevalence-2-1,decimal)"."; }
#activity-incidence-prevalence-2-1 > li { counter-increment: activity-incidence-prevalence-2-1; }
#activity-h1n1-data-fall-2009-1-5 { counter-set: activity-h1n1-data-fall-2009-1-5 0; }
#activity-h1n1-data-fall-2009-1-5 > li::marker { content: ""counter(activity-h1n1-data-fall-2009-1-5,decimal)"."; }
#activity-h1n1-data-fall-2009-1-5 > li { counter-increment: activity-h1n1-data-fall-2009-1-5; }
#activity-h1n1-data-fall-2009-S-I-R-1-2 { counter-set: activity-h1n1-data-fall-2009-S-I-R-1-2 0; }
#activity-h1n1-data-fall-2009-S-I-R-1-2 > li::marker { content: ""counter(activity-h1n1-data-fall-2009-S-I-R-1-2,decimal)"."; }
#activity-h1n1-data-fall-2009-S-I-R-1-2 > li { counter-increment: activity-h1n1-data-fall-2009-S-I-R-1-2; }
#expl-RSS-3-1-2 { counter-set: expl-RSS-3-1-2 0; }
#expl-RSS-3-1-2 > li::marker { content: ""counter(expl-RSS-3-1-2,decimal)"."; }
#expl-RSS-3-1-2 > li { counter-increment: expl-RSS-3-1-2; }
#expl-RSS-4-1-2 { counter-set: expl-RSS-4-1-2 0; }
#expl-RSS-4-1-2 > li::marker { content: ""counter(expl-RSS-4-1-2,decimal)"."; }
#expl-RSS-4-1-2 > li { counter-increment: expl-RSS-4-1-2; }
#expl-RSS-5-1-2 { counter-set: expl-RSS-5-1-2 0; }
#expl-RSS-5-1-2 > li::marker { content: ""counter(expl-RSS-5-1-2,decimal)"."; }
#expl-RSS-5-1-2 > li { counter-increment: expl-RSS-5-1-2; }
#activity-rss-intro-1-4 { counter-set: activity-rss-intro-1-4 0; }
#activity-rss-intro-1-4 > li::marker { content: ""counter(activity-rss-intro-1-4,decimal)"."; }
#activity-rss-intro-1-4 > li { counter-increment: activity-rss-intro-1-4; }
#activity-rss-intro-1-4-2-2 { counter-set: activity-rss-intro-1-4-2-2 0; }
#activity-rss-intro-1-4-2-2 > li::marker { content: "("counter(activity-rss-intro-1-4-2-2,lower-alpha)")"; }
#activity-rss-intro-1-4-2-2 > li { counter-increment: activity-rss-intro-1-4-2-2; }
#activity-rss-intro-2-1 { counter-set: activity-rss-intro-2-1 0; }
#activity-rss-intro-2-1 > li::marker { content: ""counter(activity-rss-intro-2-1,decimal)"."; }
#activity-rss-intro-2-1 > li { counter-increment: activity-rss-intro-2-1; }
#activity-rss-intro-2-1-2-1 { counter-set: activity-rss-intro-2-1-2-1 0; }
#activity-rss-intro-2-1-2-1 > li::marker { content: "("counter(activity-rss-intro-2-1-2-1,lower-alpha)")"; }
#activity-rss-intro-2-1-2-1 > li { counter-increment: activity-rss-intro-2-1-2-1; }
#sec-underlying-math-rss-10 { counter-set: sec-underlying-math-rss-10 0; }
#sec-underlying-math-rss-10 > li::marker { content: ""counter(sec-underlying-math-rss-10,decimal)"."; }
#sec-underlying-math-rss-10 > li { counter-increment: sec-underlying-math-rss-10; }
#activity-rss-beta-loop-1-3 { counter-set: activity-rss-beta-loop-1-3 0; }
#activity-rss-beta-loop-1-3 > li::marker { content: ""counter(activity-rss-beta-loop-1-3,decimal)"."; }
#activity-rss-beta-loop-1-3 > li { counter-increment: activity-rss-beta-loop-1-3; }
#activity-rss-beta-loop-2-1 { counter-set: activity-rss-beta-loop-2-1 0; }
#activity-rss-beta-loop-2-1 > li::marker { content: ""counter(activity-rss-beta-loop-2-1,decimal)"."; }
#activity-rss-beta-loop-2-1 > li { counter-increment: activity-rss-beta-loop-2-1; }
#exercises-ch-rss-1-3 { counter-set: exercises-ch-rss-1-3 0; }
#exercises-ch-rss-1-3 > li::marker { content: "("counter(exercises-ch-rss-1-3,lower-alpha)")"; }
#exercises-ch-rss-1-3 > li { counter-increment: exercises-ch-rss-1-3; }
#expl-activity-next-generation-method-3-1-2 { counter-set: expl-activity-next-generation-method-3-1-2 0; }
#expl-activity-next-generation-method-3-1-2 > li::marker { content: ""counter(expl-activity-next-generation-method-3-1-2,decimal)"."; }
#expl-activity-next-generation-method-3-1-2 > li { counter-increment: expl-activity-next-generation-method-3-1-2; }
#expl-activity-next-generation-method-4-1-2 { counter-set: expl-activity-next-generation-method-4-1-2 0; }
#expl-activity-next-generation-method-4-1-2 > li::marker { content: ""counter(expl-activity-next-generation-method-4-1-2,decimal)"."; }
#expl-activity-next-generation-method-4-1-2 > li { counter-increment: expl-activity-next-generation-method-4-1-2; }
#sec-mathematical-background-for-the-next-generation-method-3 { counter-set: sec-mathematical-background-for-the-next-generation-method-3 0; }
#sec-mathematical-background-for-the-next-generation-method-3 > li::marker { content: ""counter(sec-mathematical-background-for-the-next-generation-method-3,decimal)"."; }
#sec-mathematical-background-for-the-next-generation-method-3 > li { counter-increment: sec-mathematical-background-for-the-next-generation-method-3; }
#activity-equilibrium-values-1-2 { counter-set: activity-equilibrium-values-1-2 0; }
#activity-equilibrium-values-1-2 > li::marker { content: ""counter(activity-equilibrium-values-1-2,decimal)"."; }
#activity-equilibrium-values-1-2 > li { counter-increment: activity-equilibrium-values-1-2; }
#activity-equilibrium-values-2-1 { counter-set: activity-equilibrium-values-2-1 0; }
#activity-equilibrium-values-2-1 > li::marker { content: ""counter(activity-equilibrium-values-2-1,decimal)"."; }
#activity-equilibrium-values-2-1 > li { counter-increment: activity-equilibrium-values-2-1; }
#activity-partial-derivatives-1-3 { counter-set: activity-partial-derivatives-1-3 0; }
#activity-partial-derivatives-1-3 > li::marker { content: ""counter(activity-partial-derivatives-1-3,decimal)"."; }
#activity-partial-derivatives-1-3 > li { counter-increment: activity-partial-derivatives-1-3; }
#activity-partial-derivatives-1-3-1-2 { counter-set: activity-partial-derivatives-1-3-1-2 0; }
#activity-partial-derivatives-1-3-1-2 > li::marker { content: "("counter(activity-partial-derivatives-1-3-1-2,lower-alpha)")"; }
#activity-partial-derivatives-1-3-1-2 > li { counter-increment: activity-partial-derivatives-1-3-1-2; }
#activity-partial-derivatives-1-3-2-2 { counter-set: activity-partial-derivatives-1-3-2-2 0; }
#activity-partial-derivatives-1-3-2-2 > li::marker { content: "("counter(activity-partial-derivatives-1-3-2-2,lower-alpha)")"; }
#activity-partial-derivatives-1-3-2-2 > li { counter-increment: activity-partial-derivatives-1-3-2-2; }
#activity-partial-derivatives-2-1 { counter-set: activity-partial-derivatives-2-1 0; }
#activity-partial-derivatives-2-1 > li::marker { content: ""counter(activity-partial-derivatives-2-1,decimal)"."; }
#activity-partial-derivatives-2-1 > li { counter-increment: activity-partial-derivatives-2-1; }
#activity-partial-derivatives-2-1-1-1 { counter-set: activity-partial-derivatives-2-1-1-1 0; }
#activity-partial-derivatives-2-1-1-1 > li::marker { content: "("counter(activity-partial-derivatives-2-1-1-1,lower-alpha)")"; }
#activity-partial-derivatives-2-1-1-1 > li { counter-increment: activity-partial-derivatives-2-1-1-1; }
#activity-partial-derivatives-2-1-2-1 { counter-set: activity-partial-derivatives-2-1-2-1 0; }
#activity-partial-derivatives-2-1-2-1 > li::marker { content: "("counter(activity-partial-derivatives-2-1-2-1,lower-alpha)")"; }
#activity-partial-derivatives-2-1-2-1 > li { counter-increment: activity-partial-derivatives-2-1-2-1; }
#activity-learning-next-generation-seir-1-3 { counter-set: activity-learning-next-generation-seir-1-3 0; }
#activity-learning-next-generation-seir-1-3 > li::marker { content: ""counter(activity-learning-next-generation-seir-1-3,decimal)"."; }
#activity-learning-next-generation-seir-1-3 > li { counter-increment: activity-learning-next-generation-seir-1-3; }
#activity-learning-next-generation-seir-2-1 { counter-set: activity-learning-next-generation-seir-2-1 0; }
#activity-learning-next-generation-seir-2-1 > li::marker { content: ""counter(activity-learning-next-generation-seir-2-1,decimal)"."; }
#activity-learning-next-generation-seir-2-1 > li { counter-increment: activity-learning-next-generation-seir-2-1; }
#activity-learning-next-generation-python-seir-1-4 { counter-set: activity-learning-next-generation-python-seir-1-4 0; }
#activity-learning-next-generation-python-seir-1-4 > li::marker { content: ""counter(activity-learning-next-generation-python-seir-1-4,decimal)"."; }
#activity-learning-next-generation-python-seir-1-4 > li { counter-increment: activity-learning-next-generation-python-seir-1-4; }
#activity-learning-next-generation-python-seir-2-1 { counter-set: activity-learning-next-generation-python-seir-2-1 0; }
#activity-learning-next-generation-python-seir-2-1 > li::marker { content: ""counter(activity-learning-next-generation-python-seir-2-1,decimal)"."; }
#activity-learning-next-generation-python-seir-2-1 > li { counter-increment: activity-learning-next-generation-python-seir-2-1; }
#activity-next-generation-practice-seiar-1-3 { counter-set: activity-next-generation-practice-seiar-1-3 0; }
#activity-next-generation-practice-seiar-1-3 > li::marker { content: ""counter(activity-next-generation-practice-seiar-1-3,decimal)"."; }
#activity-next-generation-practice-seiar-1-3 > li { counter-increment: activity-next-generation-practice-seiar-1-3; }
#activity-next-generation-practice-seiar-1-3-1-2 { counter-set: activity-next-generation-practice-seiar-1-3-1-2 0; }
#activity-next-generation-practice-seiar-1-3-1-2 > li::marker { content: "("counter(activity-next-generation-practice-seiar-1-3-1-2,lower-alpha)")"; }
#activity-next-generation-practice-seiar-1-3-1-2 > li { counter-increment: activity-next-generation-practice-seiar-1-3-1-2; }
#activity-next-generation-practice-seiar-2-1 { counter-set: activity-next-generation-practice-seiar-2-1 0; }
#activity-next-generation-practice-seiar-2-1 > li::marker { content: ""counter(activity-next-generation-practice-seiar-2-1,decimal)"."; }
#activity-next-generation-practice-seiar-2-1 > li { counter-increment: activity-next-generation-practice-seiar-2-1; }
#activity-next-generation-practice-seiar-2-1-1-1 { counter-set: activity-next-generation-practice-seiar-2-1-1-1 0; }
#activity-next-generation-practice-seiar-2-1-1-1 > li::marker { content: "("counter(activity-next-generation-practice-seiar-2-1-1-1,lower-alpha)")"; }
#activity-next-generation-practice-seiar-2-1-1-1 > li { counter-increment: activity-next-generation-practice-seiar-2-1-1-1; }
#exercises-ch-next-generation-method-2-2 { counter-set: exercises-ch-next-generation-method-2-2 0; }
#exercises-ch-next-generation-method-2-2 > li::marker { content: "("counter(exercises-ch-next-generation-method-2-2,lower-alpha)")"; }
#exercises-ch-next-generation-method-2-2 > li { counter-increment: exercises-ch-next-generation-method-2-2; }
</style>
</head>
<body class="pretext book ignore-math">
<a class="assistive" href="#ptx-content">Skip to main content</a><header id="ptx-masthead" class="ptx-masthead"><div class="ptx-banner">
<a id="logo-link" class="logo-link" target="_blank" href=""></a><div class="title-container">
<h1 class="heading"><a href="mathematical-epidemiology.html"><span class="title">Mathematical Epidemiology and More:</span> <span class="subtitle">A Course on Compartmental Models</span></a></h1>
<p class="byline">Meredith L. Greer</p>
</div>
</div></header><nav id="ptx-navbar" class="ptx-navbar navbar"><button class="toc-toggle button" title="Contents"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5d2;</span><span class="name">Contents</span></button><div class="searchbox">
<div class="searchwidget"><button id="searchbutton" class="searchbutton button" type="button" title="Search book"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe8b6;</span><span class="name">Search Book</span></button></div>
<div id="searchresultsplaceholder" class="searchresultsplaceholder" style="display: none">
<div class="search-results-controls">
<input aria-label="Search term" id="ptxsearch" class="ptxsearch" type="text" name="terms" placeholder="Search term"><button title="Close search" id="closesearchresults" class="closesearchresults"><span class="material-symbols-outlined">close</span></button>
</div>
<h2 class="search-results-heading">Search Results: </h2>
<div id="searchempty" class="searchempty"><span>No results.</span></div>
<ol id="searchresults" class="searchresults"></ol>
</div>
</div>
<span class="nav-other-controls"></span><span class="treebuttons"><a class="previous-button button" href="ch-preparing-influenza-data-to-compare-with-a-model.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="up-button button" href="part-core-modeling-concepts.html" title="Up"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Up</span></a><a class="next-button button" href="ch-akaike-information-criterion-comparing-different-models.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a></span></nav><div id="latex-macros" class="hidden-content process-math" style="display:none"><span class="process-math">\(\newcommand{\R}{\mathbb R}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\definecolor{fillinmathshade}{gray}{0.9}
\newcommand{\fillinmath}[1]{\mathchoice{\colorbox{fillinmathshade}{$\displaystyle     \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\textstyle        \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptstyle      \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptscriptstyle\phantom{\,#1\,}$}}}
\)</span></div>
<div class="ptx-page">
<div id="ptx-sidebar" class="ptx-sidebar"><nav id="ptx-toc" class="ptx-toc depth2 parts"><ul class="structural contains-active toc-item-list">
<li class="toc-item toc-frontmatter">
<div class="toc-title-box"><a href="frontmatter.html" class="internal"><span class="title">Front Matter</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-colophon"><div class="toc-title-box"><a href="frontmatter-2.html" class="internal"><span class="title">Colophon</span></a></div></li>
<li class="toc-item toc-acknowledgement"><div class="toc-title-box"><a href="frontmatter-3.html" class="internal"><span class="title">Acknowledgements</span></a></div></li>
<li class="toc-item toc-preface"><div class="toc-title-box"><a href="preface-overall.html" class="internal"><span class="title">Preface</span></a></div></li>
<li class="toc-item toc-preface"><div class="toc-title-box"><a href="preface-students.html" class="internal"><span class="title">To Students: How to Get the Most from This Text</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-part contains-active">
<div class="toc-title-box"><a href="part-core-modeling-concepts.html" class="internal"><span class="codenumber">I</span> <span class="title">Core Modeling Concepts</span></a></div>
<ul class="structural toc-item-list contains-active">
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-prelude-diseases-in-popular-news.html" class="internal"><span class="codenumber">1</span> <span class="title">Prelude: Diseases in Popular News</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-prelude-diseases-in-popular-news.html#sec-Possible-Discussion-Themes" class="internal"><span class="codenumber">1.1</span> <span class="title">Possible Discussion Themes</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-prelude-diseases-in-popular-news.html#sec-Follow-Up-By-Seeking-More-Precise-Data" class="internal"><span class="codenumber">1.2</span> <span class="title">Follow Up By Seeking More Precise Data</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="ch-prelude-diseases-in-popular-news.html#exercises-prelude-diseases-in-popular-news" class="internal"><span class="codenumber">1.3</span> <span class="title">For Further Thought</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-zombies-can-math-help.html" class="internal"><span class="codenumber">2</span> <span class="title">Zombies: Can Math Help?</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-zombies-can-math-help.html#sec-we-now-have-data-qualitative-musings" class="internal"><span class="codenumber">2.1</span> <span class="title">We Now Have Data: Qualitative Musings</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-zombies-can-math-help.html#sec-a-first-model" class="internal"><span class="codenumber">2.2</span> <span class="title">A First Model</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="ch-zombies-can-math-help.html#exercises-ch-zombies-can-math-help" class="internal"><span class="codenumber">2.3</span> <span class="title">For Further Thought</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-visualization-graphing-model-results-and-data.html" class="internal"><span class="codenumber">3</span> <span class="title">Visualization: Graphing Model Results and Data</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-visualization-graphing-model-results-and-data.html#sec-solving-differential-equations-using-graphs" class="internal"><span class="codenumber">3.1</span> <span class="title">“Solving” Differential Equations Using Graphs</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-visualization-graphing-model-results-and-data.html#sec-estimating-beta-and-building-visualization-skills" class="internal"><span class="codenumber">3.2</span> <span class="title">Estimating <span class="process-math">\(\beta\)</span> and Building Visualization Skills</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="ch-visualization-graphing-model-results-and-data.html#exercises-visualization-graphing-model-results-and-data" class="internal"><span class="codenumber">3.3</span> <span class="title">For Further Thought</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-compartmental-diagrams.html" class="internal"><span class="codenumber">4</span> <span class="title">Compartmental Diagrams</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-compartmental-diagrams.html#sec-compartmental-diagrams-vocabulary-and-comments" class="internal"><span class="codenumber">4.1</span> <span class="title">Compartmental Diagrams: Vocabulary and Comments</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-compartmental-diagrams.html#sec-from-zombie-game-variation-to-compartmental-diagram" class="internal"><span class="codenumber">4.2</span> <span class="title">From Zombie Game Variation to Compartmental Diagram</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-compartmental-diagrams.html#sec-estimating-gamma-and-other-rates" class="internal"><span class="codenumber">4.3</span> <span class="title">Estimating Gamma and Other Rates</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="ch-compartmental-diagrams.html#exercises-ch-compartmental-diagrams" class="internal"><span class="codenumber">4.4</span> <span class="title">For Further Thought</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-model-analysis-and-the-basic-reproduction-number-R0.html" class="internal"><span class="codenumber">5</span> <span class="title">Model Analysis and the Basic Reproduction Number <span class="process-math">\(\mathcal{R}_0\)</span></span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-model-analysis-and-the-basic-reproduction-number-R0.html#sec-using-calculus-to-analyze-models" class="internal"><span class="codenumber">5.1</span> <span class="title">Using Calculus to Analyze Models</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-model-analysis-and-the-basic-reproduction-number-R0.html#sec-the-basic-reproduction-number-R0" class="internal"><span class="codenumber">5.2</span> <span class="title">The Basic Reproduction Number <span class="process-math">\(\mathcal{R}_0\)</span></span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="ch-model-analysis-and-the-basic-reproduction-number-R0.html#exercises-ch-populations-and-R0" class="internal"><span class="codenumber">5.3</span> <span class="title">For Further Thought</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-vaccines.html" class="internal"><span class="codenumber">6</span> <span class="title">Vaccines</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-vaccines.html#sec-determining-a-threshold-vaccine-level" class="internal"><span class="codenumber">6.1</span> <span class="title">Determining a Threshold Vaccine Level</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-vaccines.html#sec-how-vaccination-level-affects-long-term-outcomes" class="internal"><span class="codenumber">6.2</span> <span class="title">How Vaccination Level Affects Long Term Outcomes</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-vaccines.html#sec-vaccine-efficacy-and-effectiveness" class="internal"><span class="codenumber">6.3</span> <span class="title">Vaccine Efficacy and Effectiveness</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="ch-vaccines.html#exercises-ch-vaccines" class="internal"><span class="codenumber">6.4</span> <span class="title">For Further Thought</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-incubation-periods.html" class="internal"><span class="codenumber">7</span> <span class="title">Incubation Periods</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-incubation-periods.html#sec-including-an-incubation-period-the-seir-model" class="internal"><span class="codenumber">7.1</span> <span class="title">Including an Incubation Period: The SEIR Model</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-incubation-periods.html#sec-practice-with-an-incubation-model" class="internal"><span class="codenumber">7.2</span> <span class="title">Practice with an Incubation Model</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="ch-incubation-periods.html#exercises-ch-incubation-period" class="internal"><span class="codenumber">7.3</span> <span class="title">For Further Thought</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-isolation.html" class="internal"><span class="codenumber">8</span> <span class="title">Isolation</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-isolation.html#sec-complete-isolation-models-and-parameter-estimation" class="internal"><span class="codenumber">8.1</span> <span class="title">Complete Isolation: Models and Parameter Estimation</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-isolation.html#sec-incomplete-isolation-and-quarantine-vs-isolation" class="internal"><span class="codenumber">8.2</span> <span class="title">Incomplete Isolation, and Quarantine vs. Isolation</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-isolation.html#sec-practice-with-an-isolation-model" class="internal"><span class="codenumber">8.3</span> <span class="title">Practice with an Isolation Model</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="ch-isolation.html#exercises-ch-isolation" class="internal"><span class="codenumber">8.4</span> <span class="title">For Further Thought</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-preparing-influenza-data-to-compare-with-a-model.html" class="internal"><span class="codenumber">9</span> <span class="title">Preparing Influenza Data to Compare With a Model</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-preparing-influenza-data-to-compare-with-a-model.html#sec-incidence-and-prevalence" class="internal"><span class="codenumber">9.1</span> <span class="title">Incidence and Prevalence</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-preparing-influenza-data-to-compare-with-a-model.html#sec-translating-a-typical-data-set-into-numbers-we-can-compare-with-a-model" class="internal"><span class="codenumber">9.2</span> <span class="title">Translating a Typical Data Set Into Numbers We Can Compare With a Model</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="ch-preparing-influenza-data-to-compare-with-a-model.html#exercises-ch-influenza-data" class="internal"><span class="codenumber">9.3</span> <span class="title">For Further Thought</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter active">
<div class="toc-title-box"><a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html" class="internal"><span class="codenumber">10</span> <span class="title">* Residual Sum of Squares: Improving a Model’s Fit to Data</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#sec-residual-sum-of-squares-introductory-example" class="internal"><span class="codenumber">10.1</span> <span class="title">Residual Sum of Squares: An Introductory Example</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#sec-underlying-math-rss" class="internal"><span class="codenumber">10.2</span> <span class="title">The Underlying Math of RSS</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#sec-residual-sum-of-squares-quickly-comparing-multiple-parameter-values" class="internal"><span class="codenumber">10.3</span> <span class="title">Residual Sum of Squares: Quickly Comparing Multiple Parameter Values</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#sec-influenza-data-and-rss" class="internal"><span class="codenumber">10.4</span> <span class="title">Influenza Data and RSS</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#exercises-ch-rss" class="internal"><span class="codenumber">10.5</span> <span class="title">For Further Thought</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-akaike-information-criterion-comparing-different-models.html" class="internal"><span class="codenumber">11</span> <span class="title">* Akaike Information Criterion: Comparing Different Models</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-akaike-information-criterion-comparing-different-models.html#sec-ma" class="internal"><span class="codenumber">11.1</span> <span class="title"></span></a></div></li></ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-epidemic-vs-endemic-models.html" class="internal"><span class="codenumber">12</span> <span class="title">* Epidemic vs. Endemic Models</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-epidemic-vs-endemic-models.html#sec-ee" class="internal"><span class="codenumber">12.1</span> <span class="title"></span></a></div></li></ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-modeling-the-spread-of-an-idea.html" class="internal"><span class="codenumber">13</span> <span class="title">* Modeling the Spread of an Idea</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-modeling-the-spread-of-an-idea.html#sec-7" class="internal"><span class="codenumber">13.1</span> <span class="title"></span></a></div></li></ul>
</li>
</ul>
</li>
<li class="toc-item toc-part">
<div class="toc-title-box"><a href="part-digging-deeper-mathematically.html" class="internal"><span class="codenumber">II</span> <span class="title">Digging Deeper Mathematically</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-the-next-generation-method.html" class="internal"><span class="codenumber">14</span> <span class="title">The Next Generation Method</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-the-next-generation-method.html#sec-mathematical-background-for-the-next-generation-method" class="internal"><span class="codenumber">14.1</span> <span class="title">Mathematical Background for the Next Generation Method</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-the-next-generation-method.html#sec-the-next-generation-method-steps-to-follow" class="internal"><span class="codenumber">14.2</span> <span class="title">The Next Generation Method: Steps to Follow</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-the-next-generation-method.html#sec-python-code-for-the-next-generation-method" class="internal"><span class="codenumber">14.3</span> <span class="title">Python Code for the Next Generation Method</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="ch-the-next-generation-method.html#exercises-ch-next-generation-method" class="internal"><span class="codenumber">14.4</span> <span class="title">For Further Thought</span></a></div></li>
</ul>
</li></ul>
</li>
<li class="toc-item toc-part">
<div class="toc-title-box"><a href="part-additional-modeling-examples.html" class="internal"><span class="codenumber">III</span> <span class="title">Additional Modeling Examples</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-case-studies-vaccination-and-isolation.html" class="internal"><span class="codenumber">15</span> <span class="title">* Case Studies: Vaccination and Isolation</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-case-studies-vaccination-and-isolation.html#ch-case-studies-vaccination-and-isolation-3" class="internal"><span class="codenumber">15.1</span> <span class="title">A Varicella Example with Vaccination</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-case-studies-vaccination-and-isolation.html#ch-case-studies-vaccination-and-isolation-4" class="internal"><span class="codenumber">15.2</span> <span class="title"></span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-case-studies-vaccination-and-isolation.html#ch-case-studies-vaccination-and-isolation-5" class="internal"><span class="codenumber">15.3</span> <span class="title"></span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-more-advanced-vaccine-models.html" class="internal"><span class="codenumber">16</span> <span class="title">* More Advanced Vaccine Models</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-more-advanced-vaccine-models.html#sec-hmm" class="internal"><span class="codenumber">16.1</span> <span class="title"></span></a></div></li></ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-introducing-an-incubation-period-in-the-zombie-app.html" class="internal"><span class="codenumber">17</span> <span class="title">Introducing an Incubation Period in the Zombie App</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-introducing-an-incubation-period-in-the-zombie-app.html#sec-activity-introduce-an-incubation-period" class="internal"><span class="codenumber">17.1</span> <span class="title">Activity: Introduce an Incubation Period</span></a></div></li></ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-articles-showing-further-examples.html" class="internal"><span class="codenumber">18</span> <span class="title">* Articles Showing Further Examples</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="ch-articles-showing-further-examples.html#ch-articles-showing-further-examples-3" class="internal"><span class="codenumber">18.1</span> <span class="title">Compartmental Models for Diseases</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-subsection"><div class="toc-title-box"><a href="ch-articles-showing-further-examples.html#ch-articles-showing-further-examples-3-2" class="internal"><span class="codenumber">18.1.1</span> <span class="title">Legionnaires’ Disease</span></a></div></li></ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="ch-articles-showing-further-examples.html#ch-articles-showing-further-examples-4" class="internal"><span class="codenumber">18.2</span> <span class="title">Compartmental Models for Applications Other Than Diseases</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="ch-articles-showing-further-examples.html#ch-articles-showing-further-examples-4-2" class="internal"><span class="codenumber">18.2.1</span> <span class="title">Elections</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="ch-articles-showing-further-examples.html#ch-articles-showing-further-examples-4-3" class="internal"><span class="codenumber">18.2.2</span> <span class="title">Bumblebees and Pollination</span></a></div></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-part">
<div class="toc-title-box"><a href="part-supplemental-materials.html" class="internal"><span class="codenumber">IV</span> <span class="title">Supplemental Materials</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-tips-on-reading-a-scientific-paper.html" class="internal"><span class="codenumber">19</span> <span class="title">* Tips on Reading a Scientific Paper</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-tips-on-reading-a-scientific-paper.html#sec-what-are-scientific-papers-and-why-read-them" class="internal"><span class="codenumber">19.1</span> <span class="title">What are Scientific Papers, and Why Read Them?</span></a></div></li></ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-greek-letters.html" class="internal"><span class="codenumber">20</span> <span class="title">Greek Letters</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-section"><div class="toc-title-box"><a href="ch-greek-letters.html#sec-greek-letters" class="internal"><span class="codenumber">20.1</span> <span class="title"></span></a></div></li></ul>
</li>
</ul>
</li>
<li class="toc-item toc-backmatter">
<div class="toc-title-box"><a href="backmatter.html" class="internal"><span class="title">Backmatter</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-glossary"><div class="toc-title-box"><a href="glossary-of-terms.html" class="internal"><span class="title">Glossary of Mathematical Epidemiology Terms</span></a></div></li></ul>
</li>
</ul></nav></div>
<main class="ptx-main"><div id="ptx-content" class="ptx-content"><section class="chapter" id="ch-residual-sum-of-squares-improving-a-models-fit-to-data"><h2 class="heading">
<span class="type">Chapter</span><span class="space"> </span><span class="codenumber">10</span><span class="space"> </span><span class="title">* Residual Sum of Squares: Improving a Model’s Fit to Data</span>
</h2>
<div class="para" id="ch-residual-sum-of-squares-improving-a-models-fit-to-data-2"><dfn class="terminology">***This chapter is under construction.***</dfn></div>
<section class="introduction" id="intro-RSS"><article class="objectives goal-like" id="intro-RSS-1"><h3 class="heading"><span class="type">Goals</span></h3>
<ul class="disc" id="intro-RSS-1-1">
<li id="intro-RSS-1-1-1"><div class="para" id="intro-RSS-1-1-1-1">Use data from case reports to implement a method for estimating the value of the transmission parameter <span class="process-math">\(\beta\)</span>
</div></li>
<li id="intro-RSS-1-1-2"><div class="para" id="intro-RSS-1-1-2-1">Understand how a “for” loop in Python helps us test many possible values of <span class="process-math">\(\beta\)</span> with one click of the <code class="code-inline tex2jax_ignore">Evaluate</code> button</div></li>
<li id="intro-RSS-1-1-3"><div class="para" id="intro-RSS-1-1-3-1">Ensure that the results from our math-and-coding-based approach to estimating <span class="process-math">\(\beta\)</span> make biological sense</div></li>
</ul></article> <div class="para" id="intro-RSS-2">So far, we have estimated <span class="process-math">\(\beta\)</span> in two ways: (1) visually, making adjustments so that data and graphs are closer together, starting in <a href="ch-visualization-graphing-model-results-and-data.html" class="internal" title="Chapter 3: Visualization: Graphing Model Results and Data">Chapter 3</a>, and (2) using a formula involving <span class="process-math">\(\mathcal{R}_0\)</span> and parameters from our model, such as in <a href="ch-model-analysis-and-the-basic-reproduction-number-R0.html#sec-the-basic-reproduction-number-R0-13" class="xref" data-knowl="./knowl/xref/eq-R0-sir.html" data-reveal-label="Reveal" data-close-label="Close" title="Equation 5.1">(5.1)</a> and <a href="ch-incubation-periods.html#sec-including-an-incubation-period-the-seir-model-14" class="xref" data-knowl="./knowl/xref/eq-R0-seir.html" data-reveal-label="Reveal" data-close-label="Close" title="Equation 7.3">(7.3)</a>, to substitute in values we could find from epidemiological information and solve for <span class="process-math">\(\beta\text{,}\)</span> which is typically the only unknown value in the formula. In this chapter, we learn a new approach.</div> <div class="para" id="intro-RSS-3">Begin in <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#expl-RSS" class="xref" data-knowl="./knowl/xref/expl-RSS.html" data-reveal-label="Reveal" data-close-label="Close" title="Exploration 10.1: Visually Demonstrating Differences Between a Model and Data">Exploration 10.1</a> by examining data points as well as values determined by an SI model. In this exploration, think about mathematical approaches to improve the model’s fit to data.</div> <article class="exploration project-like" id="expl-RSS"><h3 class="heading">
<span class="type">Exploration</span><span class="space"> </span><span class="codenumber">10.1</span><span class="period">.</span><span class="space"> </span><span class="title">Visually Demonstrating Differences Between a Model and Data.</span>
</h3>
<div class="introduction" id="expl-RSS-2">
<div class="para" id="expl-RSS-2-1">This example focuses on an SI model, similar to what we worked with in <a href="ch-zombies-can-math-help.html" class="internal" title="Chapter 2: Zombies: Can Math Help?">Chapter 2</a> and <a href="ch-visualization-graphing-model-results-and-data.html" class="internal" title="Chapter 3: Visualization: Graphing Model Results and Data">Chapter 3</a>. Use the code shown, and its output, to answer the questions below.</div> <pre id="expl-RSS-2-2" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">#Import packages
import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import odeint

#Include data from Zombie Game App
t_steps = [0, 1, 2, 3, 4, 5, 6]
I_data = [1, 2, 4, 10, 22, 40, 50]

#Define the system of differential equations, and call it "hz"
def hz(y, t):
  s, i = y #Define y as consisting of s and i, in that order
  dydt = [-beta * s * i, beta * s * i] #These formulas are the right-hand sides of the SI model
  return dydt

beta = 0.03 #Give a value to beta
y0 = [49, 1] #Set initial conditions for Susceptibles and Infectious, in that order
t_range = np.arange(0.0, 7.0, 0.1) #Set the time range, then set the size of the time steps to use when "stepping through" to numerically solve

sol = odeint(hz, y0, t_range) #Give the name "sol" to the lists of numerical values in the solution, and give "odeint" the information needed to solve

print("I(0) = ", sol[0, 1])
print("I(1) = ", sol[10, 1])
print("I(2) = ", sol[20, 1])
print("I(3) = ", sol[30, 1])
print("I(4) = ", sol[40, 1])
print("I(5) = ", sol[50, 1])
print("I(6) = ", sol[60, 1])

# Plotting commands are below
plt.cla() #Clear (delete) any past plots
plt.plot(t_steps, I_data,'o', markersize=4, color='orange', label='I(t) data')
plt.plot(t_range, sol[:, 1], color='orange', linewidth=2, label='Modeled I(t)')
plt.legend()
plt.xlabel('Time')
plt.ylabel('Infectious Population')
plt.show()
</script></pre>
</div>
<article class="task exercise-like" id="expl-RSS-3"><h4 class="heading"><span class="codenumber">(a)</span></h4>
<div class="para" id="expl-RSS-3-1-1">Copy the graph from the Python output: draw it by hand or print it out if you prefer a paper copy, or create a digital version you can edit, such as a screenshot.</div> <ol class="decimal" id="expl-RSS-3-1-2">
<li id="expl-RSS-3-1-2-1"><div class="para" id="expl-RSS-3-1-2-1-1">For the values <span class="process-math">\(I(0)\text{,}\)</span> <span class="process-math">\(I(1)\text{,}\)</span> <span class="process-math">\(I(2)\text{,}\)</span> <span class="process-math">\(I(3)\text{,}\)</span> <span class="process-math">\(I(4)\text{,}\)</span> <span class="process-math">\(I(5)\text{,}\)</span> and <span class="process-math">\(I(6)\)</span> that are printed out in the Python output above the graph, label on your copy of the graph where each value is shown.</div></li>
<li id="expl-RSS-3-1-2-2"><div class="para" id="expl-RSS-3-1-2-2-1">Then write out in words what the values <span class="process-math">\(I(0)\text{,}\)</span> <span class="process-math">\(I(1)\text{,}\)</span> <span class="process-math">\(I(2)\text{,}\)</span> <span class="process-math">\(I(3)\text{,}\)</span> <span class="process-math">\(I(4)\text{,}\)</span> <span class="process-math">\(I(5)\text{,}\)</span> and <span class="process-math">\(I(6)\)</span> represent: are these data points, or values generated by a mathematical model?</div></li>
</ol></article><article class="task exercise-like" id="expl-RSS-4"><h4 class="heading"><span class="codenumber">(b)</span></h4>
<div class="para" id="expl-RSS-4-1-1">Next, read lines 7 and 8 in the Python code.</div> <ol class="decimal" id="expl-RSS-4-1-2">
<li id="expl-RSS-4-1-2-1"><div class="para" id="expl-RSS-4-1-2-1-1">These values combine to form several points on the output graph. On your copy of the graph, label the points determined by lines 7 and 8.</div></li>
<li id="expl-RSS-4-1-2-2"><div class="para" id="expl-RSS-4-1-2-2-1">Then write out in words what the values from lines 7 and 8 represent: are these data points, or values generated by a mathematical model?</div></li>
</ol></article><article class="task exercise-like" id="expl-RSS-5"><h4 class="heading"><span class="codenumber">(c)</span></h4>
<div class="para" id="expl-RSS-5-1-1">We now put parts (a) and (b) together.</div> <ol class="decimal" id="expl-RSS-5-1-2">
<li id="expl-RSS-5-1-2-1"><div class="para" id="expl-RSS-5-1-2-1-1">Use your labeled graph to compare the values in part (a) with the values in part (b). Can you draw a visual way of comparing these values at each of the times <span class="process-math">\(t=0\text{,}\)</span> <span class="process-math">\(t=1\text{,}\)</span> <span class="process-math">\(t=2\text{,}\)</span> <span class="process-math">\(t=3\text{,}\)</span> <span class="process-math">\(t=4\text{,}\)</span> <span class="process-math">\(t=5\text{,}\)</span> and <span class="process-math">\(t=6\text{?}\)</span>
</div></li>
<li id="expl-RSS-5-1-2-2"><div class="para" id="expl-RSS-5-1-2-2-1">Starting with the visual comparison you just described: What would change visually if the values from the model, and the values at each data point, were closer together?</div></li>
<li id="expl-RSS-5-1-2-3"><div class="para" id="expl-RSS-5-1-2-3-1">Turn your visual comparison ideas into some mathematical suggestions for identifying when the model and the data are closer together.</div></li>
</ol></article></article></section><section class="section" id="sec-residual-sum-of-squares-introductory-example"><h3 class="heading hide-type">
<span class="type">Section</span><span class="space"> </span><span class="codenumber">10.1</span><span class="space"> </span><span class="title">Residual Sum of Squares: An Introductory Example</span>
</h3>
<div class="para" id="sec-residual-sum-of-squares-introductory-example-2">One way to compare data with the output of a model is by computing the Residual Sum of Squares, often abbreviated as RSS. When we work with a single model to try to improve the fit of the model to a data set, RSS is a commonly used option. <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#activity-rss-intro" class="xref" data-knowl="./knowl/xref/activity-rss-intro.html" data-reveal-label="Reveal" data-close-label="Close" title="Activity 10.2">Activity 10.2</a> shows the steps for computing RSS for a model with one choice for a value of <span class="process-math">\(\beta\text{.}\)</span> Then, <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#sec-underlying-math-rss" class="internal" title="Section 10.2: The Underlying Math of RSS">Section 10.2</a> provides more mathematical context for how RSS works. After that, <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#sec-residual-sum-of-squares-quickly-comparing-multiple-parameter-values" class="internal" title="Section 10.3: Residual Sum of Squares: Quickly Comparing Multiple Parameter Values">Section 10.3</a> shows how to compare RSS for different values of <span class="process-math">\(\beta\)</span> used in the same model. Last, <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#sec-influenza-data-and-rss" class="internal" title="Section 10.4: Influenza Data and RSS">Section 10.4</a> demonstrates the use of RSS with a real-world data set, where we need to take extra care to ensure that our work is not just correct mathematically, but also makes sense biologically.</div>
<article class="activity project-like" id="activity-rss-intro"><h4 class="heading">
<span class="type">Activity</span><span class="space"> </span><span class="codenumber">10.2</span><span class="period">.</span>
</h4>
<div class="para" id="activity-rss-intro-1-1">In <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#expl-RSS" class="xref" data-knowl="./knowl/xref/expl-RSS.html" data-reveal-label="Reveal" data-close-label="Close" title="Exploration 10.1: Visually Demonstrating Differences Between a Model and Data">Exploration 10.1</a> we worked with both a data set, and model output, for the Infectious population <span class="process-math">\(I(t)\)</span> at times <span class="process-math">\(t=0, 1, 2, 3, 4, 5, 6\text{.}\)</span> The data values and model output appear in <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#table-si-model-data-values-and-model-output" class="xref" data-knowl="./knowl/xref/table-si-model-data-values-and-model-output.html" data-reveal-label="Reveal" data-close-label="Close" title="Table 10.1: SI Model: Data Values and Model Output for I(t)">Table 10.1</a>, with model output rounded to two decimal places.</div> <figure class="table table-like" id="table-si-model-data-values-and-model-output"><figcaption><span class="type">Table</span><span class="space"> </span><span class="codenumber">10.1<span class="period">.</span></span><span class="space"> </span>SI Model: Data Values and Model Output for <span class="process-math">\(I(t)\)</span></figcaption><div class="tabular-box natural-width"><table class="tabular">
<tr class="header-horizontal">
<th scope="col" class="c m b0 r0 l0 t0 lines">Time</th>
<th scope="col" class="c m b0 r0 l0 t0 lines">Data Value</th>
<th scope="col" class="c m b0 r0 l0 t0 lines">Model Output</th>
</tr>
<tr>
<td class="c m b0 r0 l0 t0 lines">0</td>
<td class="c m b0 r0 l0 t0 lines">1</td>
<td class="c m b0 r0 l0 t0 lines">1.0</td>
</tr>
<tr>
<td class="c m b0 r0 l0 t0 lines">1</td>
<td class="c m b0 r0 l0 t0 lines">2</td>
<td class="c m b0 r0 l0 t0 lines">4.19</td>
</tr>
<tr>
<td class="c m b0 r0 l0 t0 lines">2</td>
<td class="c m b0 r0 l0 t0 lines">4</td>
<td class="c m b0 r0 l0 t0 lines">14.54</td>
</tr>
<tr>
<td class="c m b0 r0 l0 t0 lines">3</td>
<td class="c m b0 r0 l0 t0 lines">10</td>
<td class="c m b0 r0 l0 t0 lines">32.38</td>
</tr>
<tr>
<td class="c m b0 r0 l0 t0 lines">4</td>
<td class="c m b0 r0 l0 t0 lines">22</td>
<td class="c m b0 r0 l0 t0 lines">44.58</td>
</tr>
<tr>
<td class="c m b0 r0 l0 t0 lines">5</td>
<td class="c m b0 r0 l0 t0 lines">40</td>
<td class="c m b0 r0 l0 t0 lines">48.68</td>
</tr>
<tr>
<td class="c m b0 r0 l0 t0 lines">6</td>
<td class="c m b0 r0 l0 t0 lines">50</td>
<td class="c m b0 r0 l0 t0 lines">49.70</td>
</tr>
</table></div></figure> <div class="para" id="activity-rss-intro-1-3">RSS compares each Data Value from <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#table-si-model-data-values-and-model-output" class="xref" data-knowl="./knowl/xref/table-si-model-data-values-and-model-output.html" data-reveal-label="Reveal" data-close-label="Close" title="Table 10.1: SI Model: Data Values and Model Output for I(t)">Table 10.1</a> with the Model Output from the same time by subtracting one from the other and squaring the result.</div> <ol class="decimal" id="activity-rss-intro-1-4">
<li id="activity-rss-intro-1-4-1"><div class="para" id="activity-rss-intro-1-4-1-1">Try at least two of these comparisons on your own: for times <span class="process-math">\(t=1\)</span> and <span class="process-math">\(t=2\text{,}\)</span> subtract the Model Output in <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#table-si-model-data-values-and-model-output" class="xref" data-knowl="./knowl/xref/table-si-model-data-values-and-model-output.html" data-reveal-label="Reveal" data-close-label="Close" title="Table 10.1: SI Model: Data Values and Model Output for I(t)">Table 10.1</a> from the corresponding Data Value and square the result. Later in this activity, we will compare these hand-computed values with the corresponding values computed via Python.</div></li>
<li id="activity-rss-intro-1-4-2">
<div class="para" id="activity-rss-intro-1-4-2-1">Read the code block below to identify where in the code, and how, we do each of the following. You may find it helpful to look up some of the Python commands online to better understand the details of how they work. Printing output is another way to build understanding: you can include commands such as <code class="code-inline tex2jax_ignore">print(sol)</code> or <code class="code-inline tex2jax_ignore">print(t_range)</code> near the bottom of the Python code block to be sure you understand the structures of <code class="code-inline tex2jax_ignore">sol</code>, <code class="code-inline tex2jax_ignore">t_range</code>, or other quantities.</div>
<ol class="lower-alpha" id="activity-rss-intro-1-4-2-2">
<li id="activity-rss-intro-1-4-2-2-1"><div class="para" id="activity-rss-intro-1-4-2-2-1-1">The default code computes the numbers of Susceptibles and the numbers of Infectious at times 0, 0.1, 0.2, 0.3, and so on, until time 6.9. Where and how does the code say to do this?</div></li>
<li id="activity-rss-intro-1-4-2-2-2"><div class="para" id="activity-rss-intro-1-4-2-2-2-1">When we say to complete a command for <code class="code-inline tex2jax_ignore">x in range(0,7)</code>, which values of <span class="process-math">\(x\)</span> are we specifying?</div></li>
<li id="activity-rss-intro-1-4-2-2-3"><div class="para" id="activity-rss-intro-1-4-2-2-3-1">Line 24 begins with <code class="code-inline tex2jax_ignore">for</code> and then, in lines 25, 26, and 27, gives three commands. The word <code class="code-inline tex2jax_ignore">for</code> means to complete these commands repeatedly, as many times as specified in the <code class="code-inline tex2jax_ignore">x in range(0,7)</code> command you focused on in part (b) above. What happens in each of the three commands following <code class="code-inline tex2jax_ignore">for</code>? For line 27, connect your answer back to the command <code class="code-inline tex2jax_ignore">RSS = 0</code> in line 22.</div></li>
<li id="activity-rss-intro-1-4-2-2-4"><div class="para" id="activity-rss-intro-1-4-2-2-4-1">Within line 25, how do we specify that we seek Model Output at times 0, 1, 2, and so on, but not the Model Output at non-integer times such as 0.3? Why do we need to specify that we seek Model Output only at integer-valued times?</div></li>
</ol>
<pre id="activity-rss-intro-1-4-2-3" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">#Import packages
import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import odeint

#Include data from the Zombie Game App
t_steps = [0, 1, 2, 3, 4, 5, 6]
I_data = [1, 2, 4, 10, 22, 40, 50]

#Define the system of differential equations, and call it "hz"
def hz(y, t):
  s, i = y #Define y as consisting of s and i, in that order
  dydt = [-beta * s * i, beta * s * i] # These are the right-hand sides of the SI model
  return dydt

beta = 0.03 #Give beta a value
y0 = [49, 1] #Set initial values for Susceptibles and Infectious, in that order
t_range = np.arange(0.0, 7.0, 0.1) #Set the time range, the set the size of the time steps to use when "stepping through" to numerically solve the system of differential equations

sol = odeint(hz, y0, t_range) #Give the name "sol" to the lists of numerical values in the solution, and give "odeint" the information needed to solve

RSS = 0 #Initialize the value of RSS to be 0

for x in range(0,7):
  new_square = (I_data[x] - sol[10*x, 1])**2
  print("Squared distance at time", x, "=", new_square)
  RSS = RSS + new_square

print("RSS = ", RSS)
</script></pre>
</li>
<li id="activity-rss-intro-1-4-3">
<div class="para" id="activity-rss-intro-1-4-3-1">Run the code block. Compare its results with your results for <span class="process-math">\(t=1\)</span> and <span class="process-math">\(t=2\)</span> in part (1) of this Activity. Describe how the results are similar and how they are different, and provide an explanation for why they are not identical.</div>
<div class="para" id="activity-rss-intro-1-4-3-2">Then examine all the results from the code, including the total value for RSS for this model with this data set. State at least two of your observations.</div>
</li>
<li id="activity-rss-intro-1-4-4">
<div class="para" id="activity-rss-intro-1-4-4-1">Once you understand how the code works, experiment with different values of <span class="process-math">\(\beta\text{.}\)</span> Your goal is to improve the fit between the model and the data set. While adjusting <span class="process-math">\(\beta\text{,}\)</span> consider including a plot of the graph showing both the solution curve of the model and the data points. You can do this by copying plotting commands from the Python block in this chapter’s Exploration (lines 30 through 37) and pasting them into the bottom of the Python block in this activity.</div>
<div class="para" id="activity-rss-intro-1-4-4-2">Write about your experiments and their results. State how you improved the fit of the model to data by adjusting <span class="process-math">\(\beta\text{,}\)</span> and include an explanation of how you know the fit is improved.</div>
</li>
</ol>
<div class="solutions"><details id="activity-rss-intro-2" class="answer solution-like born-hidden-knowl"><summary class="knowl__link"><span class="type">Answer</span><span class="period">.</span></summary><div class="answer solution-like knowl__content"><ol class="decimal" id="activity-rss-intro-2-1">
<li id="activity-rss-intro-2-1-1"><div class="para" id="activity-rss-intro-2-1-1-1">At time <span class="process-math">\(t=1\text{,}\)</span> compute <span class="process-math">\((4.19-2)^2\)</span> to get the value <span class="process-math">\(4.7961\text{.}\)</span> At time <span class="process-math">\(t=2\text{,}\)</span> compute <span class="process-math">\((14.54-4)^2\)</span> to get the value <span class="process-math">\(111.0916\text{.}\)</span>
</div></li>
<li id="activity-rss-intro-2-1-2"><div class="para" id="p-derived-activity-rss-intro-2-1-2"><ol class="lower-alpha" id="activity-rss-intro-2-1-2-1">
<li id="activity-rss-intro-2-1-2-1-1"><div class="para" id="activity-rss-intro-2-1-2-1-1-1">Line 20 tells Python to compute <code class="code-inline tex2jax_ignore">sol</code>, which is the array of values of Susceptibles and Infectious at all times in <code class="code-inline tex2jax_ignore">t_range</code>. Line 18 establishes <code class="code-inline tex2jax_ignore">t_range</code> as the times from 0.0 to 6.9 using the command <code class="code-inline tex2jax_ignore">t_range = np.arange(0.0, 7.0, 0.1)</code>. Here, <code class="code-inline tex2jax_ignore">np.arange(0.0, 7.0, 0.1)</code> indicates that the range of time values in <code class="code-inline tex2jax_ignore">t_range</code> should start at time 0.0 and end at time 7.0, moving in time increments of 0.1. This means we compute solutions at times 0.0, 0.1, 0.2, and so on, with the last solutions computed at time 6.9. To see the values in <code class="code-inline tex2jax_ignore">t_range</code>, you can run the Python block with the added command <code class="code-inline tex2jax_ignore">print(t_range)</code>. (We discussed these commands in <a href="ch-visualization-graphing-model-results-and-data.html#exer-first-odeint-code" class="xref" data-knowl="./knowl/xref/exer-first-odeint-code.html" data-reveal-label="Reveal" data-close-label="Close" title="Activity 3.4">Activity 3.4</a> and are refreshing our memory on them here.)</div></li>
<li id="activity-rss-intro-2-1-2-1-2"><div class="para" id="activity-rss-intro-2-1-2-1-2-1">The command <code class="code-inline tex2jax_ignore">x in range(0,7)</code> specifies the values <span class="process-math">\(x=0,1,2,3,4,5,6\text{.}\)</span> In general, Python begins with, and includes, the first number in a <code class="code-inline tex2jax_ignore">range</code> command, and then stops at, but does not include, the last number in the <code class="code-inline tex2jax_ignore">range</code> command. This is why <span class="process-math">\(0\)</span> is included, but <span class="process-math">\(7\)</span> is not. To see the values in <code class="code-inline tex2jax_ignore">range(0,7)</code>, you can run the Python block with the added command <code class="code-inline tex2jax_ignore">for x in range(0,7):</code> followed by the line <code class="code-inline tex2jax_ignore">print(x)</code>. The second line needs to be indented.</div></li>
<li id="activity-rss-intro-2-1-2-1-3">
<div class="para" id="activity-rss-intro-2-1-2-1-3-1">The command in line 25 starts with the Data Value given in line 8 by <code class="code-inline tex2jax_ignore">I_data[x]</code> and subtracts the Model Output given by <code class="code-inline tex2jax_ignore">sol[10*x, 1]</code>. The resulting value is then squared, and the squared value is given the name <code class="code-inline tex2jax_ignore">new_square</code>.</div>
<div class="para" id="activity-rss-intro-2-1-2-1-3-2">The command in line 26 prints the value <code class="code-inline tex2jax_ignore">new_square</code> computed in line 25. Printing pieces of output can help us make sure the code is doing what we expect and want it to do.</div>
<div class="para" id="activity-rss-intro-2-1-2-1-3-3">The command in line 27 updates the value of <code class="code-inline tex2jax_ignore">RSS</code> by adding in the most recently computed value of <code class="code-inline tex2jax_ignore">new_square</code>. Earlier in the code, in line 22, we set the value of RSS to 0. This makes certain that we always being with <span class="process-math">\(RSS=0\)</span> and add only the squared distances for our current comparison of Data Values with Model Outputs.</div>
</li>
<li id="activity-rss-intro-2-1-2-1-4"><div class="para" id="activity-rss-intro-2-1-2-1-4-1">We select Model Output values only at integer-valued time steps by multiplying <code class="code-inline tex2jax_ignore">x</code> by <code class="code-inline tex2jax_ignore">10</code> when writing <code class="code-inline tex2jax_ignore">sol[10*x, 1]</code>. Recall that the array <code class="code-inline tex2jax_ignore">sol</code> contains Model Output for <span class="process-math">\(S(t)\)</span> and <span class="process-math">\(I(t)\)</span> for <span class="process-math">\(t=0.0, 0.1, 0.2, 0.3, ..., 6.9\text{.}\)</span> We select Model Output at times <span class="process-math">\(t=0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0\)</span> to correspond to the times at which Data Values exist for comparison. Since <code class="code-inline tex2jax_ignore">x</code> takes on values from <span class="process-math">\(0.0\)</span> to <span class="process-math">\(6.9\text{,}\)</span> and since Python counts starting at <span class="process-math">\(0\text{,}\)</span> then <code class="code-inline tex2jax_ignore">sol[10*0, 1]</code> tells us the Model Output at time <span class="process-math">\(0\text{,}\)</span> <code class="code-inline tex2jax_ignore">sol[10*1, 1]</code> tells us the Model Output at time <span class="process-math">\(1\text{,}\)</span> and so on, until <code class="code-inline tex2jax_ignore">sol[10*6, 1]</code> tells us the Model Output at time <span class="process-math">\(6\text{,}\)</span> where <span class="process-math">\(6\)</span> is the last time for which we have a Data Value.</div></li>
</ol></div></li>
<li id="activity-rss-intro-2-1-3">
<div class="para" id="activity-rss-intro-2-1-3-1">The code produces the value <span class="process-math">\(4.795784246749833\)</span> for the squared distance at time <span class="process-math">\(t=1\text{.}\)</span> Our hand-computed value from part (1) of this Activity was <span class="process-math">\(4.7961\text{.}\)</span> We see that these values are very close to each other. The difference between them is due to our rounding the values in <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#table-si-model-data-values-and-model-output" class="xref" data-knowl="./knowl/xref/table-si-model-data-values-and-model-output.html" data-reveal-label="Reveal" data-close-label="Close" title="Table 10.1: SI Model: Data Values and Model Output for I(t)">Table 10.1</a> to two decimal points.</div>
<div class="para" id="activity-rss-intro-2-1-3-2">Similarly, the code produces the value <span class="process-math">\(111.02234652523701\)</span> for the squared distance at time <span class="process-math">\(t=2\text{,}\)</span> whereas our hand-computed value from part (1) of this Activity was <span class="process-math">\(111.0916\text{.}\)</span> Again, the difference in values is due to rounding.</div>
<div class="para" id="activity-rss-intro-2-1-3-3">From here, make additional observations. This is open-ended. Observations may include noticing that the squared distances are notably larger when the data point is further from the value on the solution curve of the model, compared with when the data point is close to the value on the solution curve of the model. There may also be observations about the overall number computed for RSS. This overall RSS number is helpful when we reach part (4) and try to improve the fit of the model to data</div>
<div class="para" id="activity-rss-intro-2-1-3-4">Many other observations are possible.</div>
</li>
<li id="activity-rss-intro-2-1-4">
<div class="para" id="activity-rss-intro-2-1-4-1">This is open-ended. Values of <span class="process-math">\(\beta\)</span> that are closer to <span class="process-math">\(0.02\)</span> tend to produce a better fit of model to data, compared with the starting value of <span class="process-math">\(\beta = 0.03\text{.}\)</span> You may wish to change additional decimal places of <span class="process-math">\(\beta\)</span> to improve the fit even further.</div>
<div class="para" id="activity-rss-intro-2-1-4-2">It is also appropriate to give visual (graph-based) and verbal (word-based) descriptions of changes in the graph of model and data, as the value of <span class="process-math">\(\beta\)</span> changes.</div>
</li>
</ol></div></details></div></article></section><section class="section" id="sec-underlying-math-rss"><h3 class="heading hide-type">
<span class="type">Section</span><span class="space"> </span><span class="codenumber">10.2</span><span class="space"> </span><span class="title">The Underlying Math of RSS</span>
</h3>
<div class="para" id="sec-underlying-math-rss-2">This section first provides a visual demonstration of what we do when computing RSS, and then presents RSS as a mathematical formula. A goal of this book is for you to dive into modeling, often using examples as a first way to understand how you can build and analyze your own models. We therefore started with <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#activity-rss-intro" class="xref" data-knowl="./knowl/xref/activity-rss-intro.html" data-reveal-label="Reveal" data-close-label="Close" title="Activity 10.2">Activity 10.2</a>, which showed RSS in an example-based way. Now, while describing the mathematical approach more formally, we regularly refer back to <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#activity-rss-intro" class="xref" data-knowl="./knowl/xref/activity-rss-intro.html" data-reveal-label="Reveal" data-close-label="Close" title="Activity 10.2">Activity 10.2</a>.</div>
<div class="para" id="sec-underlying-math-rss-3">Start by considering <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#fig-RSS-example-1" class="xref" data-knowl="./knowl/xref/fig-RSS-example-1.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 10.2">Figure 10.2</a>, which visualizes the subtraction that you did in Step 1 of <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#activity-rss-intro" class="xref" data-knowl="./knowl/xref/activity-rss-intro.html" data-reveal-label="Reveal" data-close-label="Close" title="Activity 10.2">Activity 10.2</a> and that the Python code did in line 25. Each subtraction takes the form of a purple vertical line. The length of each vertical line is the distance between the Model Output and the Data Value at a specific time <span class="process-math">\(t\text{.}\)</span>
</div>
<figure class="figure figure-like" id="fig-RSS-example-1"><div class="image-box" style="width: 80%; margin-left: 10%; margin-right: 10%;">
<img src="external/fig-RSS-example-1.png" class="contained" alt="described in detail following the image" aria-describedby="fig-RSS-example-1-2-description"><details class="image-description" aria-live="polite"><summary title="details"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe88e;</span></summary><div id="fig-RSS-example-1-2-description">This graph shows Data Values as orange dots and Model Output as a smooth curve. The graph also shows the distances between Data Values and Model Output, at times <span class="process-math">\(t=0, 1, 2, 3, 4, 5, 6,\)</span> for the SI model from Exploration 10.1, using <span class="process-math">\(\beta = 0.03\text{.}\)</span>
</div></details>
</div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">10.2<span class="period">.</span></span><span class="space"> </span>Graph showing distances between Data Values and Model Output for the SI model from Exploration 10.1, using <span class="process-math">\(\beta = 0.03\)</span></figcaption></figure><div class="para" id="sec-underlying-math-rss-5">After computing vertical distances in <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#activity-rss-intro" class="xref" data-knowl="./knowl/xref/activity-rss-intro.html" data-reveal-label="Reveal" data-close-label="Close" title="Activity 10.2">Activity 10.2</a>, we then square these distances. Take some time to think through the mathematical outcomes of squaring. One consequence of squaring each distance is that the results will always be non-negative, that is, either positive or zero. Throughout <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#activity-rss-intro" class="xref" data-knowl="./knowl/xref/activity-rss-intro.html" data-reveal-label="Reveal" data-close-label="Close" title="Activity 10.2">Activity 10.2</a> we start with the Data Value and subtract the Model Output, but we could have subtracted in either order because the results after squaring are the same. When we later add together all the squared differences, each vertical distance contributes in a positive way to the sum (or keeps the sum the same, if the vertical distance is zero).</div>
<div class="para" id="sec-underlying-math-rss-6">Another aspect of squaring the distances is that a squaring function grows in an increasing way. This means that one large distance has the potential to contribute much more to the RSS value than several smaller distances. We can visualize this by thinking about the function  <span class="process-math">\(y=x^2\text{.}\)</span> Just as the <span class="process-math">\(y\)</span> values on the graph of <span class="process-math">\(y=x^2\)</span> increase much more rapidly than their corresponding <span class="process-math">\(x\)</span> values, the squares of the distances increase much more rapidly than the distances themselves. The result is that larger distances can contribute to a vastly increased RSS value.</div>
<div class="para" id="sec-underlying-math-rss-7">Next, turn to <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#fig-RSS-example-2" class="xref" data-knowl="./knowl/xref/fig-RSS-example-2.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 10.3">Figure 10.3</a> and notice that the Data Values are the same as in <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#fig-RSS-example-1" class="xref" data-knowl="./knowl/xref/fig-RSS-example-1.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 10.2">Figure 10.2</a>, but the curve of Model Outputs grows more slowly. As a result, the vertical distances between Data Values and Model Outputs tend to be—but are not always—smaller. Previously, such as in <a href="ch-visualization-graphing-model-results-and-data.html" class="internal" title="Chapter 3: Visualization: Graphing Model Results and Data">Chapter 3</a>, we relied only on trial and error, along with personal judgment, to estimate parameter values that would bring the model simulation closer to our data points. Now, the RSS formula both helps us bring the model closer to the data and, importantly, provides a metric by which we can measure that closeness.</div>
<figure class="figure figure-like" id="fig-RSS-example-2"><div class="image-box" style="width: 80%; margin-left: 10%; margin-right: 10%;">
<img src="external/fig-RSS-example-2.png" class="contained" alt="described in detail following the image" aria-describedby="fig-RSS-example-2-2-description"><details class="image-description" aria-live="polite"><summary title="details"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe88e;</span></summary><div id="fig-RSS-example-2-2-description">This graph shows Data Values as orange dots and Model Output as a smooth curve. The graph also shows the distances between Data Values and Model Output, at times <span class="process-math">\(t=0, 1, 2, 3, 4, 5, 6,\)</span> for the SI model from Exploration 10.1, using <span class="process-math">\(\beta = 0.023\text{.}\)</span>
</div></details>
</div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">10.3<span class="period">.</span></span><span class="space"> </span>Graph showing distances between Data Values and Model Output for the SI model from Exploration 10.1, using <span class="process-math">\(\beta = 0.023\)</span></figcaption></figure><div class="para" id="sec-underlying-math-rss-9">Here are the steps for computing RSS for a specific mathematical model, with specific parameter values, in comparison with a particular set of data values.</div>
<ol class="decimal" id="sec-underlying-math-rss-10">
<li id="sec-underlying-math-rss-10-1">
<div class="para" id="sec-underlying-math-rss-10-1-1">Start by determining the Model Output at each time when we have a corresponding Data Value. In <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#activity-rss-intro" class="xref" data-knowl="./knowl/xref/activity-rss-intro.html" data-reveal-label="Reveal" data-close-label="Close" title="Activity 10.2">Activity 10.2</a>, the Data Values occur at times <span class="process-math">\(t=0,1,2,3,4,5,6\text{,}\)</span> so we use Model Output values for each of those times.</div>
<div class="para" id="sec-underlying-math-rss-10-1-2">Notice that the Data Values and Model Outputs count the same things: the number of current Infectious individuals. In some other models, we will need to take additional steps to ensure that the quantities in our model relate directly to the quantities in our data set.</div>
</li>
<li id="sec-underlying-math-rss-10-2"><div class="para" id="sec-underlying-math-rss-10-2-1">For each time <span class="process-math">\(t\text{,}\)</span> subtract <span class="process-math">\((\mbox{Data Value at time }t - \mbox{Model Output Value at time }t)\text{.}\)</span>
</div></li>
<li id="sec-underlying-math-rss-10-3"><div class="para" id="sec-underlying-math-rss-10-3-1">Compute the squares of each value you computed in the previous step. That is, for each time <span class="process-math">\(t\text{,}\)</span> compute <span class="process-math">\((\mbox{Data Value at time }t - \mbox{Model Output Value at time }t)^2\text{.}\)</span>
</div></li>
<li id="sec-underlying-math-rss-10-4"><div class="para logical" id="sec-underlying-math-rss-10-4-1">
<div class="para">Add together all the squared values. The formula below relates to <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#activity-rss-intro" class="xref" data-knowl="./knowl/xref/activity-rss-intro.html" data-reveal-label="Reveal" data-close-label="Close" title="Activity 10.2">Activity 10.2</a>, with Data Values at times <span class="process-math">\(t=0,1,2,3,4,5,6\text{.}\)</span> In an example with different time values <span class="process-math">\(t\text{,}\)</span> the summation may need to involve numbers other than the integers from <span class="process-math">\(0\)</span> to <span class="process-math">\(6\text{:}\)</span>
</div>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/xref/activity-rss-intro.html" id="sec-underlying-math-rss-10-4-1-6">
\begin{gather*}
\sum_{t=0}^{6} (\mbox{Data Value at time }t - \mbox{Model Output Value at time }t)^2 .
\end{gather*}
</div>
</div></li>
</ol>
<div class="para" id="sec-underlying-math-rss-11">This formula allows us to compute RSS for each choice of <span class="process-math">\(\beta\)</span> in our model. We then compare values of RSS for different choices of <span class="process-math">\(\beta\text{,}\)</span> seeking the smallest RSS value among values of <span class="process-math">\(\beta\)</span> that make sense biologically.</div>
<div class="para" id="sec-underlying-math-rss-12">That last sentence deserves extra emphasis: it is crucial that <span class="process-math">\(\beta\)</span> make sense biologically! Many modelers are tempted to minimize the RSS value in any way they can, losing sight of the biological importance of parameter values. We emphasize, throughout this book, that our model parameters have biological meaning, and therefore the values we choose for those parameters need to make real-world sense. In <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#sec-influenza-data-and-rss" class="internal" title="Section 10.4: Influenza Data and RSS">Section 10.4</a>, we discuss parameter values, RSS, and biological meaning in the context of influenza data.</div></section><section class="section" id="sec-residual-sum-of-squares-quickly-comparing-multiple-parameter-values"><h3 class="heading hide-type">
<span class="type">Section</span><span class="space"> </span><span class="codenumber">10.3</span><span class="space"> </span><span class="title">Residual Sum of Squares: Quickly Comparing Multiple Parameter Values</span>
</h3>
<div class="para" id="sec-residual-sum-of-squares-quickly-comparing-multiple-parameter-values-2">As we saw in <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#sec-residual-sum-of-squares-introductory-example" class="internal" title="Section 10.1: Residual Sum of Squares: An Introductory Example">Section 10.1</a>, we can bring model simulations closer to a data set by trying different parameter values, such as by allowing <span class="process-math">\(\beta\)</span> to take on different values. In the Python code block within <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#activity-rss-intro" class="xref" data-knowl="./knowl/xref/activity-rss-intro.html" data-reveal-label="Reveal" data-close-label="Close" title="Activity 10.2">Activity 10.2</a>, for every value of <span class="process-math">\(\beta\)</span> we wanted to try, we had to change the value of <span class="process-math">\(\beta\)</span> within the code and run the code again. Here, we instead wrap another <code class="code-inline tex2jax_ignore">for</code> loop around the RSS <code class="code-inline tex2jax_ignore">for</code> loop, so that we can test multiple values of <span class="process-math">\(\beta\)</span> with one click of the <code class="code-inline tex2jax_ignore">Evaluate</code> button.</div>
<article class="activity project-like" id="activity-rss-beta-loop"><h4 class="heading">
<span class="type">Activity</span><span class="space"> </span><span class="codenumber">10.3</span><span class="period">.</span>
</h4>
<div class="para" id="activity-rss-beta-loop-1-1">This Activity focuses on coding, with the goal of comparing RSS values for multiple values of a parameter without having to run Python code separately for every value of that parameter. Start by reading the code in the Python block below, and use what you read to answer the questions that follow.</div> <pre id="activity-rss-beta-loop-1-2" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">#Import packages 
import numpy as np 
import matplotlib.pyplot as plt  
from scipy.integrate import odeint

#Include data from the Zombie Game App 
t_steps = [0, 1, 2, 3, 4, 5, 6]
I_data = [1, 2, 4, 10, 22, 40, 50]

#Define the system of differential equations, and call it "hz"
def hz(y, t):
  s, i = y #Define y as consisting of s and i, in that order
  dydt = [-beta * s * i, beta * s * i] # These are the right-hand sides of the SI model
  return dydt
  
y0 = [49, 1] #Set initial values for Susceptibles and Infectious, in that order
t_range = np.arange(0.0, 7.0, 0.1) #Set the time range, the set the size of the time steps to use when "stepping through" to numerically solve the system of differential equations

for beta_value in (0.01, 0.02, 0.03, 0.04, 0.05):
  beta = beta_value
  sol = odeint(hz, y0, t_range) #Give the name "sol" to the lists of numerical values in the solution, and give "odeint" the information needed to solve
  RSS = 0 #Initialize the value of RSS to be 0
  for x in range(0,7):
    new_square = (I_data[x] - sol[10*x, 1])**2
    #print("Squared distance at time", x, "=", new_square)
    RSS = RSS + new_square
  print("When beta =", round(beta,4), ", RSS =", round(RSS,4))
</script></pre> <ol class="decimal" id="activity-rss-beta-loop-1-3">
<li id="activity-rss-beta-loop-1-3-1"><div class="para" id="activity-rss-beta-loop-1-3-1-1">Describe how we gave a value to <span class="process-math">\(\beta\)</span> in the code within <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#activity-rss-intro" class="xref" data-knowl="./knowl/xref/activity-rss-intro.html" data-reveal-label="Reveal" data-close-label="Close" title="Activity 10.2">Activity 10.2</a>, compared with how we give values to <span class="process-math">\(\beta\)</span> now in the code for <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#activity-rss-beta-loop" class="xref" data-knowl="./knowl/xref/activity-rss-beta-loop.html" data-reveal-label="Reveal" data-close-label="Close" title="Activity 10.3">Activity 10.3</a>. State the lines of code in which <span class="process-math">\(\beta\)</span> is given its values, and compare the commands used to give <span class="process-math">\(\beta\)</span> its values, explaining how each command works.</div></li>
<li id="activity-rss-beta-loop-1-3-2"><div class="para" id="activity-rss-beta-loop-1-3-2-1">In <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#activity-rss-intro" class="xref" data-knowl="./knowl/xref/activity-rss-intro.html" data-reveal-label="Reveal" data-close-label="Close" title="Activity 10.2">Activity 10.2</a> we run the command <code class="code-inline tex2jax_ignore">sol = odeint(hz, y0, t_range)</code> and give <code class="code-inline tex2jax_ignore">RSS</code> its initial value of <span class="process-math">\(0\)</span> outside any <code class="code-inline tex2jax_ignore">for</code> loop. Now, in <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#activity-rss-beta-loop" class="xref" data-knowl="./knowl/xref/activity-rss-beta-loop.html" data-reveal-label="Reveal" data-close-label="Close" title="Activity 10.3">Activity 10.3</a>, we run <code class="code-inline tex2jax_ignore">odeint</code> and reset <span class="process-math">\(RSS=0\)</span> inside the new outer <code class="code-inline tex2jax_ignore">for</code> loop, but before running the inner <code class="code-inline tex2jax_ignore">for</code> loop to compute RSS for a specific value of <span class="process-math">\(\beta\text{.}\)</span> Explain the reasoning for where in the code we run <code class="code-inline tex2jax_ignore">odeint</code> and set <span class="process-math">\(RSS=0\text{.}\)</span>
</div></li>
<li id="activity-rss-beta-loop-1-3-3"><div class="para" id="activity-rss-beta-loop-1-3-3-1">Discuss how indenting works for the nested <code class="code-inline tex2jax_ignore">for</code> loops. Python requires correct indenting.</div></li>
<li id="activity-rss-beta-loop-1-3-4"><div class="para" id="activity-rss-beta-loop-1-3-4-1">Discuss the commented-out <code class="code-inline tex2jax_ignore">print</code> command in line 25. Why might we choose not to see these results in this code, whereas we wanted to see these results in <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#activity-rss-intro" class="xref" data-knowl="./knowl/xref/activity-rss-intro.html" data-reveal-label="Reveal" data-close-label="Close" title="Activity 10.2">Activity 10.2</a>, where this command appeared on line 26? Then discuss the <code class="code-inline tex2jax_ignore">print</code> command in line 27, and explain why the information it shows is especially helpful to us as we cycle through values of <span class="process-math">\(\beta\text{.}\)</span>
</div></li>
</ol>
<div class="solutions"><details id="activity-rss-beta-loop-2" class="answer solution-like born-hidden-knowl"><summary class="knowl__link"><span class="type">Answer</span><span class="period">.</span></summary><div class="answer solution-like knowl__content"><ol class="decimal" id="activity-rss-beta-loop-2-1">
<li id="activity-rss-beta-loop-2-1-1">
<div class="para" id="activity-rss-beta-loop-2-1-1-1">In <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#activity-rss-intro" class="xref" data-knowl="./knowl/xref/activity-rss-intro.html" data-reveal-label="Reveal" data-close-label="Close" title="Activity 10.2">Activity 10.2</a> we give <span class="process-math">\(\beta\)</span> just one value, in line 16, by writing <code class="code-inline tex2jax_ignore">beta = 0.03</code>, that is, by naming <span class="process-math">\(\beta\)</span> and using the <code class="code-inline tex2jax_ignore">=</code> sign to assign a value to <span class="process-math">\(\beta\text{.}\)</span> The default code gives <span class="process-math">\(\beta\)</span> the value <span class="process-math">\(0.03\text{,}\)</span> and we can change this value by changing <span class="process-math">\(0.03\)</span> to a different number.</div>
<div class="para" id="activity-rss-beta-loop-2-1-1-2">In <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#activity-rss-beta-loop" class="xref" data-knowl="./knowl/xref/activity-rss-beta-loop.html" data-reveal-label="Reveal" data-close-label="Close" title="Activity 10.3">Activity 10.3</a> we state in line 19 that we will give <span class="process-math">\(\beta\)</span> the values <span class="process-math">\(0.01, 0.02, 0.03, 0.04,\)</span> and <span class="process-math">\(0.05\text{,}\)</span> one at a time. The first time the <code class="code-inline tex2jax_ignore">for</code> loop runs, <span class="process-math">\(\beta\)</span> is given the first of this list of values, that is, <span class="process-math">\(\beta = 0.01\text{.}\)</span> Each time the <code class="code-inline tex2jax_ignore">for</code> loop runs, <span class="process-math">\(\beta\)</span> is given the next value, as shown in line 20 of the code. In all, the loop will run five times, once for each value of <span class="process-math">\(\beta\text{,}\)</span> and <span class="process-math">\(\beta\)</span> will take on each value one time.</div>
</li>
<li id="activity-rss-beta-loop-2-1-2"><div class="para" id="activity-rss-beta-loop-2-1-2-1">For each value of <span class="process-math">\(\beta\text{,}\)</span> we use Python to do two things: solve the system of differential equations for that value of <span class="process-math">\(\beta\text{,}\)</span> and compute the resulting RSS value comparing our Data Values with the Model Output from the solved differential equations. The outer <code class="code-inline tex2jax_ignore">for</code> loop cycles through different values of <span class="process-math">\(\beta\text{.}\)</span> For each, we recompute the array <code class="code-inline tex2jax_ignore">sol</code> by running <code class="code-inline tex2jax_ignore">odeint</code> on line 21, and we reset <code class="code-inline tex2jax_ignore">RSS = 0</code> on line 22. We are then ready to run the inner <code class="code-inline tex2jax_ignore">for</code> loop, starting on line 23, where we compute the specific RSS value for the current value of <span class="process-math">\(\beta\text{.}\)</span>
</div></li>
<li id="activity-rss-beta-loop-2-1-3"><div class="para" id="activity-rss-beta-loop-2-1-3-1">Python syntax requires that we indent the commands within a <code class="code-inline tex2jax_ignore">for</code> loop. Indenting also serves as a visual signal to us, indicating which <code class="code-inline tex2jax_ignore">for</code> loop each command is part of. The commands within the outer <code class="code-inline tex2jax_ignore">for</code> loop, including the first line of the inner <code class="code-inline tex2jax_ignore">for</code> loop,  are indented the same amount. The commands within the inner <code class="code-inline tex2jax_ignore">for</code> loop are indented further. Notice that the <code class="code-inline tex2jax_ignore">print</code> command on line 27 is not as indented as commands on lines 24, 25, and 26. This tells us that line 27 is part of the outer <code class="code-inline tex2jax_ignore">for</code> loop rather than the inner <code class="code-inline tex2jax_ignore">for</code> loop.</div></li>
<li id="activity-rss-beta-loop-2-1-4">
<div class="para" id="activity-rss-beta-loop-2-1-4-1">The <code class="code-inline tex2jax_ignore">print</code> command from line 25 was especially helpful in <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#activity-rss-intro" class="xref" data-knowl="./knowl/xref/activity-rss-intro.html" data-reveal-label="Reveal" data-close-label="Close" title="Activity 10.2">Activity 10.2</a> when we were learning, and perhaps troubleshooting, the code for computing RSS for a specific value of <span class="process-math">\(\beta\text{.}\)</span> In <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#activity-rss-intro" class="xref" data-knowl="./knowl/xref/activity-rss-intro.html" data-reveal-label="Reveal" data-close-label="Close" title="Activity 10.2">Activity 10.2</a> this print command appeared in line 26, and it showed us the step-by-step squared distances computed in Python that would be added together to produce the total RSS value. We compared some of these squared distances with values we computed by hand, both to make sure Python was doing what we wanted, and to build student understanding of the meaning of the RSS value.</div>
<div class="para" id="activity-rss-beta-loop-2-1-4-2">Once we understand how this <code class="code-inline tex2jax_ignore">for</code> loop works when computing RSS, we do not usually need to print all the squared distances. This is the reason why the <code class="code-inline tex2jax_ignore">print</code> command in line 25 of the code for <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#activity-rss-beta-loop" class="xref" data-knowl="./knowl/xref/activity-rss-beta-loop.html" data-reveal-label="Reveal" data-close-label="Close" title="Activity 10.3">Activity 10.3</a> is commented out. We can use this code if we want by removing the <code class="code-inline tex2jax_ignore">#</code> at the start of the line, but now we are more focused on seeing the RSS results for each value of <span class="process-math">\(\beta\text{.}\)</span> These RSS results appear due to the <code class="code-inline tex2jax_ignore">print</code> command in line 27, and we compare them to determine which <span class="process-math">\(\beta\)</span> values produce the smallest values for RSS.</div>
</li>
</ol></div></details></div></article></section><section class="section" id="sec-influenza-data-and-rss"><h3 class="heading hide-type">
<span class="type">Section</span><span class="space"> </span><span class="codenumber">10.4</span><span class="space"> </span><span class="title">Influenza Data and RSS</span>
</h3>
<div class="para" id="sec-influenza-data-and-rss-2">Now try computing RSS using the influenza prevalence data. The data are already written into the code block below. Time 0 is the same as October 6.</div>
<pre id="sec-influenza-data-and-rss-3" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">#Import packages
import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import odeint

plt.cla()  #Clear (delete) any past plots

#Include data from Zombie Game App
t_steps = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
I_prevalence_data = [5, 13, 15, 21, 27, 37, 57, 108, 146, 160, 157, 138, 102, 79, 66, 54, 45, 28, 7, 0]

#Define the system of differential equations, and call it "hz"
def hz(y, t):
  s, i, r = y #Define y as consisting of s and i, in that order
  dydt = [-beta * s * i, beta * s * i - gamma * i, gamma * i] #These formulas are the right-hand sides of the SI model
  return dydt
  
beta = 0.00035 #Give a value to beta
gamma = 0.33 # Give a value to gamma: 0.25-0.33 are good values for most versions of flu
y0 = [1709, 5, 0] #Set initial conditions for S, I, and R. There were 1714 students on campus.
t_range = np.arange(0.0, 40.0, 0.1) #Set the time range, then set the size of the time steps to use when "stepping through" to numerically solve
 
sol = odeint(hz, y0, t_range) #Give the name "sol" to the lists of numerical values in the solution, and give "odeint" the information needed to solve

# Plotting commands are below
plt.plot(t_steps, I_prevalence_data,'o', markersize=4, color='orange')
plt.plot(t_range, sol[:, 1], color='orange', linewidth=2, label='I(t)')
plt.legend()
plt.xlabel('time')
plt.ylabel('population')
plt.show()


RSS = 0

for x in range(0,20):
    RSS = RSS + (I_prevalence_data[x] - sol[0 + 10 * x, 1])**2
    #print(RSS) #Uncomment this command to see in-between RSS calculations

print("RSS = ", RSS)
</script></pre></section><section class="exercises" id="exercises-ch-rss"><h3 class="heading hide-type">
<span class="type">For Further Thought</span><span class="space"> </span><span class="codenumber">10.5</span><span class="space"> </span><span class="title">For Further Thought</span>
</h3>
<article class="exercise exercise-like" id="exercises-ch-rss-1"><h4 class="heading"><span class="codenumber">1<span class="period">.</span></span></h4>
<div class="para" id="exercises-ch-rss-1-1">As described starting on page 356 of Mathematical Models in Population Biology and Epidemiology, second edition, by Fred Brauer and Carlos Castillo-Chavez, the village of Eyam, in England, was affected by bubonic plague in 1665-1666. There were two separate plague outbreaks, and <a href="ch-residual-sum-of-squares-improving-a-models-fit-to-data.html#table-rss-eyam" class="xref" data-knowl="./knowl/xref/table-rss-eyam.html" data-reveal-label="Reveal" data-close-label="Close" title="Table 10.4: Plague Data from Eyam, 1666">Table 10.4</a> shows data for the second of these outbreaks.</div>
<figure class="table table-like" id="table-rss-eyam"><figcaption><span class="type">Table</span><span class="space"> </span><span class="codenumber">10.4<span class="period">.</span></span><span class="space"> </span>Plague Data from Eyam, 1666</figcaption><div class="tabular-box natural-width"><table class="tabular">
<tr class="header-horizontal">
<th scope="col" class="c m b0 r0 l0 t0 lines">Date (Day)</th>
<th scope="col" class="c m b0 r0 l0 t0 lines">Susceptibles</th>
<th scope="col" class="c m b0 r0 l0 t0 lines">Infectious</th>
</tr>
<tr>
<td class="c m b0 r0 l0 t0 lines">July 3/4 (Day 0)</td>
<td class="c m b0 r0 l0 t0 lines">235</td>
<td class="c m b0 r0 l0 t0 lines">14.5</td>
</tr>
<tr>
<td class="c m b0 r0 l0 t0 lines">July 19 (Day 15.5)</td>
<td class="c m b0 r0 l0 t0 lines">201</td>
<td class="c m b0 r0 l0 t0 lines">22</td>
</tr>
<tr>
<td class="c m b0 r0 l0 t0 lines">August 3/4 (Day 31)</td>
<td class="c m b0 r0 l0 t0 lines">153.5</td>
<td class="c m b0 r0 l0 t0 lines">29</td>
</tr>
<tr>
<td class="c m b0 r0 l0 t0 lines">August 19 (Day 46.5)</td>
<td class="c m b0 r0 l0 t0 lines">121</td>
<td class="c m b0 r0 l0 t0 lines">21</td>
</tr>
<tr>
<td class="c m b0 r0 l0 t0 lines">September 3/4 (Day 62)</td>
<td class="c m b0 r0 l0 t0 lines">108</td>
<td class="c m b0 r0 l0 t0 lines">8</td>
</tr>
<tr>
<td class="c m b0 r0 l0 t0 lines">September 19 (Day 77.5)</td>
<td class="c m b0 r0 l0 t0 lines">97</td>
<td class="c m b0 r0 l0 t0 lines">8</td>
</tr>
<tr>
<td class="c m b0 r0 l0 t0 lines">October 4/5 (Day 93)</td>
<td class="c m b0 r0 l0 t0 lines">Unknown</td>
<td class="c m b0 r0 l0 t0 lines">Unknown</td>
</tr>
<tr>
<td class="c m b0 r0 l0 t0 lines">October 20 (Day 108.5)</td>
<td class="c m b0 r0 l0 t0 lines">83</td>
<td class="c m b0 r0 l0 t0 lines">0</td>
</tr>
</table></div></figure><ol class="lower-alpha" id="exercises-ch-rss-1-3">
<li id="exercises-ch-rss-1-3-1"><div class="para" id="exercises-ch-rss-1-3-1-1">Use Python to plot these data.</div></li>
<li id="exercises-ch-rss-1-3-2"><div class="para" id="exercises-ch-rss-1-3-2-1">Then, use the information that we start with a population of 250 people, the infectious period was 11 days, and <span class="process-math">\(\mathcal{R}_0\)</span> has been estimated to be between 1.6 and 1.9, to construct an SIR model for this outbreak.</div></li>
<li id="exercises-ch-rss-1-3-3">
<div class="para" id="exercises-ch-rss-1-3-3-1">Then use an RSS approach, along with the data and your SIR model, to select a preferred value of <span class="process-math">\(\beta\)</span> for this SIR model. You may choose to compute <span class="process-math">\((\mbox{Data Value} - \mbox{Model Output})^2\)</span> separately for each day on which population values are available, or you can use a Python <code class="code-inline tex2jax_ignore">for</code> loop for the six consecutive data points, and then add in <span class="process-math">\((\mbox{Data Value} - \mbox{Model Output})^2\)</span> for the October 20 data, in order to complete each total RSS value. Additionally, be sure that Python selects the correct value from its model output: this will require changing the <code class="code-inline tex2jax_ignore">10</code> in the <code class="code-inline tex2jax_ignore">sol[10*x, 1]</code> part of the code.</div>
<div class="para" id="exercises-ch-rss-1-3-3-2">(NOTE for the Bates Mathematical Models in Biology course in Fall 2024: you may compute RSS for comparing the model with just the first six data points, rather than needing to include the last data point, and rather than needing to figure out how to skip over the "Unknown" data point. However, if you can find a way to include the last data point, go ahead and include it!)</div>
<div class="para" id="exercises-ch-rss-1-3-3-3">In your homework, show your Python code, and show at least three different values of <span class="process-math">\(\beta\)</span> that you tried, along with the corresponding RSS value for each value of <span class="process-math">\(\beta\text{.}\)</span> Which value of <span class="process-math">\(\beta\)</span> leads to the smallest RSS value? Confirm that this value of <span class="process-math">\(\beta\)</span> makes biological sense, based on the numbers or ranges of numbers we know for <span class="process-math">\(N\text{,}\)</span> <span class="process-math">\(\mathcal{R}_0\text{,}\)</span> and <span class="process-math">\(\gamma\text{.}\)</span>
</div>
</li>
</ol></article></section></section></div>
<div class="ptx-content-footer">
<a class="previous-button button" href="ch-preparing-influenza-data-to-compare-with-a-model.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="top-button button" href="#" title="Top"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Top</span></a><a class="next-button button" href="ch-akaike-information-criterion-comparing-different-models.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a>
</div></main>
</div>
<div id="ptx-page-footer" class="ptx-page-footer">
<a class="pretext-link" href="https://pretextbook.org" title="PreTeXt"><div class="logo"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="338 3000 8772 6866"><g style="stroke-width:.025in; stroke:black; fill:none"><polyline points="472,3590 472,9732 " style="stroke:#000000;stroke-width:174; stroke-linejoin:miter; stroke-linecap:round; "></polyline><path style="stroke:#000000;stroke-width:126;stroke-linecap:butt;" d="M 4724,9448 A 4660 4660  0  0  1  8598  9259"></path><path style="stroke:#000000;stroke-width:174;stroke-linecap:butt;" d="M 4488,9685 A 4228 4228  0  0  0   472  9732"></path><path style="stroke:#000000;stroke-width:126;stroke-linecap:butt;" d="M 4724,3590 A 4241 4241  0  0  1  8598  3496"></path><path style="stroke:#000000;stroke-width:126;stroke-linecap:round;" d="M 850,3496  A 4241 4241  0  0  1  4724  3590"></path><path style="stroke:#000000;stroke-width:126;stroke-linecap:round;" d="M 850,9259  A 4507 4507  0  0  1  4724  9448"></path><polyline points="5385,4299 4062,8125" style="stroke:#000000;stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8598,3496 8598,9259" style="stroke:#000000;stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="850,3496 850,9259" style="stroke:#000000;stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="4960,9685 4488,9685" style="stroke:#000000;stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="3070,4582 1889,6141 3070,7700" style="stroke:#000000;stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="6418,4582 7600,6141 6418,7700" style="stroke:#000000;stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8976,3590 8976,9732" style="stroke:#000000;stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><path style="stroke:#000000;stroke-width:174;stroke-linecap:butt;" d="M 4960,9685 A 4228 4228  0  0  1  8976  9732"></path></g></svg></div></a><a class="runestone-link" href="https://runestone.academy" title="Runestone Academy"><img class="logo" src="https://runestone.academy/runestone/static/images/RAIcon_cropped.png"></a><a class="mathjax-link" href="https://www.mathjax.org" title="MathJax"><img class="logo" src="https://www.mathjax.org/badge/badge-square-2.png"></a>
</div>
</body>
</html>
