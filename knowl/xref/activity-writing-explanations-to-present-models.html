<!DOCTYPE html>
<html lang="en-US" dir="ltr">
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex, nofollow">
<script>// Make *any* pre with class 'sagecell-sage' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({
  "inputLocation": "pre.sagecell-sage",
  "linked": true,
  "linkKey": "linked-sage",
  "autoeval": false,
  "languages": [
    "sage"
  ],
  "evalButtonText": "Evaluate (Sage)"
});
</script>
</head>
<body class="ignore-math">
<article class="activity project-like"><h4 class="heading">
<span class="type">Activity</span><span class="space"> </span><span class="codenumber">8.8</span><span class="period">.</span>
</h4>
<div class="para">Imagine a residential college campus experiences an outbreak of flu, which is also called influenza. The incubation period for influenza is usually one to four days, and most often about two days. People tend to be sick with influenza for a few days to less than two weeks, and in most people, less than one week<details class="ptx-footnote" aria-live="polite" id="activity-writing-explanations-to-present-models-1-1-1"><summary class="ptx-footnote__number" title="Footnote 8.3"><sup> 3 </sup></summary><div class="ptx-footnote__contents" id="activity-writing-explanations-to-present-models-1-1-1">Facts on incubation period and period of contagion are shown in the CDC’s <em class="emphasis">Key Facts About Influenza</em> page: <a class="external" href="https://www.cdc.gov/flu/about/keyfacts.htm" target="_blank"><code class="code-inline tex2jax_ignore">https://www.cdc.gov/flu/about/keyfacts.htm</code></a>.</div></details>. The value of <span class="process-math">\(\mathcal{R}_0\)</span> for influenza is typically between 1 and 2<details class="ptx-footnote" aria-live="polite" id="activity-writing-explanations-to-present-models-1-1-3"><summary class="ptx-footnote__number" title="Footnote 8.4"><sup> 4 </sup></summary><div class="ptx-footnote__contents" id="activity-writing-explanations-to-present-models-1-1-3">This summary of <span class="process-math">\(\mathcal{R}_0\)</span> values comes from the Virginia Department of Health (<a class="external" href="https://www.vdh.virginia.gov/coronavirus/2022/01/07/covid-19-and-influenza-surveillance" target="_blank"><code class="code-inline tex2jax_ignore">https://www.vdh.virginia.gov/coronavirus/2022/01/07/covid-19-and-influenza-surveillance</code></a>), and many other research articles and websites report on <span class="process-math">\(\mathcal{R}_0\)</span> estimates.</div></details>, and many people in a population tend to have some immunity or protection from influenza, either because they have been sick with a related strain of influenza in the past, or because they have received an influenza vaccine, or for both reasons.</div> <ol class="decimal">
<li><div class="para">Decide on a model that you would use for an influenza outbreak on the campus you are imagining. Write out your reasons for the modeling decisions you make. Ideas to consider include: which compartmental model? How many people are involved, and what are the initial numbers of people in each compartment? What are the parameter values? What ranges of values may be possible for initial values and parameter values? There may be yet other aspects of your model to describe and explain.</div></li>
<li>
<div class="para">Ask some questions of your model. Two sample questions are, “What happens if the campus vastly increases its number and distribution of hand sanitizing stations?” and “How much do the model’s results change as the initial number of infectious people changes?”. There are many other questions you can ask. Use Python code blocks from elsewhere in the text to answer your questions. Select a code block that includes the type of model you are using (such as SIR, SEIR, and possibly vaccination) and make whatever changes you need.</div>
<div class="para">Once you have addressed each question, write about your results. Include information about what question you asked and why it was a reasonable question, given the outbreak being studied. In addition to writing your response using words, incorporate other evidence, such as graphs and long-term values of Susceptibles or other compartments. Think throughout about structuring your response logically; indicating your priorities; explaining the change you made and why you made it; and explaining what happened when you made that change.</div>
</li>
<li><div class="para">Creating COVID-19 vaccines was an early goal, one that people were modeling long before vaccines became available.<details class="ptx-footnote" aria-live="polite" id="activity-writing-explanations-to-present-models-1-2-3-1-1"><summary class="ptx-footnote__number" title="Footnote 8.5"><sup> 5 </sup></summary><div class="ptx-footnote__contents" id="activity-writing-explanations-to-present-models-1-2-3-1-1">In some parts of the world, there has been significant controversy about the use of vaccines for COVID-19. This book does not require readers to have any one opinion about vaccine usage. We use models to address questions about vaccines, and readers are invited to do the same, building models that represent different vaccine-based outcomes and using those models to determine outcomes and dynamics of COVID-19, with and without vaccines.</div></details> The plan was for vaccines to address COVID-19 in multiple ways; we will address two such ways here. One way was for people to be less likely to get COVID-19. Another way was to reduce the severity or length of time ill for people who did get COVID-19. For each of these ways of addressing COVID-19: which compartments and/or parameters in the SEIR model are affected? Prepare before-and-after versions of the model, carefully defining each compartment and parameter in the before model and again in the after model. Then use the Python graph to generate graphs comparing the outcomes before and after vaccines.</div></li>
<li><div class="para">Do more open-ended exploration. How else can we use the SEIR model to address questions about the early spread of an outbreak? State questions of your own, explain what changes you are making to the model to answer your questions, and show your results. Include explanations and interpretations of your results.</div></li>
</ol> <ul class="disc">
<li><div class="para">Susceptibles (S) are people who have not yet become sick, and who can become sick. The Susceptibles could, in some cases, include people who have been vaccinated and therefore have less chance of becoming sick.</div></li>
<li><div class="para">The Exposed-and-incubating (E) compartment includes people who have gotten the COVID-19 virus but not yet become infectious, and this class may include people with and without vaccination.</div></li>
<li><div class="para">The Infectious (I) compartment includes people who are currently infectious, regardless of the severity of their symptoms, and in some cases, people in the Infectious compartment are also assumed to be interacting with Susceptibles.</div></li>
<li><div class="para">The Removed (R) compartment may consist of people who have recovered from COVID-19, died from COVID-19, or entirely isolated themselves from others, so that they cannot spread COVID-19 at all.</div></li>
</ul> <div class="para">The equations for the SEIR model are below. Use these, along with the Python code block, to answer the questions that follow.</div> <div class="para">For questions 2, 3, and possibly 4, first <em class="emphasis">imagine how changes to initial population values or parameter values can change outcomes in the model</em>. That is, truly think through this in your mind, and write down your thoughts, before proceeding with changes. For reference, the values in the original model are based very loosely on Lombardy, Italy, in early 2020. The total population was approximately ten million. The value of <span class="process-math">\(\mathcal{R}_0\)</span> was estimated to be <span class="process-math">\(2.6-3.3\text{,}\)</span> and <span class="process-math">\(\kappa\)</span> is estimated at about <span class="process-math">\(1/6.5\text{.}\)</span><details class="ptx-footnote" aria-live="polite" id="activity-writing-explanations-to-present-models-1-5-6"><summary class="ptx-footnote__number" title="Footnote 8.6"><sup> 6 </sup></summary><div class="ptx-footnote__contents" id="activity-writing-explanations-to-present-models-1-5-6">These estimates come from the paper “The early phase of the COVID-19 epidemic in Lombardy, Italy” by many researchers, published in the journal <em class="emphasis">Epidemics</em> in December 2021.</div></details> The value of <span class="process-math">\(\gamma\)</span> is <span class="process-math">\(1/14\text{,}\)</span> indicating an average of two weeks of being infectious. This is based on many reports suggesting that most people were infectious for one to two weeks, but that some people were infectious for much longer. There was vast variation on how early COVID-19 affected people, which is part of the reason we need to consider changes and updates to models.</div> <div class="para">Next, try your changes in Python, creating before-and-after graphs. The code block includes sections titled “original model” and “your changes to the model”: scroll through to the “your changes to the model” version to make updates. Then go to the “plotting commands” section to choose the compartments for which you would like to show graphs; the default is to show I(t) for both the original and updated versions. Notice that if you were to show all four compartments, before and after, there would be eight total curves, which can be complicated for a reader to understand. Instead, prioritize the graphs that best illustrate your findings, probably showing no more than two or four total graphs at a time.</div>
<div class="displaymath process-math">
\begin{align*}
\frac{dS}{dt} \amp = - \beta S I \\
\frac{dE}{dt} \amp =  \beta S I - \kappa E \\
\frac{dI}{dt} \amp =  \kappa E - \gamma I \\
\frac{dR}{dt} \amp = \gamma I. 
\end{align*}
</div>
<pre id="activity-writing-explanations-to-present-models-1-8" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">#Import packages
import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import odeint

plt.cla() #Clear (delete) any past plots
t_range = np.arange(0.0, 49.1, 0.1) #The time range for both models stays the same, to make comparisons easier

#------------------ORIGINAL MODEL------------------

#Define the system of differential equations for the ORIGINAL conditions, and call it "model_1". All variables and parameters have "_1" to indicate this is the first version of the model
def model_1(y_1, t_1):
  S_1, E_1, I_1, R_1 = y_1 #Define y as consisting of S, E, I, and R, in that order, each with the "_1" to show this is for the model with original conditions
  dydt_1 = [- beta_1 * S_1 * I_1, beta_1 * S_1 * I_1 - kappa_1 * E_1, kappa_1 * E_1 - gamma_1 * I_1, gamma_1 * I_1] #Provide the right-hand sides of the SEIR model
  return dydt_1

#All values below are for the original conditions for the model
beta_1 = 2.1 * 10^(-8) #Give a value to beta
kappa_1 = 0.154 #Give a value to kappa
gamma_1 = 0.0714 #Give a value to gamma
total_population_1 = 10000000 #Give a total population here, and use it later to compute the initial S population
E_init_1 = 10 #Give an initial value to population E
I_init_1 = 20 #Give an initial value to population I
R_init_1 = 0 #Give an initial value to population R
S_init_1 = total_population_1 - E_init_1 - I_init_1 - R_init_1 #Solve for the initial population value for S, using total_population and initial population values for E, I, and R
R0_1 = beta_1 * (total_population_1) / gamma_1 #Compute the value of R0
print("R0_1 = ", R0_1) #Print the value of R0, to confirm that our parameter values correspond to a reasonable R0 value
y0_1 = [S_init_1, E_init_1, I_init_1, R_init_1] #Put initial conditions for S, E, I, and R into "y0_1" for use below in "odeint"

sol_1 = odeint(model_1, y0_1, t_range) #Give the name "sol_1" to the lists of numerical values in this original solution, and give "odeint" the information needed to solve

#------------------YOUR CHANGES TO THE MODEL------------------

#Define the system of differential equations for YOUR CHANGES TO THE MODEL, and call it "model_2". All variables and parameters have "_2" to indicate this is the second version of the model
def model_2(y_2, t_2):
  S_2, E_2, I_2, R_2 = y_2 #Define y as consisting of S, E, I, and R, in that order, each with the "_2" to show this is for the model with original conditions
  dydt_2 = [- beta_2 * S_2 * I_2, beta_2 * S_2 * I_2 - kappa_2 * E_2, kappa_2 * E_2 - gamma_2 * I_2, gamma_2 * I_2] #Provide the right-hand sides of the SEIR model
  return dydt_2
#These are the original conditions for the model. Make changes to think through public health interventions
beta_2 = 2.1 * 10^(-8) #Give a value to beta
kappa_2 = 0.154 #Give a value to kappa
gamma_2 = 0.0714 #Give a value to gamma
total_population_2 = 10000000 #Give a total population here, and use it later to compute the initial S population
E_init_2 = 10 #Give an initial value to population E
I_init_2 = 20 #Give an initial value to population I
R_init_2 = 0 #Give an initial value to population R
S_init_2 = total_population_2 - E_init_2 - I_init_2 - R_init_2 #Solve for the initial population value for S, using total_population and initial population values for E, I, and R
R0_2 = beta_2 * (total_population_2) / gamma_2 #Compute the value of R0
print("R0_2 = ", R0_2) #Print the value of R0, to confirm that your parameter values correspond to a reasonable R0 value
y0_2 = [S_init_2, E_init_2, I_init_2, R_init_2] #Put initial conditions for S, E, I, and R into "y0_2" for use below in "odeint"

sol_2 = odeint(model_2, y0_2, t_range) #Give the name "sol_2" to the lists of numerical values in this updated solution, and give "odeint" the information needed to solve

#------------------PLOTTING COMMANDS------------------

#Comment out, or include, whichever commands best demonstrate your story
#The default is to show I(t) in both models
#The defauls is also for all updated model curves to appear as unbroken black curves
#If you are showing more than one compartment, in both models, it will help to change the color and/or style for the updated model so the curves are distinct 

#plt.plot(t_range, sol_1[:, 0], color='blue', linewidth=2, label='S(t) original')
#plt.plot(t_range, sol_1[:, 1], color='magenta', linestyle='dotted', linewidth=2, label='E(t) original')
plt.plot(t_range, sol_1[:, 2], color='orange', linestyle='dashed', linewidth=2, label='I(t) original')
#plt.plot(t_range, sol_1[:, 3], color='teal', linestyle='dashdot', linewidth=2, label='R(t) original')
#plt.plot(t_range, sol_2[:, 0], color='black', linewidth=2, label='S(t) updated')
#plt.plot(t_range, sol_2[:, 1], color='black', linewidth=2, label='E(t) updated')
plt.plot(t_range, sol_2[:, 2], color='black', linewidth=2, label='I(t) updated')
#plt.plot(t_range, sol_2[:, 3], color='black', linewidth=2, label='R(t) updated'
plt.legend()
plt.grid()
plt.xlabel('time')
plt.ylabel('populations')
plt.show()
</script></pre>
<div class="solutions"><details class="hint solution-like born-hidden-knowl"><summary class="knowl__link"><span class="type">Hint</span><span class="period">.</span></summary><div class="hint solution-like knowl__content"><ol class="decimal">
<li><div class="para">These are likely the traditional definitions we have used previously for the SEIR model. There is always room for flexibility, though, when different answers are accompanied by logical explanations.</div></li>
<li><div class="para">Flattening the curve, social distancing, and other terms predominantly reduce the parameter <span class="process-math">\(\beta\text{.}\)</span> Other changes to the model may also represent some aspects of flattening the curve.</div></li>
<li><div class="para">The effect of people being less likely to get COVID-19 is usually modeled by reducing <span class="process-math">\(\beta\text{.}\)</span> Reducing the severity or time ill typically increases gamma, which also has the meaning of reducing the average time in the Infectious compartment, as shown in <a href="ch-compartmental-diagrams.html#sec-estimating-gamma-and-other-rates-6" class="xref" data-knowl="./knowl/xref/eq-gamma-estimate.html" data-reveal-label="Reveal" data-close-label="Close" title="Equation 4.1">(4.1)</a> and <a href="ch-compartmental-diagrams.html#sec-estimating-gamma-and-other-rates-8" class="xref" data-knowl="./knowl/xref/eq-gamma-estimate-2.html" data-reveal-label="Reveal" data-close-label="Close" title="Equation 4.2">(4.2)</a>. Other answers are possible.</div></li>
<li><div class="para">Be expansive and creative here, explain all your reasoning, and create graphs and/or bring in yet other evidence to demonstrate your findings.</div></li>
</ol></div></details></div></article><span class="incontext"><a class="internal" href="ch-getting-the-answer-right-in-modeling.html#activity-writing-explanations-to-present-models">in-context</a></span>
</body>
</html>
