<!DOCTYPE html>
<html lang="en-US" dir="ltr">
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex, nofollow">
<script>// Make *any* pre with class 'sagecell-sage' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({
  "inputLocation": "pre.sagecell-sage",
  "linked": true,
  "linkKey": "linked-sage",
  "autoeval": false,
  "languages": [
    "sage"
  ],
  "evalButtonText": "Evaluate (Sage)"
});
</script>
</head>
<body class="ignore-math">
<article class="activity project-like"><h4 class="heading">
<span class="type">Activity</span><span class="space"> </span><span class="codenumber">7.3</span><span class="period">.</span>
</h4>
<div class="para">This activity provides a venue for you to play with the SEIR model. Begin by thinking through how you expect SEIR solution curves to appear, and then use Python code to create these solutions and see how they respond to changing parameters.</div> <ol class="decimal" id="activity-seir-model-play-with-kappa-1-2">
<li><div class="para">Do a sign analysis of the SEIR model. Is it possible for the <span class="process-math">\(S(t)\text{,}\)</span> <span class="process-math">\(I(t)\text{,}\)</span> or <span class="process-math">\(R(t)\)</span> curves in the SEIR model to behave in any ways that are fundamentally different than how these curves behave in the SIR model? In particular: within <a href="ch-model-analysis-and-the-basic-reproduction-number-R0.html#sec-using-calculus-to-analyze-models" class="internal" title="Section 5.1: Using Calculus to Analyze Models">Section 5.1</a> we discussed the ways these three curves in the SIR model could fall, or rise and fall, or rise. Can the <span class="process-math">\(S(t)\text{,}\)</span> <span class="process-math">\(I(t)\text{,}\)</span> or <span class="process-math">\(R(t)\)</span> curves behave any differently in the SEIR model? And what does sign analysis tell you about how the <span class="process-math">\(E(t)\)</span> model can possibly behave?</div></li>
<li>
<div class="para">Run the Python code below, and observe the curve <span class="process-math">\(E(t)\text{.}\)</span> Does it behave the way you predicted in the first part of this Activity? (It should.)</div>
<div class="para">Next, make a note of the long-term number of people who become sick in this model. Then make <span class="process-math">\(\kappa\)</span> larger and note the newly computed long-term number of people who become sick in the model. Try this for multiple values of <span class="process-math">\(\kappa\text{.}\)</span> What pattern(s) do you observe?</div>
</li>
<li><div class="para">Continue the Python investigation of different values of <span class="process-math">\(\kappa\text{.}\)</span> Start with <span class="process-math">\(\kappa = 0.1\text{,}\)</span> then run the model with <span class="process-math">\(\kappa = 0.2\text{,}\)</span> <span class="process-math">\(\kappa = 0.3\text{,}\)</span> and so on, up to <span class="process-math">\(\kappa = 1.0\text{.}\)</span> Describe how the <span class="process-math">\(E(t)\)</span> curve changes as <span class="process-math">\(\kappa\)</span> goes through these changes. Notice that you can focus in on the <span class="process-math">\(E(t)\)</span> curve by commenting out the other three solution curves, similarly to how we did in <a href="ch-vaccines.html#activity-pcrit2" class="xref" data-knowl="./knowl/xref/activity-pcrit2.html" data-reveal-label="Reveal" data-close-label="Close" title="Activity 6.3">Activity 6.3</a>.</div></li>
</ol> <pre id="activity-seir-model-play-with-kappa-1-3" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">#Import packages
import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import odeint

plt.cla() #Clear (delete) any past plots

#Define the system of differential equations, and call it "model"
def model(y, t):
  S, E, I, R = y #Define y as consisting of S, E, I, and R, in that order
  dydt = [- beta * S * I, beta * S * I - kappa * E, kappa * E - gamma * I, gamma * I] #Provide the right-hand sides of the SEIR model
  return dydt

beta = 0.0004 #Give a value to beta
kappa = 0.33 #Give a value to kappa
gamma = 0.2 #Give a value to gamma
y0 = [1997, 0, 3, 0] #Set initial conditions for S, E, I, and R, in that order
t_range = np.arange(0.0, 80.0, 0.1) #Set the time range and increment of time steps to be used for numerically solving

sol = odeint(model, y0, t_range) #Give the name "sol" to the lists of numerical values in the solution, and give "odeint" the information needed to solve

# Tell Python to print the last values produced of S, I, and R, to help show long-range outcomes of the model
print("Long-term value of S = ", round(sol[-1,0]))
print("Long-term value of E = ", round(sol[-1,1]))
print("Long-term value of I = ", round(sol[-1,2]))
print("Long-term value of R = ", round(sol[-1,3]))

# Plotting commands are below
plt.plot(t_range, sol[:, 0], color='blue', linewidth=2, label='S(t)')
plt.plot(t_range, sol[:, 1], color='magenta', linestyle='dotted', linewidth=2, label='E(t)')
plt.plot(t_range, sol[:, 2], color='orange', linestyle='dashed', linewidth=2, label='I(t)')
plt.plot(t_range, sol[:, 3], color='teal', linestyle='dashdot', linewidth=2, label='R(t)')
plt.legend()
plt.grid()
plt.xlabel('time')
plt.ylabel('populations')
plt.show()
</script></pre>
<div class="solutions"><details class="answer solution-like born-hidden-knowl"><summary class="knowl__link"><span class="type">Answer</span><span class="period">.</span></summary><div class="answer solution-like knowl__content"><ol class="decimal" id="activity-seir-model-play-with-kappa-2-1">
<li>
<div class="para">As in the SIR model: the <span class="process-math">\(S(t)\)</span> curve can only fall or remain level. The <span class="process-math">\(I(t)\)</span> curve can both rise and fall, and can remain level. The <span class="process-math">\(R(t)\)</span> curve can only rise or remain level.</div>
<div class="para">Sign analysis of the SEIR model shows that the <span class="process-math">\(E(t)\)</span> curve has the possibilities of both rising and falling, as well as remaining level.</div>
</li>
<li><div class="para">You should observe that regardless of the value of <span class="process-math">\(\kappa\text{,}\)</span> the long-term value of <span class="process-math">\(R(t)\)</span> is 1960, given the other default values in the Python code. There are many additional observations you can make about the dynamics of how the population reaches its long-term values, and the next part of this Activity addresses several such observations.</div></li>
<li>
<div class="para">As <span class="process-math">\(\kappa\)</span> increases, the <span class="process-math">\(E(t)\)</span> curve tends to reach lower and lower peak values, and these peak values occur at earlier times <span class="process-math">\(t\text{.}\)</span> Sample <span class="process-math">\(E(t)\)</span> curves, with their <span class="process-math">\(\kappa\)</span> values, appear in the graph below.</div>
<figure class="figure figure-like"><div class="image-box" style="width: 90%; margin-left: 5%; margin-right: 5%;"><img src="external/SEIR_Ecurve_varying_kappa.png" class="contained" alt="Solution curves for the E compartment in the SEIR model, each with a different value of kappa, ranging from kappa = 0.1 to kappa = 1.0. As kappa increases, the curves have lower peaks, and the peaks occur at earlier times"></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">7.4<span class="period">.</span></span><span class="space"> </span>Possible <span class="process-math">\(E(t)\)</span> curves for the SEIR model, with <span class="process-math">\(\kappa\)</span> varying</figcaption></figure>
</li>
</ol></div></details></div></article><span class="incontext"><a class="internal" href="ch-incubation-periods.html#activity-seir-model-play-with-kappa">in-context</a></span>
</body>
</html>
