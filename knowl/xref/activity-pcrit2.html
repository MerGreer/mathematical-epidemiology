<!DOCTYPE html>
<html lang="en-US" dir="ltr">
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex, nofollow">
<script>// Make *any* pre with class 'sagecell-sage' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({
  "inputLocation": "pre.sagecell-sage",
  "linked": true,
  "linkKey": "linked-sage",
  "autoeval": false,
  "languages": [
    "sage"
  ],
  "evalButtonText": "Evaluate (Sage)"
});
</script>
</head>
<body class="ignore-math">
<article class="activity project-like"><h4 class="heading">
<span class="type">Activity</span><span class="space"> </span><span class="codenumber">6.3</span><span class="period">.</span>
</h4>
<div class="para">For the following SIR model, the term <span class="process-math">\((1-p)\)</span> indicates the unvaccinated fraction of people:</div>
<div class="displaymath process-math">
\begin{align*}
\frac{dS}{dt} \amp = - (1-p) \beta S I \\
\frac{dI}{dt} \amp =  (1-p) \beta S I - \gamma I \\
\frac{dR}{dt} \amp = \gamma I. 
\end{align*}
</div>
<div class="para">In the default Python code shown below, <span class="process-math">\(\beta = 0.0003\text{,}\)</span> <span class="process-math">\(\gamma = 0.3\text{,}\)</span> <span class="process-math">\(p=0\text{,}\)</span> the initial population values are <span class="process-math">\(S(0)=2900\text{,}\)</span> <span class="process-math">\(I(0)=100\text{,}\)</span> and <span class="process-math">\(R(0)=0\text{,}\)</span> and time runs from <span class="process-math">\(t=0\)</span> to <span class="process-math">\(t=25\)</span> days. Begin by running the code, and then work through the steps below to make specific changes to the model.</div> <pre id="activity-pcrit2-1-4" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">#Import packages
import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import odeint

plt.cla() #Clear (delete) any past plots

#Define the system of differential equations, and call it "model"
def model(y, t):
  S, I, R = y #Define y as consisting of S, I, and R, in that order
  dydt = [- (1-p) * beta * S * I, (1-p) * beta * S * I - gamma * I, gamma * I] #Provide the right-hand sides of the SIR model
  return dydt

beta = 0.0003 #Give a value to beta
gamma = 0.3 #Give a value to gamma
p = 0.0 #Give a value to p
y0 = [2900, 100, 0] #Set initial conditions for S, I, and R, in that order
t_range = np.arange(0.0, 25.0, 0.1) #Set the time range and increment of time steps to be used for numerically solving

sol = odeint(model, y0, t_range) #Give the name "sol" to the lists of numerical values in the solution, and give "odeint" the information needed to solve

# Tell Python to print the last values produced of S, I, and R, to help show long-range outcomes of the model
print("Long-term value of S = ", round(sol[-1,0]))
print("Long-term value of I = ", round(sol[-1,1]))
print("Long-term value of R = ", round(sol[-1,2]))


# Plotting commands are below
plt.plot(t_range, sol[:, 0], color='blue', linewidth=2, label='S(t)')
plt.plot(t_range, sol[:, 1], color='orange', linestyle='dashed', linewidth=2, label='I(t)')
plt.plot(t_range, sol[:, 2], color='teal', linestyle='dashdot', linewidth=2, label='R(t)')
plt.legend()
plt.grid()
plt.xlabel('time')
plt.ylabel('populations')
plt.show()
</script></pre> <ol class="decimal" id="activity-pcrit2-1-5">
<li><div class="para">How many people have had this illness at some point in time, according to this model with its default values? To answer this: notice that everyone who reaches the R compartment must have been sick at some time, so the long-term value of <span class="process-math">\(R(t)\)</span> provides the answer. Also notice that we need to make sure to run the model long enough that <span class="process-math">\(I(t)\)</span> reaches <span class="process-math">\(0\text{.}\)</span> Only then will <span class="process-math">\(R(t)\)</span> be evaluated at a large enough value of <span class="process-math">\(t\)</span> for us to know the total number of people who become ill.</div></li>
<li><div class="para">Compute the value <span class="process-math">\(p_{\text{crit}}\)</span> for this model, showing your work. Then run the model using the value you computed for <span class="process-math">\(p_{\text{crit}}\)</span> and re-answer the question above: how many people get the illness at some point in time, according to this model, when <span class="process-math">\(p=p_{\text{crit}}\text{?}\)</span>
</div></li>
<li><div class="para">Compare your answer above, regarding how many people get the illness at some time in the situation when <span class="process-math">\(p=p_{\text{crit}}\text{,}\)</span> with the initial number of Infectious people in the model. How many people must have gotten the illness sometime after the original Infectious people? Notice that this means that even when <span class="process-math">\(\mathcal{R}_{\text{eff}} \approx 1\text{,}\)</span> a significant number of additional people can contract the illness being studied. However, the Infectious population curve <span class="process-math">\(I(t)\)</span> does not rise: it instead appears as level or decreasing.</div></li>
<li><div class="para">We may want to see for ourselves, or demonstrate to others, that the Infectious curve is truly not rising when <span class="process-math">\(p=p_{\text{crit}}\text{.}\)</span> The default graph in the Python code for this activity is not the most helpful to us because <span class="process-math">\(S(0)\)</span> is so large relative to <span class="process-math">\(I(0)\text{,}\)</span> which makes it challenging to see the details of the curvature of the <span class="process-math">\(I(t)\)</span> curve. To see <em class="emphasis">just</em> the <span class="process-math">\(I(t)\)</span> curve, then, we can comment out the lines of code that show the <span class="process-math">\(S(t)\)</span> and <span class="process-math">\(R(t)\)</span> curves. Do this: comment out those lines, and produce a graph showing just the <span class="process-math">\(I(t)\)</span> curve.</div></li>
</ol>
<div class="solutions"><details class="answer solution-like born-hidden-knowl"><summary class="knowl__link"><span class="type">Answer</span><span class="period">.</span></summary><div class="answer solution-like knowl__content"><ol class="decimal" id="activity-pcrit2-2-1">
<li><div class="para">The default model says the long-term value of <span class="process-math">\(R(t)\)</span> is <span class="process-math">\(2802\text{,}\)</span> but at <span class="process-math">\(t=25\text{,}\)</span> there are still people in the <span class="process-math">\(I(t)\)</span> compartment. Use a larger value of <span class="process-math">\(t\)</span> to find that <span class="process-math">\(2829\)</span> people have the illness at some time during the outbreak. (State, and show, how large you made your value of <span class="process-math">\(t\text{.}\)</span>)</div></li>
<li><div class="para">The value of <span class="process-math">\(p_{\text{crit}}\)</span> is <span class="process-math">\(0.\overline{6}\text{,}\)</span> using <a href="ch-model-analysis-and-the-basic-reproduction-number-R0.html#sec-the-basic-reproduction-number-R0-12" class="xref" data-knowl="./knowl/xref/eq-R0-sir.html" data-reveal-label="Reveal" data-close-label="Close" title="Equation 5.1">(5.1)</a> to compute <span class="process-math">\(\mathcal{R}_0\)</span> and then <a href="ch-vaccines.html#sec-determining-a-threshold-vaccine-level-11" class="xref" data-knowl="./knowl/xref/eq-pcrit.html" data-reveal-label="Reveal" data-close-label="Close" title="Equation 6.2">(6.2)</a> to compute <span class="process-math">\(p_{\text{crit}}\text{.}\)</span> Approximating <span class="process-math">\(p_{\text{crit}}\)</span> as <span class="process-math">\(0.67\)</span> and setting a large enough value of <span class="process-math">\(t\)</span> leads to the conclusion that <span class="process-math">\(692\)</span> total people have the illness at some time.</div></li>
<li><div class="para">The answer above said that <span class="process-math">\(692\)</span> people had the illness at some time, and we used the value <span class="process-math">\(I(0)=100\text{.}\)</span> This means that after the initial <span class="process-math">\(100\)</span> people, another <span class="process-math">\(592\)</span> got the illness. (For readers who approximated <span class="process-math">\(0.\overline{6}\)</span> differently than <span class="process-math">\(0.67\text{,}\)</span> your answers may vary somewhat.)</div></li>
<li><div class="para">The first and third lines after “#Plotting commands are below” should be commented out, that is, the symbol “#” should be placed at the start of each of these lines. Then run the code block again to produce just the <span class="process-math">\(I(t)\)</span> graph.</div></li>
</ol></div></details></div></article><span class="incontext"><a class="internal" href="ch-vaccines.html#activity-pcrit2">in-context</a></span>
</body>
</html>
