<!DOCTYPE html>
<html lang="en-US" dir="ltr">
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex, nofollow">
<script>// Make *any* pre with class 'sagecell-sage' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({
  "inputLocation": "pre.sagecell-sage",
  "linked": true,
  "linkKey": "linked-sage",
  "autoeval": false,
  "languages": [
    "sage"
  ],
  "evalButtonText": "Evaluate (Sage)"
});
</script>
</head>
<body class="ignore-math">
<article class="activity project-like"><h4 class="heading">
<span class="type">Activity</span><span class="space"> </span><span class="codenumber">6.3</span><span class="period">.</span>
</h4>
<div class="para">Investigate different outcomes for the following SIR model when the number of initial Susceptible and initial Removed people varies according to the value <span class="process-math">\(p\text{,}\)</span> where <span class="process-math">\(0 \leq p \leq 1\text{:}\)</span>
</div>
<div class="displaymath process-math">
\begin{align*}
\frac{dS}{dt} \amp = - \beta S I \\
\frac{dI}{dt} \amp =  \beta S I - \gamma I \\
\frac{dR}{dt} \amp = \gamma I. 
\end{align*}
</div>
<div class="para">In the default Python code shown below, <span class="process-math">\(\beta = 0.0003\text{,}\)</span> <span class="process-math">\(\gamma = 0.3\text{,}\)</span> <span class="process-math">\(p=0\text{,}\)</span> the initial population values are <span class="process-math">\(S(0)=2999\text{,}\)</span> <span class="process-math">\(I(0)=1\text{,}\)</span> and <span class="process-math">\(R(0)=0\text{,}\)</span> and time runs from <span class="process-math">\(t=0\)</span> to <span class="process-math">\(t=50\)</span> days. When the value of <span class="process-math">\(p\)</span> changes in line 16, then the initial values <span class="process-math">\(S(0)\)</span> and <span class="process-math">\(R(0)\)</span> change accordingly, with <span class="process-math">\(S(0)=2999(1-p)\)</span> and <span class="process-math">\(R(0)=2999p\text{.}\)</span>
</div> <div class="para">When the code is run, most population values are rounded to the nearest whole number, but the long-term value for <span class="process-math">\(I(t)\)</span> is not rounded. (To stop rounding other population values, you can delete the word <code class="code-inline tex2jax_ignore">round</code> at appropriate places in the code.) Begin by running the code, and then work through the steps below to make specific changes to the model.</div> <pre id="activity-pcrit2-1-5" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">#Import packages
import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import odeint

plt.cla() #Clear (delete) any past plots

#Define the system of differential equations, and call it "model"
def model(y, t):
  S, I, R = y #Define y as consisting of S, I, and R, in that order
  dydt = [- beta * S * I, beta * S * I - gamma * I, gamma * I] #Provide the right-hand sides of the SIR model
  return dydt

beta = 0.0003 #Give a value to beta
gamma = 0.3 #Give a value to gamma
p = 0.0 #Give a value to p
y0 = [2999*(1-p), 1, 2999*p] #Set initial conditions for S, I, and R, in that order
t_range = np.arange(0.0, 50.0, 0.1) #Set the time range and increment of time steps to be used for numerically solving

sol = odeint(model, y0, t_range) #Give the name "sol" to the lists of numerical values in the solution, and give "odeint" the information needed to solve

# Tell Python to print the initial values of S, I, and R
print("Initial value of S = ", round(y0[0]))
print("Initial value of I = ", round(y0[1]))
print("Initial value of R = ", round(y0[2]))

# Tell Python to print the last values produced of S, I, and R, to help show long-range outcomes of the model
print("Long-term value of S = ", round(sol[-1,0]))
print("Long-term value of I = ", (sol[-1,1]))
print("Long-term value of R = ", round(sol[-1,2]))

# Plotting commands are below
plt.plot(t_range, sol[:, 0], color='blue', linewidth=2, label='S(t)')
plt.plot(t_range, sol[:, 1], color='orange', linestyle='dashed', linewidth=2, label='I(t)')
plt.plot(t_range, sol[:, 2], color='teal', linestyle='dashdot', linewidth=2, label='R(t)')
plt.legend()
plt.grid()
plt.xlabel('time')
plt.ylabel('populations')
plt.show()
</script></pre> <ol class="decimal" id="activity-pcrit2-1-6">
<li>
<div class="para">When <span class="process-math">\(p=0\text{,}\)</span> how many people have this illness at some point in time, according to this model with its default values? To answer this: notice that everyone who reaches the R compartment, but was not there at the start, must have been sick at some time. We therefore subtract the initial number of people in the R compartment from the long-term value of <span class="process-math">\(R(t)\)</span> to reach our answer. Also notice that we need to make sure to run the model long enough that <span class="process-math">\(I(t)\)</span> becomes very close to <span class="process-math">\(0\text{.}\)</span> Only then will long-term <span class="process-math">\(R(t)\)</span> be evaluated at a large enough value of <span class="process-math">\(t\)</span> for us to know the total number of people who become ill.</div>
<div class="para">(This is a situation where the exact outcome of an outbreak, where eventually we have <span class="process-math">\(0\)</span> Infectious people, will be merely approximated in a simulation. The <span class="process-math">\(I(t)\)</span> curve approaches <span class="process-math">\(0\)</span> as an asymptote, but looking out to many decimal places, we see that <span class="process-math">\(I(t)\)</span> remains slightly above <span class="process-math">\(0\)</span> for a long while.)</div>
</li>
<li>
<div class="para">Compute the value <span class="process-math">\(p_{\text{crit}}\)</span> for this model, showing your work. Then run the Python code above, replacing the value of <span class="process-math">\(p\)</span> in line 16 with the value you computed for <span class="process-math">\(p_{\text{crit}}\text{,}\)</span> and determine how many people get the illness at some point in time, according to this model, when <span class="process-math">\(p=p_{\text{crit}}\text{.}\)</span>
</div>
<div class="para">As part of your response, show how you determined the long-term value of <span class="process-math">\(R(t)\)</span> by demonstrating at least three different estimates for <span class="process-math">\(R(t)\)</span> at different values of <span class="process-math">\(t\text{.}\)</span> For each of these estimates, state the value of <span class="process-math">\(I(t)\)</span> as well, to give a sense of how small <span class="process-math">\(I(t)\)</span> is becoming as you estimate the long-term total number of people in the Removed compartment.</div>
</li>
<li><div class="para">Now think about how many people from the S compartment get the illness, even though <span class="process-math">\(p=p_{\text{crit}}\text{.}\)</span> To answer this, subtract the long-term value of <span class="process-math">\(S(t)\)</span> from the initial value <span class="process-math">\(S(0)\text{.}\)</span> Notice that your answer tells you that that even when <span class="process-math">\(\mathcal{R}_{\text{eff}} \approx 1\text{,}\)</span> additional people can contract the illness being studied. However, the Infectious population curve <span class="process-math">\(I(t)\)</span> does not rise: it instead appears as level or decreasing.</div></li>
<li><div class="para">Be sure to check, and be able to demonstrate to others, that the Infectious curve is truly not rising when <span class="process-math">\(p=p_{\text{crit}}\text{.}\)</span> The default graph in the Python code for this activity makes it challenging to see the details of the <span class="process-math">\(I(t)\)</span> curve because <span class="process-math">\(S(0)\)</span> is so large relative to <span class="process-math">\(I(0)\text{.}\)</span> To see <em class="emphasis">just</em> the <span class="process-math">\(I(t)\)</span> curve, then, we can comment out the lines of code that show the <span class="process-math">\(S(t)\)</span> and <span class="process-math">\(R(t)\)</span> curves. Do this: place the symbol <code class="code-inline tex2jax_ignore">#</code> at the start of each of those lines. Then evaluate the code and display a graph showing just the <span class="process-math">\(I(t)\)</span> curve.</div></li>
</ol>
<div class="solutions"><details class="answer solution-like born-hidden-knowl"><summary class="knowl__link"><span class="type">Answer</span><span class="period">.</span></summary><div class="answer solution-like knowl__content"><ol class="decimal" id="activity-pcrit2-2-1">
<li>
<div class="para">The given Python model, with <span class="process-math">\(p=0\text{,}\)</span> says the long-term value of <span class="process-math">\(R(t)\)</span> is <span class="process-math">\(2821\text{,}\)</span> and we have set the initial value <span class="process-math">\(R(0)\)</span> to equal <span class="process-math">\(0\text{.}\)</span> At <span class="process-math">\(t=50\text{,}\)</span> the value of <span class="process-math">\(I(t)\)</span> is approximately <span class="process-math">\(0.326\text{,}\)</span> so it is a good idea to let the simulation run longer to see how much <span class="process-math">\(R(t)\)</span> is still changing. We therefore increase the value <code class="code-inline tex2jax_ignore">50.0</code> in line 18. Trying <span class="process-math">\(t=100\text{,}\)</span> we see that <span class="process-math">\(I(100) \approx 1.45 \times 10^{-6}\text{,}\)</span> which is a quite small value for <span class="process-math">\(I(t)\text{.}\)</span> At this time, <span class="process-math">\(R(100)=2822\text{.}\)</span> We therefore estimate that <span class="process-math">\(2822\)</span> total people get this illness.</div>
<div class="para">It is worth mentioning that different people may estimate different values for the number of people who get an illness, due to using different lengths of time for checking the model. There is not a universal standard for how long a time span to check, or for how small <span class="process-math">\(I(t)\)</span> should be before we stop checking. It is therefore helpful to state the start and end times used, along with other information about how you, as a modeler, believe you have determined a solid estimate.</div>
</li>
<li><div class="para">The value of <span class="process-math">\(p_{\text{crit}}\)</span> is <span class="process-math">\(0.\overline{6}\text{,}\)</span> using <a href="ch-model-analysis-and-the-basic-reproduction-number-R0.html#sec-the-basic-reproduction-number-R0-13" class="xref" data-knowl="./knowl/xref/eq-R0-sir.html" data-reveal-label="Reveal" data-close-label="Close" title="Equation 5.1">(5.1)</a> to compute <span class="process-math">\(\mathcal{R}_0\)</span> and then <a href="ch-vaccines.html#sec-determining-a-threshold-vaccine-level-11" class="xref" data-knowl="./knowl/xref/eq-pcrit.html" data-reveal-label="Reveal" data-close-label="Close" title="Equation 6.2">(6.2)</a> to compute <span class="process-math">\(p_{\text{crit}}\text{.}\)</span> One option is to approximate <span class="process-math">\(p_{\text{crit}}\)</span> as <span class="process-math">\(0.67\text{.}\)</span> The initial value <span class="process-math">\(R(0)=2009\)</span> means 2009 people start in the Removed compartment, due to being vaccinated. Making the value of <span class="process-math">\(t\)</span> larger may lead to estimates larger than 2040 for the long-term value of <span class="process-math">\(R(t)\text{.}\)</span> Using one such estimate: if there are 2045 people eventually in the R compartment, then <span class="process-math">\(2045-2009=36\)</span> people got the illness.</div></li>
<li><div class="para">In a model simulation where <span class="process-math">\(R(0)=2009\text{,}\)</span> we see that <span class="process-math">\(S(0)=990\text{.}\)</span> Carrying out this simulation long enough that the long-term value <span class="process-math">\(R(t)\)</span> is <span class="process-math">\(2045\text{,}\)</span> we see that the long-term value of <span class="process-math">\(S(t)\)</span> is <span class="process-math">\(955\text{.}\)</span> This means that <span class="process-math">\(990-955=35\)</span> people began in the S compartment but did not stay there. In other words, 35 people acquired the illness.</div></li>
<li><div class="para">The first and third lines after “#Plotting commands are below” should be commented out, that is, the symbol “#” should be placed at the start of lines 33 and 35. Then run the code block again to produce just the <span class="process-math">\(I(t)\)</span> graph.</div></li>
</ol></div></details></div></article><span class="incontext"><a class="internal" href="ch-vaccines.html#activity-pcrit2">in-context</a></span>
</body>
</html>
