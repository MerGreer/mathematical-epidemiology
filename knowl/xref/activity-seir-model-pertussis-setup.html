<!DOCTYPE html>
<html lang="en-US" dir="ltr">
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex, nofollow">
<script>// Make *any* pre with class 'sagecell-sage' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({
  "inputLocation": "pre.sagecell-sage",
  "linked": true,
  "linkKey": "linked-sage",
  "autoeval": false,
  "languages": [
    "sage"
  ],
  "evalButtonText": "Evaluate (Sage)"
});
</script>
</head>
<body class="ignore-math">
<article class="activity project-like"><h4 class="heading">
<span class="type">Activity</span><span class="space"> </span><span class="codenumber">7.4</span><span class="period">.</span>
</h4>
<div class="para">We are now ready to set up a compartmental model for whooping cough, also called pertussis, in a fictional town having 10,000 residents, using information from the <a class="external" href="https://www.health.ny.gov/publications/2171/" target="_blank">New York State Pertussis or Whooping Cough Fact Sheet</a><details class="ptx-footnote" aria-live="polite" id="activity-seir-model-pertussis-setup-1-1-2"><summary class="ptx-footnote__number" title="Footnote 7.1"><sup> 1 </sup></summary><div class="ptx-footnote__contents" id="activity-seir-model-pertussis-setup-1-1-2"><code class="code-inline tex2jax_ignore">www.health.ny.gov/publications/2171/</code></div></details>. The fact sheet says that the first stage of pertussis, in which symptoms are similar to those of a cold, lasts one to two weeks. Stage two, which includes the severe cough that gave pertussis the name “whooping cough”, lasts one to two months. The fact sheet also says that pertussis is contagious from the time cold symptoms appear until about three weeks after severe cough starts. The incubation period for pertussis is most often seven to ten days: the incubation period can sometimes be longer, but we focus on the most common lengths of time. We will not include the use of antibiotics in this model.</div> <ol class="decimal" id="activity-seir-model-pertussis-setup-1-2">
<li>
<div class="para">Use the SEIR model below. Determine as many parameter values as you can, using the information described from the fact sheet. In this model, assume that time is measured in days. It is appropriate for some parameter values to be a range of numbers, rather than a single number, since the fact sheet information includes ranges of time.</div>
<div class="displaymath process-math">
\begin{align*}
\frac{dS}{dt} \amp = - \beta S I \\
\frac{dE}{dt} \amp =  \beta S I - \kappa E \\
\frac{dI}{dt} \amp =  \kappa E - \gamma I \\
\frac{dR}{dt} \amp = \gamma I. 
\end{align*}
</div>
</li>
<li><div class="para">You should now have determined the range of values for all parameters except <span class="process-math">\(\beta\text{.}\)</span> Here is extra information: the value of <span class="process-math">\(\mathcal{R}_0\)</span> for pertussis has been estimated at anywhere from 5.5 to 17, depending on the outbreak in which <span class="process-math">\(\mathcal{R}_0\)</span> was measured.<details class="ptx-footnote" aria-live="polite" id="activity-seir-model-pertussis-setup-1-2-2-1-4"><summary class="ptx-footnote__number" title="Footnote 7.2"><sup> 2 </sup></summary><div class="ptx-footnote__contents" id="activity-seir-model-pertussis-setup-1-2-2-1-4">A nice summary of studies of <span class="process-math">\(\mathcal{R}_0\)</span> for pertussis appears in “Pertussis: Microbiology, Disease, Treatment, and Prevention” by Paul E. Kilgore, Abdulbaset M. Salim, Marcus J. Zervos, Heinz-Josef Schmitt, published in <em class="emphasis">Clinical Microbiology Reviews</em> in on March 30, 2016.</div></details> Use this range of values of <span class="process-math">\(\mathcal{R}_0\text{,}\)</span> along with the parameters you already determined and the formula in <a href="ch-incubation-periods.html#sec-including-an-incubation-period-the-seir-model-14" class="xref" data-knowl="./knowl/xref/eq-R0-seir.html" data-reveal-label="Reveal" data-close-label="Close" title="Equation 7.3">(7.3)</a> for <span class="process-math">\(\mathcal{R}_0\text{,}\)</span> to solve for <span class="process-math">\(\beta\text{.}\)</span>
</div></li>
<li><div class="para">Run the Python code below, making sure to first enter the values from the parameter ranges you have computed for <span class="process-math">\(\mathcal{R}_0\text{,}\)</span> <span class="process-math">\(\kappa\text{,}\)</span> and <span class="process-math">\(\gamma\text{.}\)</span> (These parameter values are set to 0 in the code, so visualizing the model requires you to enter the values you determine.) Notice that the code will compute the appropriate value of <span class="process-math">\(\beta\text{,}\)</span> using the total population of 10,000 and the values you assign to <span class="process-math">\(\mathcal{R}_0\)</span> and <span class="process-math">\(\gamma\text{.}\)</span> Make observations about the outcomes of the model. Be sure to adjust the length of time the model runs, or to show just one or two solution curves at a time, or to otherwise alter the code so that you can best see and comment on the results of the model.</div></li>
</ol> <pre id="activity-seir-model-pertussis-setup-1-3" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">#Import packages
import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import odeint

plt.cla() #Clear (delete) any past plots

#Define the system of differential equations, and call it "model"
def model(y, t):
  S, E, I, R = y #Define y as consisting of S, E, I, and R, in that order
  dydt = [- beta * S * I, beta * S * I - kappa * E, kappa * E - gamma * I, gamma * I] #Provide the right-hand sides of the SEIR model
  return dydt

# The parameter values below are set to 0.0. Enter the values you have computed to see how the model proceeds
R0 = 0.0 #Give a value to R0
kappa = 0.0 #Give a value to kappa
gamma = 0.0 #Give a value to gamma
S_init = 9995 #Give an initial value to population S
E_init = 0 #Give an initial value to population E
I_init = 5 #Give an initial value to population I
R_init = 0 #Give an initial value to population R
beta = R0 * gamma / (S_init + E_init + I_init + R_init) #Solve for beta, using the R0 formula
y0 = [S_init, E_init, I_init, R_init] #Put initial conditions for S, E, I, and R into "y0" for use below in "odeint"

# The time range below is set for one year. Make it longer or shorter, as needed, to better see the full dynamics of the model
t_range = np.arange(0.0, 365.0, 0.1) #Set the time range and increment of time steps to be used for numerically solving

sol = odeint(model, y0, t_range) #Give the name "sol" to the lists of numerical values in the solution, and give "odeint" the information needed to solve

# Tell Python to print the last values produced of S, I, and R, to help show long-range outcomes of the model
print("Long-term value of S = ", round(sol[-1,0]))
print("Long-term value of E = ", round(sol[-1,1]))
print("Long-term value of I = ", round(sol[-1,2]))
print("Long-term value of R = ", round(sol[-1,3]))

# Plotting commands are below
plt.plot(t_range, sol[:, 0], color='blue', linewidth=2, label='S(t)')
plt.plot(t_range, sol[:, 1], color='magenta', linestyle='dotted', linewidth=2, label='E(t)')
plt.plot(t_range, sol[:, 2], color='orange', linestyle='dashed', linewidth=2, label='I(t)')
plt.plot(t_range, sol[:, 3], color='teal', linestyle='dashdot', linewidth=2, label='R(t)')
plt.legend()
plt.grid()
plt.xlabel('time')
plt.ylabel('populations')
plt.show()
</script></pre>
<div class="solutions"><details class="answer solution-like born-hidden-knowl"><summary class="knowl__link"><span class="type">Answer</span><span class="period">.</span></summary><div class="answer solution-like knowl__content"><ol class="decimal" id="activity-seir-model-pertussis-setup-2-1">
<li>
<div class="para">The incubation period is usually 7 to 10 days, so <span class="process-math">\(\kappa\)</span> is in the range <span class="process-math">\(\frac{1}{10}- \frac{1}{7}\text{.}\)</span> (The incubation period can be shorter or longer, and if you included this information, you will have a wider range of values for <span class="process-math">\(\kappa\text{.}\)</span> This is also valid.)</div>
<div class="para">Pertussis begins to be contagious when cold symptoms appear, and the phase for cold symptoms is one to two weeks. Pertussis is most contagious for up to three weeks after the intense coughing phase begins. Adding these phases together, pertussis is contagious, or most contagious, for four to five weeks, meaning 28 to 35 days. So <span class="process-math">\(\gamma\)</span> is in the range <span class="process-math">\(\frac{1}{35}- \frac{1}{28}\text{.}\)</span> (Saying “up to” three weeks suggests people may not be contagious the full three weeks. And pertussis may be contagious, at a lower level, more than three weeks after severe cough begins. You may have built either of these facts into your answer, which may lead to a different answer.)</div>
</li>
<li><div class="para">Rearranging <a href="ch-incubation-periods.html#sec-including-an-incubation-period-the-seir-model-14" class="xref" data-knowl="./knowl/xref/eq-R0-seir.html" data-reveal-label="Reveal" data-close-label="Close" title="Equation 7.3">(7.3)</a> leads to <span class="process-math">\(\beta = \gamma \mathcal{R}_0 / N\text{.}\)</span> Using the range of values <span class="process-math">\(5.5 \leq \mathcal{R}_0 \leq 17\)</span> and <span class="process-math">\(\frac{1}{35} \leq \gamma \leq \frac{1}{28}\text{,}\)</span> along with <span class="process-math">\(N = 10,000\text{,}\)</span> gives the range of values <span class="process-math">\(0.000157 \leq \beta \leq 0.000607\text{.}\)</span> Your range of <span class="process-math">\(\beta\)</span> values should be based on the parameter values you determined.</div></li>
<li><div class="para">This is open-ended. Make as many observations as you can.</div></li>
</ol></div></details></div></article><span class="incontext"><a class="internal" href="ch-incubation-periods.html#activity-seir-model-pertussis-setup">in-context</a></span>
</body>
</html>
