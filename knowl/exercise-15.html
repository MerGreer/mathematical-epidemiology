<!DOCTYPE html>
<html lang="en-US">
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex, nofollow">
<script>// Make *any* pre with class 'sagecell-sage' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({inputLocation: 'pre.sagecell-sage',
                       linked: true,
                       languages: ['sage'],
                       evalButtonText: 'Evaluate (Sage)'});
</script>
</head>
<body class="ignore-math">
<article class="exercise exercise-like"><h4 class="heading">
<span class="type">Exercise</span><span class="space"> </span><span class="codenumber">3<span class="period">.</span></span>
</h4>
<div class="para">Most diseases we know of have <span class="process-math">\(\mathcal{R}_0 \gt 1\text{.}\)</span> This makes sense: without rising numbers of Infectious people, we do not experience an epidemic. However, in rare cases, a disease emerges for which <span class="process-math">\(\mathcal{R}_0 \lt 1\text{.}\)</span> One example is MERS, which stands for Middle East Respiratory Syndrome. The first identified case of MERS was in 2012. There is still a lot to learn about MERS, but multiple estimates indicate that the value of <span class="process-math">\(\mathcal{R}_0\)</span> for MERS is less than one.</div>
<div class="para">This activity is motivated by the existence of diseases with <span class="process-math">\(\mathcal{R}_0 \lt 1\text{.}\)</span> Suppose we study a disease for which <span class="process-math">\(\mathcal{R}_0 \approx 0.5\)</span> and <span class="process-math">\(\gamma = 0.1\text{,}\)</span> that is, people are typically infectious for about ten days. Suppose we choose to model this disease with an SIR model similar to the models we have been using in this chapter: “S” stands for Susceptible, meaning people who are not sick but can become sick; “I” stands for Infectious, meaning people who are currently able to spread the disease, and “R stands for” Removed, meaning people who are no longer able to spread the disease and are unable to become sick again. In the case of a disease similar to MERS, the Removed compartment consists of both recoveries and deaths from the disease.</div>
<ol class="lower-alpha">
<li><div class="para">In an area with a population of 1000, use <a href="" class="xref" data-knowl="./knowl/eq-R0-sir.html" title="Equation 5.1">(5.1)</a> to solve for the value of <span class="process-math">\(\beta\)</span> for this SIR model.</div></li>
<li>
<div class="para">Suppose that at the start of the outbreak, 20 people are Infectious. Use the Python block below to visualize the outbreak over 200 days. Notice that the Python block includes three <code class="code-inline tex2jax_ignore">print</code> commands. These print and label the last output values stored as <code class="code-inline tex2jax_ignore">sol</code>, that is, the <span class="process-math">\(S(t)\text{,}\)</span> <span class="process-math">\(I(t)\text{,}\)</span> and <span class="process-math">\(R(t)\)</span> values for the last value of time <span class="process-math">\(t\text{,}\)</span> namely <span class="process-math">\(t=200\text{.}\)</span>
</div>
<div class="para"><em class="emphasis">Use caution: by default, the Python block does not contain the correct value for <span class="process-math">\(\beta\text{.}\)</span> Instead, replace the existing <span class="process-math">\(\beta\)</span> value with the value you computed in part (a).</em></div>
<div class="para">Use the graphs to describe qualitatively what happens in this population that began with 20 Infectious people. Does the curve for the <span class="process-math">\(I(t)\)</span> population begin falling from the very beginning? What happens to the curves for <span class="process-math">\(S(t)\)</span> and <span class="process-math">\(R(t)\text{?}\)</span>
</div>
</li>
<li><div class="para">Incorporate the output from the <code class="code-inline tex2jax_ignore">print</code> command, along with the visual output of the graphs. How many people, in total, were Infectious at some point during the time of this model? How does this compare with the initial 20 cases? How do you reconcile this result with the behavior of the <span class="process-math">\(I(t)\)</span> curve and with the knowledge that <span class="process-math">\(\mathcal{R}_0 \lt 1\)</span> in this model?</div></li>
</ol>
<pre class="ptx-sagecell sagecell-sage" id="sage-9"><script type="text/x-sage">#Import packages
import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import odeint

plt.cla() #Clear (delete) any past plots

#Define the system of differential equations, and call it "model"
def model(y, t):
  S, I, R = y #Define y as consisting of S, I, and R, in that order
  dydt = [-beta * S * I, beta * S * I - gamma * I, gamma * I] #Provide the right-hand sides of the SIR model
  return dydt

#This value for beta is not correct for MERS.
#Instead, use the value you compute in part (a).
beta = 0.01
gamma = 0.1 #Give a value to gamma
y0 = [980, 20, 0] #Set initial conditions for S, I, and R, in that order
t_range = np.arange(0.0, 200.0, 0.1) #Set the time range and increment of time steps to be used for numerically solving

sol = odeint(model, y0, t_range) #Give the name "sol" to the lists of numerical values in the solution, and give "odeint" the information needed to solve

# Tell Python to print the last values produced of S, I, and R, to help show long-range outcomes of the model
print("Long-term value of S = ", round(sol[-1,0]))
print("Long-term value of I = ", round(sol[-1,1]))
print("Long-term value of R = ", round(sol[-1,2]))

# Plotting commands are below
plt.plot(t_range, sol[:, 0], color='blue', linewidth=2, label='S(t)')
plt.plot(t_range, sol[:, 1], color='orange', linestyle='dashed', linewidth=2, label='I(t)')
plt.plot(t_range, sol[:, 2], color='teal', linestyle='dashdot', linewidth=2, label='R(t)')
plt.legend()
plt.grid()
plt.xlabel('time')
plt.ylabel('populations')
plt.show()
</script></pre></article><span class="incontext"><a href="ch-population-values-and-the-basic-reproduction-number-R0.html#exercise-15" class="internal">in-context</a></span>
</body>
</html>
