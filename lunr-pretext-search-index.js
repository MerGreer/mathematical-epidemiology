var ptx_lunr_search_style = "textbook";
var ptx_lunr_docs = [
{
  "id": "colophon-1",
  "level": "1",
  "url": "colophon-1.html",
  "type": "Colophon",
  "number": "",
  "title": "Colophon",
  "body": "  copyright  This book was authored in PreTeXt .  "
},
{
  "id": "preface-overall",
  "level": "1",
  "url": "preface-overall.html",
  "type": "Preface",
  "number": "",
  "title": "Preface",
  "body": " Preface  Welcome to Mathematical Epidemiology and More: A Course on Compartmental Models. It so happens that this book is becoming available well after the start of the global COVID-19 outbreak. During this pandemic, mathematics, data, epidemiology, graphs, models, and charts began appearing in the news and other media at levels beyond what we had ever seen before. To fully appreciate and act on the information in the media, it has been helpful to know first-hand the ways models can be built, used, and misused, and to understand the underlying mathematics involved.  Yet this text's origin lies not in the COVID-19 outbreak, but in the much longer history of mathematical epidemiology. The text builds on a course that has been taught since 2014, and typical students studying these topics pre-2020 had never heard of connections between mathematics and epidemiology. Nearly all students in the course, before and since 2020, have gained their first significant introduction to disease models within this course. Examples of outbreaks we study include measles, Ebola, mumps, and whooping cough.  The approach used throughout this text is to dive into using, then building, disease models. We play with models and discover the ways each model responds to small and large changes. We represent the ideas of models using images, equations, words, graphs, and numbers. Each section centers on one or more activities, and as we work through these activities, we build up knowledge about how to construct and work with mathematical models of disease outbreaks.   Who is the expected audience for this book? The audience I have in mind while writing is a class of undergraduates, studying together, and checking in with their professor along the way. These students have studied at least one semester of calculus, focusing primarily on derivatives as rates of change. It helps for students to also recognize that integrals and derivatives are inverse operations, to know that integrals sum up area under a curve (when all values on the curve are nonnegative), and to be familiar with the idea of computing derivative and antiderivative formulas. Some sections of this text use linear algebra, specifically matrices and eigenvalues. These sections are not required for learning from this book. Or, for students who would like to include these sections but have not studied linear algebra, there is a brief tutorial available.  Though undergraduates are the audience I primarily think about while writing, they are not the only audience. My goal is that anyone with some calculus background will be able to learn about mathematical epidemiology by working through these activities.   Who can teach from this book? My goal is for many teachers and professors of college-level mathematics to feel comfortable teaching from this book. There is no requirement to have taught mathematical modeling before, or to have studied mathematical epidemiology.   What other kinds of math will we use, besides calculus? To do mathematical modeling, we use any math we need. We typically jump into activities and then introduce new mathematical ideas whenever they are helpful. These math ideas come from differential equations, multivariable calculus, linear algebra, numerical analysis, probability, proofs, and more. If you have already studied some of these subjects, you may be able to move more quickly through some of the activities. On the other hand, if you have not yet taken full courses in these subjects, then there will be enough information contained here for you to learn what you need and keep modeling. And, perhaps, you may find that you want to learn more, and that may lead you to study additional areas of mathematics.   What kind(s) of models will we use? For most of this textbook, we use compartmental models, which can be drawn in pictures and written as ordinary differential equations. (It is OK to not know some of the terms in the previous sentence when you start: all will be explained.) Some of these models are called SIR models. We will mention other types of models, but we restrict our focus to compartmental models using ordinary differential equations so that we can fully understand the underlying math ideas, how to use the models, and how to visualize our results.   Do all the models in this text focus only on diseases? Actually, no. The style of modeling we focus on has many other applications. We will investigate several other ways to use these models, including studying the spread of rumors, political party affiliations, and viral YouTube videos.  Thank you for reading this introduction, and I hope you enjoy the book!  Meredith L. Greer  "
},
{
  "id": "preface-students",
  "level": "1",
  "url": "preface-students.html",
  "type": "Preface",
  "number": "",
  "title": "To Students: How to Get the Most from This Text",
  "body": " To Students: How to Get the Most from This Text  Dear students working from this text: I hope you enjoy and learn a lot from these pages! My plan when writing has been to encourage active learning. This means that written explanations are kept to a minimum, and there are lots of chances for you to try things on your own or with other students. The book is filled with applications to real outbreaks; examples inspired by outbreaks; and applications to ideas that do not involve epidemics at all, but that can be represented by similar mathematics as what we use to study diseases. The types of mathematical models studied in this text are used currently in the world, by people making decisions about public policy and for other wide-reaching goals, and I want you to emerge from using this text with a strong sense of what these models can, and cannot, tell us.  The chapters in this text are typically structured in a consistent way.    The Goals of the chapter appear at the very start.    After a brief introduction, an Exploration activity asks you to engage with questions that motivate the rest of the chapter.    The sections within the chapter include some reading for you to do, and Activities appear frequently. It is best if you do these activities when they appear: many activities contain new information, rather than just examples, and later reading will assume you have already completed the activities. Some activities include hints or answers, and you will learn the most by completing as much of the activity as you can before checking the hints or reading the answers.    At the end of each chapter, there are questions For Further Thought that provide deeper insights or additional examples of the chapter's ideas.    The near the end of the book includes descriptions of key terms, along with the chapter in which each term first appears.  There are footnotes in this book, appearing as a raised number. Here is an example of a footnote! In the web version of the book, clicking on the raised number shows the footnote in a box that opens below the paragraph. The web version of the book also contains live links. Some of the links, such as to chapters, take you to different pages of the book. Other links, such as to figures or equations that we saw earlier in the text, open a box showing these figures or equations directly where you are reading, so that you can see them without jumping from webpage to webpage. You will also see Python code boxes in this text, with a button after that says Evaluate (Sage) . In the web version of this text, you can click on the Evaluate (Sage) button to evaluate the code directly within the book.  For readers using an electronic PDF of this book, many things are similar to the web version, but the live links to equations and figures will lead to the original location of those items within the text, rather than opening them within a box within the page you are reading.  For anyone not using the web version of this text, the Python code will not run directly, which requires you to set up some way to run Python on your computer. There are many ways to do this. Suggestions include (and are not limited to): copying the code directly into the box at the top of the page at sagecell.sagemath.org , using Google Colab at colab.research.google.com , or downloading an installation of Python directly from python.org .  Last but not least: I will not tell you how to think. Mathematical modeling involves setting priorities and incorporating personal values, and each person gets to decide these for themselves. This book focuses on the processes of developing and describing models, stating and supporting your assumptions, and understanding and explaining your model's outcomes. The mathematics certainly needs to be correct, and all the processes should be done carefully, but priorities and values are personal.  Thank you for reading!  "
},
{
  "id": "ch-prelude-diseases-in-popular-news",
  "level": "1",
  "url": "ch-prelude-diseases-in-popular-news.html",
  "type": "Chapter",
  "number": "1",
  "title": "Prelude: Diseases in Popular News",
  "body": " Prelude: Diseases in Popular News      Read about an outbreak in a non-scientific article    Begin to look for disease details that can turn into mathematical ideas    Notice the goals and style of writing in a news or popular culture article on an outbreak, and think about how these may be different in a scientific journal article    Prioritize, and build toward a habit of, full-class discussion     Disease outbreaks have been a topic of widespread discussion for a very long time. In this course, we will discuss the scientific study of outbreaks, data sets collected and curated by government officials, and policy ideas for improving public health outcomes. To begin, however, we examine writing in news and popular culture articles about diseases, starting in .   Reading about Disease in the News and Popular Media   The Washington Post is a newspaper with a corresponding website. CNN is a television station and an online news source. People magazine and the corresponding website people.com center on celebrity news and human-interest stories People magazine Wikipedia entry , accessed 15 Nov 2022 .    Read one or more of these suggested articles, which come from the outlets described above.     A tourist infected with measles visited Disneyland and other Southern California hot spots in mid-August , published August 24, 2019, by the Washington Post;     Pandemic immunity gap is probably behind surge in RSV cases, scientists say , published October 28, 2022, by CNN;     Vaccinations a Priority as Measles Cases in the U.S. Number 107 in the First 7 Months of 2018 , published August 16, 2018, by People.      While reading each article, think through the answers to as many of the following questions as you can.    What illness is involved?    How does it spread?    How quickly does it proceed? Consider incubation time, length of sickness, etc.    Is it more prominent in some parts of the world than others?    What does the article say about vaccines, quarantines, isolation, testing, or other approaches to managing this illness?    What mathematical concepts can you find in your article?    The question about mathematical concepts is very open-ended. List any ideas that seem to make sense to you.   hi     Possible Discussion Themes   is very open-ended. The goal of this exploration is to begin discussing outbreaks as they appear in news and popular culture writing. There is no hidden right answer to find.  There are many possible themes that may arise during discussion. Below, you can find a sample of such themes. These may help to expand thoughts and discussions you are already having about the articles. Or it is possible that you discovered yet other themes, beyond those listed here, and this is wonderful!   Theme 1. The diseases in the articles are measles and RSV. Both are highly contagious and spread through coughing and sneezing.   Theme 2. The articles give different kinds of information about the ways measles and RSV can spread. Some of the articles give descriptions that let us estimate incubation period or length of sickness, and some give fewer such descriptions.   Theme 3. Some of the articles describe disease presence in the U.S. only, and some articles describe disease presence in other countries.   Theme 4. All of the articles discuss vaccination, but there is not yet a vaccine for RSV. Some alternate control measures, such as hand washing or sanitizing surfaces, appear in one or more articles.   Theme 5. The question about mathematical concepts could mean many things. There are many possible answers, including but not limited to: numbers of recent cases, lengths of time of the stages of disease, historical data about when more or fewer people have been ill in past years, or percentages of people vaccinated.    Follow Up By Seeking More Precise Data  For these and other diseases or outbreaks we may read about, we can add to our knowledge of underlying disease biology by gathering additional data. We will find, when modeling diseases, that it can help to know the lengths of time for each disease stage, such as incubation period, how long a person is typically sick, and how long any immunity to the disease lasts. Vaccine data is also helpful, including whether a vaccine exists at all, how effective the vaccine is on average, and what percentage of people are vaccinated against a particular disease. Some of the data we collect may depend on time or place: vaccines may be newer, or different percentages of people may be vaccinated in different locations.  One place to look up data is the Centers for Disease Control and Prevention (CDC) . As one example, a web search can take us to the CDC's information page about measles . Not every disease is presented in an identical manner on the CDC's web pages, but very commonly, there is a link for Transmission and another link for Signs and Symptoms. These typically contain lots of information about how diseases spread and how long each stage takes. Such information helps us build our models.    Take a look at the Transmission and Signs and Symptoms pages for measles at the CDC. Putting together the information on these pages, construct a timeline of measles contagion in a single person, starting at the time the person is first infected. Include the following, and include whatever other information appears important.   How long does it typically take for a person to begin being contagious?    How long is the total time period from when a person begins being contagious to when they no longer are contagious?    How does contagion overlap, or not overlap, with when a person has the typical measles rash?   It is likely, for most diseases, that these timelines will involve ranges of time such as 3 to 5 days rather than more specific amounts of time such as 4 days . Time ranges will be helpful to us as we fine-tune our models.      Look up the lengths of time for key phases of how measles unfolds. Include the length of time of any incubation period, and include how long a person is infectious with measles. There may be additional disease phases to include. Use official sources, as described in . Cite your sources, including links to any web pages, the title of each web page used, the name of the government agency or other publisher of each web page, and the date you most recently accessed the web page.  Look up the lengths of time for key phases of how RSV (respiratory syncytial virus) unfolds. Include the length of time of any incubation period, and include how long a person is infectious with RSV. There may be additional disease phases to include. Use official sources, as described in . Cite your sources Include links to any web pages, the title of each web page used, the name of the government agency or other publisher of each web page, and the date you most recently accessed the web page. .  Look up additional information about measles and RSV. How does each spread? What are governmental recommendations for people who think they may have measles or RSV? And so on: read more about each disease, and write several pieces of information that you find interesting. Does anything you find surprise you? Cite your sources. Include links to any web pages, the title of each web page used, the name of the government agency or other publisher of each web page, and the date you most recently accessed the web page.    "
},
{
  "id": "objectives-1",
  "level": "2",
  "url": "ch-prelude-diseases-in-popular-news.html#objectives-1",
  "type": "Goals",
  "number": "",
  "title": "",
  "body": "   Read about an outbreak in a non-scientific article    Begin to look for disease details that can turn into mathematical ideas    Notice the goals and style of writing in a news or popular culture article on an outbreak, and think about how these may be different in a scientific journal article    Prioritize, and build toward a habit of, full-class discussion    "
},
{
  "id": "expl-reading-about-disease-in-the-news-and-popular-media",
  "level": "2",
  "url": "ch-prelude-diseases-in-popular-news.html#expl-reading-about-disease-in-the-news-and-popular-media",
  "type": "Exploration",
  "number": "1.1",
  "title": "Reading about Disease in the News and Popular Media.",
  "body": " Reading about Disease in the News and Popular Media   The Washington Post is a newspaper with a corresponding website. CNN is a television station and an online news source. People magazine and the corresponding website people.com center on celebrity news and human-interest stories People magazine Wikipedia entry , accessed 15 Nov 2022 .    Read one or more of these suggested articles, which come from the outlets described above.     A tourist infected with measles visited Disneyland and other Southern California hot spots in mid-August , published August 24, 2019, by the Washington Post;     Pandemic immunity gap is probably behind surge in RSV cases, scientists say , published October 28, 2022, by CNN;     Vaccinations a Priority as Measles Cases in the U.S. Number 107 in the First 7 Months of 2018 , published August 16, 2018, by People.      While reading each article, think through the answers to as many of the following questions as you can.    What illness is involved?    How does it spread?    How quickly does it proceed? Consider incubation time, length of sickness, etc.    Is it more prominent in some parts of the world than others?    What does the article say about vaccines, quarantines, isolation, testing, or other approaches to managing this illness?    What mathematical concepts can you find in your article?    The question about mathematical concepts is very open-ended. List any ideas that seem to make sense to you.   hi  "
},
{
  "id": "activity-1",
  "level": "2",
  "url": "ch-prelude-diseases-in-popular-news.html#activity-1",
  "type": "Activity",
  "number": "1.2",
  "title": "",
  "body": "  Take a look at the Transmission and Signs and Symptoms pages for measles at the CDC. Putting together the information on these pages, construct a timeline of measles contagion in a single person, starting at the time the person is first infected. Include the following, and include whatever other information appears important.   How long does it typically take for a person to begin being contagious?    How long is the total time period from when a person begins being contagious to when they no longer are contagious?    How does contagion overlap, or not overlap, with when a person has the typical measles rash?   It is likely, for most diseases, that these timelines will involve ranges of time such as 3 to 5 days rather than more specific amounts of time such as 4 days . Time ranges will be helpful to us as we fine-tune our models.   "
},
{
  "id": "exercise-1",
  "level": "2",
  "url": "ch-prelude-diseases-in-popular-news.html#exercise-1",
  "type": "Exercise",
  "number": "1.3.1",
  "title": "",
  "body": "Look up the lengths of time for key phases of how measles unfolds. Include the length of time of any incubation period, and include how long a person is infectious with measles. There may be additional disease phases to include. Use official sources, as described in . Cite your sources, including links to any web pages, the title of each web page used, the name of the government agency or other publisher of each web page, and the date you most recently accessed the web page. "
},
{
  "id": "exercise-2",
  "level": "2",
  "url": "ch-prelude-diseases-in-popular-news.html#exercise-2",
  "type": "Exercise",
  "number": "1.3.2",
  "title": "",
  "body": "Look up the lengths of time for key phases of how RSV (respiratory syncytial virus) unfolds. Include the length of time of any incubation period, and include how long a person is infectious with RSV. There may be additional disease phases to include. Use official sources, as described in . Cite your sources Include links to any web pages, the title of each web page used, the name of the government agency or other publisher of each web page, and the date you most recently accessed the web page. . "
},
{
  "id": "exercise-3",
  "level": "2",
  "url": "ch-prelude-diseases-in-popular-news.html#exercise-3",
  "type": "Exercise",
  "number": "1.3.3",
  "title": "",
  "body": "Look up additional information about measles and RSV. How does each spread? What are governmental recommendations for people who think they may have measles or RSV? And so on: read more about each disease, and write several pieces of information that you find interesting. Does anything you find surprise you? Cite your sources. Include links to any web pages, the title of each web page used, the name of the government agency or other publisher of each web page, and the date you most recently accessed the web page.  "
},
{
  "id": "ch-zombies-can-math-help",
  "level": "1",
  "url": "ch-zombies-can-math-help.html",
  "type": "Chapter",
  "number": "2",
  "title": "Zombies: Can Math Help?",
  "body": " Zombies: Can Math Help?      Simulate an outbreak and actively observe the data that emerge    Think through the disease spread process underlying a simulation    Compare the disease spread process with a system of differential equations suggested as a possible model for this process    Consider how changes in the disease spread process can change the outcome     First things first: let's simulate an outbreak! The simulations in this text, starting with , are directly inspired by the Disease Lab materials published freely online by Utah State University. Jim Powell and Matt Lewis, Disease Lab (2016). Laboratory Experiences in Mathematical Biology . 1. https:\/\/digitalcommons.usu.edu\/lemb\/1 You can do this exploration in a group or on your own. (Groups are recommended, if you are able to team up with one or more other people.) You will model humans, also called Susceptibles, as well as zombies, also called Infectious. The Utah State University link describes a hands-on way to play this game using dry erase markers and overhead projector transparencies. In this text, we primarily use a related online Zombie Game App This app was created by Gabe Nelson, Bates College Class of 2020, after campus closed due to COVID-19. to play and to generate data.  Why do we start with a simulation? First, this course requires active involvement, so we create space immediately for that involvement. Second, this simulation game can be interactive, and working with others helps us see other perspectives and adds both fun and community to learning. Third, though we mostly work with real-life outbreaks in this textbook, we also purposely diverge from reality to think through hypothetical outcomes, and zombies are one way to think creatively about disease spread. Fourth, this activity generates outbreak examples, and examples throughout this course are one of our main ways to build toward theory and illustrate abstract concepts. Therefore, to achieve the goals for each section, we usually begin with exploration activities, then use what we learned in the explorations to help build our mathematical framework.   Zombie Game   This game uses a grid of 100 hexagons to represent a space in which humans and zombies interact. Each round of game play represents one day. For each day, each human ( Susceptible ) is represented on the grid by a blue X on a single hexagon. Each zombie ( Infectious ) is represented by three red dots connected by red lines, meant to suggest a head and two arms, each of which can infect a human. Each zombie spreads out across three connected hexagons. Sample hex grids, both unmarked and marked, appear in .    Blank hex grid, and sample filled-in section    Full hex grid, not filled in   Hex grid of 100 hexagons, in a ten-by-ten arrangement     Representing humans (blue X marks) and zombies (red dots and lines, representing a head and two arms) on the hex grid   Detail of hex grid, showing placement of zombies and humans       To start the simulation, go to the Zombie Game App . Use the default settings at first, except to change the Human Start Count to 49, as shown in . Combining these 49 Humans with the Zombie Start Count of 1, the total population then equals 50.   Changing Human Start Count to 49 in the Zombie Game App   Screen image from the Zombie Game App, showing the Human Start Count      To watch the outbreak unfold, day by day, first click start . You will see the zombies and humans placed randomly on the grid. Both a table of data, and a graph of Round 0 and Round 1 data, appear to the right. A sample Round 1 result appears in , and the table of data is shown more clearly in . There is randomness in how Zombies and Humans are placed on the grid, so your one-day results on the app may be different.   Sample output for Round 1 from the Zombie Game App   Sample output for Round 1 from the Zombie Game App, including the grid of humans and zombies, plus a table and a graph of data for Rounds 0 and 1     Table of sample data from Round 1 of a human zombie simulation   Sample data for one round of a simulation from the Zombie Game App, viewed as a table    If you began with 49 humans and 1 zombie, these will be the numbers listed for Round 0. The data for Round 1 are computed by looking at the hex grid: each human that overlaps with a zombie is a New Infection and moves from the # Humans category to the # Zombies category. This means that this number of individuals is subtracted from # Humans and added to # Zombies . Double check that your count of new infections matches the app's count! In , the one zombie overlaps two blue X hexes. We therefore see that on Round 1 there are two New Infections . We also compare Round 1 with Round 0. The two New Infections for Round 1 mean that the population of Susceptibles (that is, humans) drops by 2, from 49 to 47, while the population of Infectious (that is, zombies) rises by 2, from 1 to 3.)    When you are ready, click next round to see a new grid for Round 2. The table of data, and the graph, both update to include Round 2. Continue to click next round at your own pace, thinking through the grid, table, and graph as each step proceeds. The game ends when there are either no humans left to infect, or no zombies left to keep infecting new humans.    As an alternative to make the game more interactive, the app allows you to choose your own locations for humans and zombies. To choose your own locations, under Mode , check Hotseat instead of Auto . The app then prompts you to place all the Humans for one round of the simulation. After all Humans are placed, the app prompts you to place your Zombies. For each Zombie, you must place the head and the arms. When this is complete, the app shows both Humans and Zombies, to indicate how many new infections have occurred. To make this into a game, two people can play. One person places the Humans, without their partner watching . Then the partner places the Zombies, again without their partner watching . Then, together, the partners can see how many new infections there are, once the Human and Zombie grids are shown together. Is there any strategy that helps either the Humans or the Zombies?    Try the game one or many times, on your own or with a partner. Copy several resulting data sets, as numbers and as images, so that you can look for patterns.      We Now Have Data: Qualitative Musings  You have now had the chance to generate one or many data sets. Take time to examine the data, both in the form of a table and in the form of a graph. Do this with multiple data sets: in a classroom setting, different student groups can share data.    Think through the following questions. Spend time trying to answer these before you continue through this book.    Upon viewing multiple sets of data from the Zombie Game App , what patterns do you observe?    Do you have any questions, or guesses, about what might happen in additional simulations in the app?    So far, we have mostly kept the default settings in the app, and played just one version of the hands-on game, but what if we changed the rules for human zombie interaction? Do you suspect that the outcome(s) could then be different? If so, then in what ways do you think the outcome(s) might change?      In this book, we work with mathematical models. As a first step toward building mathematical models, we should think through the underlying rules of our situation. We should also think through any outcomes of these rules. Must these rules always lead to similar outcomes? Could these same rules produce significantly different outcomes? Spending time on understanding our system is a crucial part of making sure our mathematical approaches make sense.    In , some of the first patterns to notice may be about the shapes of the graphs of the Human and Zombie populations as time progresses forward from Day 0. Next, develop responses to the following questions, and explain your reasoning. (If you already thought about these as part of , great work!)    What can you say about whether the size of each population (Humans and Zombies) is rising or falling?    Can a single population first rise, and later fall (or first fall, and then rise)?    If we tried this simulation many times, in what ways could your results be similar, and in what ways could your results be different?      There are many other things you may notice. To name just a few ideas: you may think about the speed with which each curve rises or falls. You may think about how much these speeds change when you try the game several times. You may relate a rise in one graph to a fall in the other, thinking about a sort of symmetry between the two graphs. You may think about when the rising or falling is relatively slow vs. relatively fast. These and many other observations are a valued and central part of working toward mathematical model building.    A First Model  After completing a simulation, you have data for the numbers of humans and zombies during each day of the outbreak. These data can be presented as a table of values, and they can be presented as a graph. In the app, the table format for data appears as in , and the graph format for data appears as in .   Table of sample data from a human zombie simulation   Sample data for a full simulation from the Zombie Game App, viewed as a table     Graph of sample data from a human zombie simulation   Sample data for a full simulation from the Zombie Game App, viewed as a graph    As we build a model, we focus on the relatively slow changes in population sizes that happen near the beginning and end of the model. This may not happen in every simulation: for instance, sometimes zombies happen to infect a lot of humans in the last time step. However, in other simulations, one lone human may last for many days before being infected. We focus on what happens on average . For this model, on average, the pace of infection seems slower near the beginning and near the end of the outbreak.    One observation is that the pace of infection is slower when there are relatively few humans, or when there are relatively few zombies.    Can you see why it makes sense that infection tends to spread less quickly when there are fewer individuals in one of the populations?    Conversely, why does it make sense for infection to spread relatively rapidly when there are relatively large numbers of both humans and zombies?    To take the discussion about pace of infection to a logical extreme: how fast can infection spread when there are zero humans, or when there are zero zombies?      Putting this all together, we can say that, on average, the change in the number of infections seems to depend on both the number of humans (Susceptibles) and the number of zombies (Infectious). One mathematical approach to writing this is to say that new cases per day are proportional to the number of Susceptibles multiplied by the number of Infectious. We can write this as follows:   To turn this into a mathematical formula, we will use a system of ordinary differential equations . This is a good time to mention: to read and learn from this text, there is no need to have taken a course on differential equations. To write and work with the models we use, it is sufficient to know these ideas from calculus:    derivatives represent change;    an increasing graph has a positive slope and a derivative greater than zero;    a decreasing graph has a negative slope and a derivative less than zero; and    a horizontal graph (one in which the output value is not changing) has a slope of zero and a derivative equal to zero.    One other helpful piece of information is the fact that a differential equation is just an equation containing a derivative. Many of the equations in calculus contain a derivative. A quick example is , which contains the derivative . This means that if you have studied calculus, then you have already built significant experience using differential equations.  With these calculus ideas in mind, we return to our model. We will write two equations, one to represent the change in the Susceptible population and one to represent the change in the Infectious population. When we say change , we mean the change that happens on average if we were to run the simulation many times. Our independent variable is time, which we label . You may have noticed that time is the variable on the horizontal axis: this axis is labeled Round in the app, and it represents time in the form of days. For our dependent variables, we choose letters that correspond to the names of each population. This makes the dependent variable meanings easier to remember, and for many people, it makes the differential equations easier to interpret. Therefore let represent the Susceptible population and represent the Infectious population. Since our populations are represented by the letters and , we call this model an SI model . We say the names of each of the first two letters when saying SI model aloud, that is, we say S  I  model .  You may have noticed that our data show us not just total numbers of and at each time step, but also show how and change over time. The number of New Infections tells us precisely how many people change, on each day, from the population to the population. We now connect , , and the number of New Infections using differential equations and the proportionality relationship from :   There is a lot of calculus happening in these SI model equations! Here are some of the key ideas to notice.    The derivative term represents the change, across time, in population .    Similarly, the derivative represents the change, across time, in population .    In this model, individuals leaving go immediately into , which is why the same term appears on the right-hand side of both equations.    Individuals can only leave , so decreases, and is negative. We actually see the negative sign ( ) written into the differential equation.    Individuals can only enter , so increases, and is positive. We do not explicitly write a positive sign ( ), but we note that there is no negative sign ( ).    The values of and should never be negative. They should be either positive or zero. This makes sense because they represent populations of individuals. This must also be true mathematically, in order for the model to make sense.    We represent the idea of proportionality by using the parameter . We will experiment in with different values of to see how changing affects the outcomes of the model.    The value of must be positive. This observation is consistent with us directly seeing the negative sign ( ) when a term is negative, and not seeing the negative sign when a term is positive. (With this observation, it could be possible for to be 0, but if there is any outbreak and any interaction of with , then will not be 0.)    This model uses differential equations, which think of time as continuous, using every real value for starting at . By contrast, when we collect data from the zombie game, time is discrete , meaning that time steps forward through values such as Day 0 , Day 1 , Day 2 , and so on. In this course, we mainly use differential equation models, meaning time is thought of as continuous . Continuous time may match well with our intuitive sense of how time works: time does not stop and start. However, the data we collect about disease spread will often be discrete, on time scales such as days or weeks. We will include this knowledge in our work with models.     shows one possible graph of the SI model, with selected so that the graphs in and are fairly similar. Compare these two graphs, thinking through the questions below.   A sample graph of the SI model, drawn using Equations and .   Sample SI graph, showing Susceptibles starting at 49 and dropping toward 0, and Infectious starting at 1 and rising toward 50      The curves in are smooth, whereas the graphs shown in are less so. Why is this?    The SI model, as described in Equations and , provides formulas for and . Yet the graph in shows solution curves for Susceptibles and Infectious, that is, and . Describe how the formulas for and in the SI model correspond to the solution curves and shown in .    Throughout the human-zombie simulation, there are exactly 50 people at all times. Explain how this feature of the simulation appears in both and .    Continue to comment on comparisons, similarities, and differences between and . There are no specific right answers here: this is open-ended exploration, building intuition and understanding for the interactions among data, graphs, and a differential equations model.        Vary the zombie simulation so that zombies have only one arm. In this case, the app represents each zombie by two connected dots, rather than three connected dots. We can change the # of Zombie Arms in the app from 2 to 1. Complete one or more simulations with this change. Collect and graph the simulation data. How do your results compare with the results from simulations in which zombies have two arms? Write about your results. Include graphs and tables of data, in the style of and , as part of your comparison.  What other variations can you imagine creating in this game? Describe how the game changes, and connect each game change with what it would mean in the real-world scenario of a zombie outbreak.   How might your mathematical model change in order to match this change in the game? In other words, how might your differential equations change?    How might long-term outcomes for humans and zombies change, if at all?   Support your thoughts, to the best of your abilities, using the data and graphs you generate from simulating your changes to the game.  Spend more time examining and thinking about the graph of the SI model, as shown in .   Since , , and cannot be negative, we recognize that must be either negative or equal to zero. Explain what these observations indicate about the Susceptibles graph in , using Equation as part of your explanation.    Since , , and cannot be negative, we recognize that must be either positive or equal to zero. Explain what these observations indicate about the Infectious graph in , using Equation as part of your explanation.    In we will vary the value of in the SI model. Try to predict some of the ways in which changing will change the outcome of the SI model. How will the solution curves in change as increases? How will the solution curves in change as decreases? (Though the value of changes, your discussion should keep .)     "
},
{
  "id": "objectives-2",
  "level": "2",
  "url": "ch-zombies-can-math-help.html#objectives-2",
  "type": "Goals",
  "number": "",
  "title": "",
  "body": "   Simulate an outbreak and actively observe the data that emerge    Think through the disease spread process underlying a simulation    Compare the disease spread process with a system of differential equations suggested as a possible model for this process    Consider how changes in the disease spread process can change the outcome    "
},
{
  "id": "expl-activity-zombie-game",
  "level": "2",
  "url": "ch-zombies-can-math-help.html#expl-activity-zombie-game",
  "type": "Exploration",
  "number": "2.1",
  "title": "Zombie Game.",
  "body": " Zombie Game   This game uses a grid of 100 hexagons to represent a space in which humans and zombies interact. Each round of game play represents one day. For each day, each human ( Susceptible ) is represented on the grid by a blue X on a single hexagon. Each zombie ( Infectious ) is represented by three red dots connected by red lines, meant to suggest a head and two arms, each of which can infect a human. Each zombie spreads out across three connected hexagons. Sample hex grids, both unmarked and marked, appear in .    Blank hex grid, and sample filled-in section    Full hex grid, not filled in   Hex grid of 100 hexagons, in a ten-by-ten arrangement     Representing humans (blue X marks) and zombies (red dots and lines, representing a head and two arms) on the hex grid   Detail of hex grid, showing placement of zombies and humans       To start the simulation, go to the Zombie Game App . Use the default settings at first, except to change the Human Start Count to 49, as shown in . Combining these 49 Humans with the Zombie Start Count of 1, the total population then equals 50.   Changing Human Start Count to 49 in the Zombie Game App   Screen image from the Zombie Game App, showing the Human Start Count      To watch the outbreak unfold, day by day, first click start . You will see the zombies and humans placed randomly on the grid. Both a table of data, and a graph of Round 0 and Round 1 data, appear to the right. A sample Round 1 result appears in , and the table of data is shown more clearly in . There is randomness in how Zombies and Humans are placed on the grid, so your one-day results on the app may be different.   Sample output for Round 1 from the Zombie Game App   Sample output for Round 1 from the Zombie Game App, including the grid of humans and zombies, plus a table and a graph of data for Rounds 0 and 1     Table of sample data from Round 1 of a human zombie simulation   Sample data for one round of a simulation from the Zombie Game App, viewed as a table    If you began with 49 humans and 1 zombie, these will be the numbers listed for Round 0. The data for Round 1 are computed by looking at the hex grid: each human that overlaps with a zombie is a New Infection and moves from the # Humans category to the # Zombies category. This means that this number of individuals is subtracted from # Humans and added to # Zombies . Double check that your count of new infections matches the app's count! In , the one zombie overlaps two blue X hexes. We therefore see that on Round 1 there are two New Infections . We also compare Round 1 with Round 0. The two New Infections for Round 1 mean that the population of Susceptibles (that is, humans) drops by 2, from 49 to 47, while the population of Infectious (that is, zombies) rises by 2, from 1 to 3.)    When you are ready, click next round to see a new grid for Round 2. The table of data, and the graph, both update to include Round 2. Continue to click next round at your own pace, thinking through the grid, table, and graph as each step proceeds. The game ends when there are either no humans left to infect, or no zombies left to keep infecting new humans.    As an alternative to make the game more interactive, the app allows you to choose your own locations for humans and zombies. To choose your own locations, under Mode , check Hotseat instead of Auto . The app then prompts you to place all the Humans for one round of the simulation. After all Humans are placed, the app prompts you to place your Zombies. For each Zombie, you must place the head and the arms. When this is complete, the app shows both Humans and Zombies, to indicate how many new infections have occurred. To make this into a game, two people can play. One person places the Humans, without their partner watching . Then the partner places the Zombies, again without their partner watching . Then, together, the partners can see how many new infections there are, once the Human and Zombie grids are shown together. Is there any strategy that helps either the Humans or the Zombies?    Try the game one or many times, on your own or with a partner. Copy several resulting data sets, as numbers and as images, so that you can look for patterns.   "
},
{
  "id": "exer-begin-zombie-app",
  "level": "2",
  "url": "ch-zombies-can-math-help.html#exer-begin-zombie-app",
  "type": "Activity",
  "number": "2.2",
  "title": "",
  "body": "  Think through the following questions. Spend time trying to answer these before you continue through this book.    Upon viewing multiple sets of data from the Zombie Game App , what patterns do you observe?    Do you have any questions, or guesses, about what might happen in additional simulations in the app?    So far, we have mostly kept the default settings in the app, and played just one version of the hands-on game, but what if we changed the rules for human zombie interaction? Do you suspect that the outcome(s) could then be different? If so, then in what ways do you think the outcome(s) might change?     "
},
{
  "id": "activity-3",
  "level": "2",
  "url": "ch-zombies-can-math-help.html#activity-3",
  "type": "Activity",
  "number": "2.3",
  "title": "",
  "body": "  In , some of the first patterns to notice may be about the shapes of the graphs of the Human and Zombie populations as time progresses forward from Day 0. Next, develop responses to the following questions, and explain your reasoning. (If you already thought about these as part of , great work!)    What can you say about whether the size of each population (Humans and Zombies) is rising or falling?    Can a single population first rise, and later fall (or first fall, and then rise)?    If we tried this simulation many times, in what ways could your results be similar, and in what ways could your results be different?     "
},
{
  "id": "fig-human-zombie-data-table",
  "level": "2",
  "url": "ch-zombies-can-math-help.html#fig-human-zombie-data-table",
  "type": "Figure",
  "number": "2.5",
  "title": "",
  "body": " Table of sample data from a human zombie simulation   Sample data for a full simulation from the Zombie Game App, viewed as a table   "
},
{
  "id": "fig-human-zombie-data-graph",
  "level": "2",
  "url": "ch-zombies-can-math-help.html#fig-human-zombie-data-graph",
  "type": "Figure",
  "number": "2.6",
  "title": "",
  "body": " Graph of sample data from a human zombie simulation   Sample data for a full simulation from the Zombie Game App, viewed as a graph   "
},
{
  "id": "activity-4",
  "level": "2",
  "url": "ch-zombies-can-math-help.html#activity-4",
  "type": "Activity",
  "number": "2.4",
  "title": "",
  "body": "  One observation is that the pace of infection is slower when there are relatively few humans, or when there are relatively few zombies.    Can you see why it makes sense that infection tends to spread less quickly when there are fewer individuals in one of the populations?    Conversely, why does it make sense for infection to spread relatively rapidly when there are relatively large numbers of both humans and zombies?    To take the discussion about pace of infection to a logical extreme: how fast can infection spread when there are zero humans, or when there are zero zombies?     "
},
{
  "id": "p-97",
  "level": "2",
  "url": "ch-zombies-can-math-help.html#p-97",
  "type": "Paragraph (with a defined term)",
  "number": "",
  "title": "",
  "body": "SI model "
},
{
  "id": "p-108",
  "level": "2",
  "url": "ch-zombies-can-math-help.html#p-108",
  "type": "Paragraph (with a defined term)",
  "number": "",
  "title": "",
  "body": "discrete continuous "
},
{
  "id": "activity-5",
  "level": "2",
  "url": "ch-zombies-can-math-help.html#activity-5",
  "type": "Activity",
  "number": "2.5",
  "title": "",
  "body": "   shows one possible graph of the SI model, with selected so that the graphs in and are fairly similar. Compare these two graphs, thinking through the questions below.   A sample graph of the SI model, drawn using Equations and .   Sample SI graph, showing Susceptibles starting at 49 and dropping toward 0, and Infectious starting at 1 and rising toward 50      The curves in are smooth, whereas the graphs shown in are less so. Why is this?    The SI model, as described in Equations and , provides formulas for and . Yet the graph in shows solution curves for Susceptibles and Infectious, that is, and . Describe how the formulas for and in the SI model correspond to the solution curves and shown in .    Throughout the human-zombie simulation, there are exactly 50 people at all times. Explain how this feature of the simulation appears in both and .    Continue to comment on comparisons, similarities, and differences between and . There are no specific right answers here: this is open-ended exploration, building intuition and understanding for the interactions among data, graphs, and a differential equations model.     "
},
{
  "id": "exercise-4",
  "level": "2",
  "url": "ch-zombies-can-math-help.html#exercise-4",
  "type": "Exercise",
  "number": "2.3.1",
  "title": "",
  "body": "Vary the zombie simulation so that zombies have only one arm. In this case, the app represents each zombie by two connected dots, rather than three connected dots. We can change the # of Zombie Arms in the app from 2 to 1. Complete one or more simulations with this change. Collect and graph the simulation data. How do your results compare with the results from simulations in which zombies have two arms? Write about your results. Include graphs and tables of data, in the style of and , as part of your comparison. "
},
{
  "id": "exercise-5",
  "level": "2",
  "url": "ch-zombies-can-math-help.html#exercise-5",
  "type": "Exercise",
  "number": "2.3.2",
  "title": "",
  "body": "What other variations can you imagine creating in this game? Describe how the game changes, and connect each game change with what it would mean in the real-world scenario of a zombie outbreak.   How might your mathematical model change in order to match this change in the game? In other words, how might your differential equations change?    How might long-term outcomes for humans and zombies change, if at all?   Support your thoughts, to the best of your abilities, using the data and graphs you generate from simulating your changes to the game. "
},
{
  "id": "exercise-6",
  "level": "2",
  "url": "ch-zombies-can-math-help.html#exercise-6",
  "type": "Exercise",
  "number": "2.3.3",
  "title": "",
  "body": "Spend more time examining and thinking about the graph of the SI model, as shown in .   Since , , and cannot be negative, we recognize that must be either negative or equal to zero. Explain what these observations indicate about the Susceptibles graph in , using Equation as part of your explanation.    Since , , and cannot be negative, we recognize that must be either positive or equal to zero. Explain what these observations indicate about the Infectious graph in , using Equation as part of your explanation.    In we will vary the value of in the SI model. Try to predict some of the ways in which changing will change the outcome of the SI model. How will the solution curves in change as increases? How will the solution curves in change as decreases? (Though the value of changes, your discussion should keep .)   "
},
{
  "id": "ch-visualization-graphing-model-results-and-data",
  "level": "1",
  "url": "ch-visualization-graphing-model-results-and-data.html",
  "type": "Chapter",
  "number": "3",
  "title": "Visualization: Graphing Model Results and Data",
  "body": " Visualization: Graphing Model Results and Data      Visualize data from the Zombie Game App alongside solution curves of the SI model from     Use comparisons between data and our initial SI model to visually estimate the value of the parameter     Learn the Python needed for solving systems of differential equations and graphing these solutions, plus data, on a shared set of axes     In we simulated a simple outbreak. This outbreak can be modeled using the system of ordinary differential equations appearing in and . Here is the system, also called an SI model, again:   We began to explore the differences between the discrete data, collected round-by-round in the Zombie Game App, and the continuous model, which uses a system of differential equations to produce smooth curves. In this chapter, we continue that exploration visually, by producing graphs of data and graphs of model results. We also see a first, very visual, way to estimate the value of in our model. (There will be other, more detailed, ways to estimate , as we continue in this text.) To do all this, we employ visualization tools. This text uses cells that run both Python and SageMath , which is a free open-source mathematics software system https:\/\/www.sagemath.org\/ , for visualization. The Python code here can be used in any setting where you use Python. The Python-related goal of this text is to make it as easy and intuitive as possible for readers to jump into using Python, so that we can better explore disease models. Some readers may prefer different Python syntax, or using a different program altogether, and these alternate approaches are welcome.    Begin by reading and seeking to understand the Python code in . In addition to thinking through what the Python code does, this textbook focuses attention on producing output that best showcases our modeling results and that is readable by a wide audience.   Creating Graphs in Python from the Human Zombie Game   If you have never used Python before, you are in the right place! If you have used Python, you may be able to move through this chapter more quickly, but be sure to spend time to make sure you know the code you need to complete modeling tasks. In this chapter, we spend a significant amount of time reading code, viewing code output, and making changes to code, to build up enough Python knowledge to be able to generate additional graphs of data and model results. The code we practice with allows us to visualize the sample data set shown as a table in .    Read carefully through the code below, focusing your attention on lines 3 8. Click the Evaluate (Sage) button underneath to view the output. Using the code and its output, answer the questions that follow.     Explain where and how in the code we enter, and label, the data from .    Which lines of code produce the blue dots on the output graph, and what information from do these dots represent?    Which lines of code produce the orange stars on the output graph, and what information from do these dots represent?       In Line 3, we enter the time data and label it t . In the human zombie game, time is listed in rounds of game play.  In Lines 4 and 5, we enter the human and zombie data, that is, Susceptible and Infectious, labeled S_data and I_data , respectively.  To enter a list of data, we type the label and the = sign. We then place the data inside square brackets, and we separate the data using commas. (The data, as listed, are separated by commas and also spaces. The spaces are optional.)  We are not entering the data for New Infections. Instead, we enter only the data we need for graphing the Susceptible and Infectious populations.    Lines 3 and 4 enter the data: the inputs (time, in terms of rounds of game play, which we label on the horizontal axis and enter in Line 3) and the outputs (values of the Human population, also called the Susceptible population, which are labeled on the vertical axis and are entered in Line 4). Line 6 creates, but does not show, the plot of data from Lines 3 and 4. Line 8 shows the plot of data.    Lines 3 and 5 enter the data: the inputs (time, in terms of rounds of game play, which we label on the horizontal axis and enter in Line 3) and the outputs (values of the Zombie population, also called the Infectious population, which are labeled on the vertical axis and are entered in Line 5). Line 7 creates, but does not show, the plot of data from Lines 3 and 5. Line 8 shows the plot of data.      Go back to the Python code and begin to play with it: make some changes. You can always start anew by refreshing the browser window. Address the following questions, and experiment freely beyond that.    What marker shapes do you like? To experiment with other shapes, see the library of marker shapes available in the online documentation for matplotlib .    Try different colors for the markers. One way to do this quickly is to go to this page about colors from the online documentation for matplotlib , and scroll down to the header CSS Colors . Replace blue and orange with colors you choose from the CSS Colors list, and view the resulting graph. (There are many other ways to choose colors in Python, and you can search online examples and documentation to learn about these.)      The first two lines of the Python code are important, but their phrasing does not make very obvious what they do. Line 1 imports a Python package that includes commands for drawing plots. Line 2 clears any past plots, meaning any past plots should be completely gone. This makes sure that any new plot contains only what we want. Line 2 may not be needed when we very first use Python, but if we create a different plot, and then come back to this code cell and re-enter it, the other plot we created could be overlaid with this one. The clear command, plt.cla() , makes sure that only our current plot appears.      Solving Differential Equations Using Graphs  Our goal in this section is to learn to use Python to create graphs similar to what we saw in . Such a graph starts with a system of differential equations and draws one possible graphical solution to that system. The graphical solution drawn depends on the equations themselves, the value(s) of any parameter(s), and the starting values for each population in the system, that is, the values when of , , and any other populations being modeled. For now, we specify that this type of solution is a graphical solution , but as the book continues, we will often refer to a graphical solution as simply a solution .  One thing we will almost never do is solve an entire system of differential equations in the way you may have seen in a calculus course, where we wrote the solution as a formula. To remind you how this often looks in calculus class that is, how it looks to solve by writing the solution of a differential equation as a formula we show an example in . Then begins the discussion about why we use a different approach in this text.    As we mentioned back in , a differential equation is just an equation in which at least one term is a derivative. This means that an equation like is a differential equation.  Solving a differential equation often means finding a way to write an equivalent relationship, without including a derivative. Using this interpretation of solving : solve     The general solution is , where can be any constant. In this case, we solved by computing the antiderivatives of both sides of the differential equation.      Now consider the SI model:   What are the challenges to solving this system of equations, where solving means determining formulas that do not involve derivatives for and ?    There are many ways to answer this. One consideration is that each of the differential equations involves both and . This means the differential equations do not stand alone: each depends on the other. This interrelationship means we cannot just compute two separate antiderivative formulas.  Another consideration is that the right-hand side of the differential equation in involves only , that is, only the independent variable. The dependent variable does not appear except in the derivative term . However, in the SI model system of equations, the dependent variables and appear in the derivatives and elsewhere in the equations . The antiderivative methods learned in a typical introductory Calculus course do not apply in this situation.  You may have thought of yet other challenges as well.    As discussed in , solving a system of differential equations is challenging. As we include more than two compartments, finding solution formulas for , , and additional populations becomes yet more challenging, and is often impossible. Even when we can determine solution formulas, they are typically quite complicated to work with.  Instead, our approach is to compute numerical solutions , which are solutions in the form of numbers. The main idea is that Python starts at the initial population values, then uses the system of differential equations to step through the full range of time, computing population values step-by-step at later times by using information about how the population values change throughout. The system of differential equations is made up of derivatives, which are rates of change, so they exactly describe how the populations change at all times . The population values computed in the numerical solution can be printed, or more often, graphed, to see the results in the form of a graphical solution.  We noted earlier that graphical solutions may be called simply solutions . Similarly, numerical solutions are sometimes called simply solutions . And we have seen that formula-based solutions can be called simply solutions . It is important to use context to determine which kind of solution is being discussed, in this text or in other reading.  Here is an outline of the numerical solution process.    Tell Python the formulas for the system of differential equations.    Tell Python which numbers to use for any parameters in the model. We select the numbers for a particular numerical solution, and we can use different numbers to create a different numerical solution.    Tell Python the initial conditions for each population, that is, the size of each population at the starting time of the model (which is usually ).    Tell Python when to start and stop the model, that is, the starting and ending values for time . Also tell Python what time steps to use as Python steps through from the starting to the ending time.    Ask Python to use all this information to numerically solve the model and plot graphical solution curves.    In , compare this outline with Python code.    Read the Python code in the block below, and click the Evaluate (Sage) button to view the resulting graph. Think carefully about steps 1-5 in the outline above. Which lines of code address which steps of the outline? (Notice that you may need to scroll down within the code block. Alternately, click the rectangular icon in the top right of the code block. This opens a full-screen version of the code. To return to the regular screen, click again the rectangle in the top right.)        The formulas for the system of differential equations appear most directly in line 8, in order. The first formula is -beta * S * I , and the second formula is beta * S * I . Collectively, these are labeled dy\/dt . More generally, the lines 6 9 define the system of differential equations.    In line 11, we give the value of 0.02. This number can be changed, and the resulting numerical solution then changes accordingly.    In line 12, the initial conditions are set to and . These initial conditions are collectively labeled as y0 . The initial conditions appear in square brackets and are separated by a comma. This syntax should look familiar from line 8, when we entered the right-hand sides of the differential equations all in one command, using the same syntax.    The time range for this numerical solution appears in line 13, using the arange command from the numpy package downloaded in line 2. The code says t = np.arange(0.0, 8.0, 0.1) . This means that time starts at and continues till . In addition, the 0.1 tells Python to use a step size of 0.1 in the step through process for computing and values.    We ask in line 14 for Python to compute a solution, called sol . To compute this solution, Python uses the command odeint and the inputs hz (the differential equations in the model), y0 (the initial conditions for this solution), and t_range (the range of time across which to compute the solution).  The commands in lines 16-18 work together to create the plot we see after clicking Evaluate (Sage) . Line 16 plots the blue curve, using the time inputs t_range and the values of throughout those times, which are described as sol[:, 0] . This means the solution sol , at all times, which is designated by : , in the initial position 0 . Python typically starts counting with 0 rather than 1, so the values are labeled as 0 rather than 1 .  Line 17 plots the orange curve, using the time inputs t_range and the values of throughout those times, which are described as sol[:, 1] . Python continues its counting here, with the values labeled as 1 .       Here is a summary of the Python code above, with some of the commands explained in more detail.  In the lines  import matplotlib.pyplot as plt  import numpy as np  from scipy.integrate import odeint  we import online packages that make it possible for Python to do some of the things we are about to do. Saying we are importing as gives us a name, such as plt or np , by which to call each package and use the tools within that package.  The lines  def hz(y, t):  S, I = y  dydt = [-beta * S * I, beta * S * I]  return dydt  define the system of differential equations, using the command def . The system is named hz , for human-zombie , and the (y, t) means that the model depends on variables and . The line S, I = y defines as comprising both and , in that order. This means that collectively represents all our dependent variables. Taking the derivative of , then, means taking each of the derivatives and . The formulas for these derivatives, which are on the right-hand sides of the SI model, appear in order in the line dydt = [-beta * S * I, beta * S * I] . Finally, the line return dydt ends the definition and says that whenever we later use the definition, we will be using the derivatives defined in dydt .  A quick way to think about these lines is that they define our system of differential equations and label them as hz .  The lines  beta = 0.02  y0 = [49, 1]  t_range = np.arange(0.0, 8.0, 0.1)  provide values for , the initial conditions and , and . Any of these values can be changed, and the code can be run again, to produce a different numerical simulation of the same system of differential equations. Notice that the initial conditions are listed in the same order as how we defined the differential equations: is first, and is second.  The solution of the system of differential equations  sol = odeint(hz, y0, t_range)  is a numerical solution, and it includes multiple parts. The solution is named sol . The Python command odeint computes the solution. For odeint to run, it needs three things: (1) a system of differential equations hz , (2) initial conditions y0 for the differential equations, and (3) a time range t_range across which to create the solution. Though odeint computes the numerical solution, it does not show us the graphical solution: the plots we create later show us these results. Instead, the numerical solution created by odeint consists of lists of numbers for and for , at the times specified in t_range . (If you would like to see the numerical values computed by sol , include the line print(sol) in the block of Python code above, sometime after the line sol = odeint(hz, y0, t_range) . When you then evaluate the code, the list of values will appear.)  The lines  plt.plot(t_range, sol[:, 0], color='blue')  plt.plot(t_range, sol[:, 1], color='orange')  create, but do not show, the plots of graphical solutions to the system of differential equations. For each plot, we provide the input values t_range and the output values from the numerical solution sol . As described above, sol is a set of numbers which are the values of the populations and at all the times in t_range . The numbers in sol are structured into two lists, list 0 and list 1. (Python often counts things, such as lists, starting with 0 rather than starting with 1.) The syntax sol[:,0] describes all the data. The colon : means all the elements, and the 0 means list 0, which is the list containing values of . The syntax sol[:,1] describes all the data, with : again representing all and 1 representing list 1, which contains values.  The lines above include colors for each graph, 'blue' for the graph and 'orange' for the graph. Stating colors is optional.  Finally,  plt.show()  shows the two plots, on a shared set of axes.  To build further understanding of how the Python code works, it helps to make several small changes to the code. Simultaneously, we continue to build intuition for how the output graph is affected by our selected parameter values, initial conditions, time range, and more. Try this in .    Start with the same Python code as in and try various small changes to the code. Identify where and how in the code to make the changes suggested below, and discuss the effects of each change on the resulting graph. Here and elsewhere, whenever we work with Python, feel free to try your own adaptations to the code.     Change the value of . Identify where in the Python code to make this change, and comment on how the output graph changes when increases or decreases. (While you can change to any value you like, recall that a realistic outbreak model requires .)    Change the initial conditions so that , , or both. Comment on how these changes affect the resulting graph. (To stay in the realm of biologically feasible outbreaks, keep and .)    Change the time range. Continue to begin at , but change the end time to something different than . Discuss reasons why a modeler may want to change the time range, and identify ways in which changing the time range causes the output graph to change.    Change the step size for time so that Python steps forward in increments of 1.0 instead of 0.1. Identify where in the Python code to make this change, and observe any ways in which the output graph looks different after the change.      These are all the basics for numerically solving a system of differential equations. In we create a graph in which data points and solution curves appear all on the same set of axes. Combining these plots provides a visual way to change the value of to improve the model's fit to data points. Then, also in , we discuss helpful ways to visualize information on graphs, so readers can best understand the results that emerge from models.    Estimating and Building Visualization Skills  To start, use information from the coding blocks above to create a single graph containing discrete data points for Humans and Zombies as well as continuous solution curves to the model for Susceptible and Infectious populations.    Combine lines of Python code from the coding blocks shown in and so that both the individual data markers from and the smooth solution curves from appear on the same graph.  Notice before you begin: some of the same commands appear in each of the two coding blocks you are combining. You do not need to include those lines twice.   Once you have combined the data points and solution curves into a single graph, try different values of . Working visually, comparing data points with solution curves, can you identify a value of that you believe produces the best correspondence between data points and solution curves? Discuss your reasoning, including a description of the features of a good correspondence between data points and solution curves.    If your approach creates two separate sets of axes, try again. Can you find a way to produce just one set of axes that contains both the data points from the Zombie Game App, and also the solution curves from the system of differential equations?  Regarding , we are not seeking a mathematically precise best fit . Instead, we are (1) visually identifying what a good fit may look like, and (2) describing the features of a good fit, from a visual perspective . The features may be somewhat subjective: there is not likely to be a perfect fit, and different readers may have different priorities regarding how a good fit should look.    One possible answer for the code is the following. import matplotlib.pyplot as plt import numpy as np from scipy.integrate import odeint plt.cla() t_steps = [0, 1, 2, 3, 4, 5, 6] S_data = [49, 47, 43, 36, 20, 4, 0] I_data = [1, 3, 7, 14, 30, 46, 50] def hz(y, t): S, I = y dydt = [-beta * S * I, beta * S * I] return dydt beta = 0.02 y0 = [49, 1] t_range = np.arange(0.0, 8.0, 0.1) sol = odeint(hz, y0, t_range) plt.plot(t_steps, S_data,'o', color='blue') plt.plot(t_steps, I_data, '*', color='orange') plt.plot(t_range, sol[:, 0], color='blue') plt.plot(t_range, sol[:, 1], color='orange') plt.show()   There are many possible answers regarding the value of . The key is to discuss what a good fit may look like. When the data and model do not fit perfectly, which is usually what will happen, then which aspects of the data do we most hope are represented in the model's solution curves?    At this point, you have worked with enough Python code to be able to graph your own data points and your own solutions to systems of differential equations that represent disease spread. Before we complete this chapter, however, we spend additional time with Python and visualization, with the goal of designing plots that best convey the information learned from models.  Each activity below invites you to learn by doing. Additionally: think through what YOU would like to see in plots. What features make it easier for you to interpret a graph? What features tell you best how to connect an image with a mathematical equation?    Evaluate the code below. Use the Python code, as well as the resulting graphs, to answer the questions appearing below the code block.     This code block includes an additional optional command in each of the lines starting with plt.plot . This command begins with label in each line. Where do you find these labels, and , on the plot produced below the code?   Line 19 says plt.legend() . What does this mean? You can check by turning this line off, then on again. To turn it off, type # at the start of Line 19, and run the code again. To turn it back on, remove the # . Starting a line with # turns the line into a comment rather than code. This means that Python does not execute the rest of the line after the # .   Line 20 states plt.xlabel('time') . Do you see where this label appears in the resulting plot? If so: can you figure out how to label the vertical axis as populations , to represent the combination of populations and ?   Uncomment Line 21 by removing the # symbol and evaluate the code again. How does this change the resulting plot? What advantages or disadvantages do you see in this change?        The labels and appear in the box on the graph, next to the line color of their associated plot. That is, label appears next to a blue line, and is plotted in blue. Label appears next to an orange line, and is plotted in orange.    The legend is the box mentioned in the previous bullet point. Legends can be very helpful when multiple plots appear on a shared set of axes.    The label appears below the horizontal axis. To label the vertical axis, include this new line in the code: plt.ylabel('populations') .    A grid appears throughout the plot. This may be an advantage for better pinpointing what the values of and are at various times . It may be a disadvantage if it makes the plot seem cluttered. There may be other advantages and disadvantages.       Comments are mentioned in . In Python, comments are helpful for turning code lines on and off. One reason to do this is to troubleshoot: if code seems to not be working, turning some lines temporarily into comments can help narrow down where the problem lies. Another reason to include comments is to write notes about what is happening in the code. This is helpful if you will use this code later, or share it with other people, to make it easier for you and others to use the code in the future.  The next activity shows more detailed use of comments, along with more ways to distinguish different solution curves when we plot multiple results on a shared set of axes.    Notice that the code block below includes many comments. Read through the comments: do they make sense? Would you add others?  Then evaluate the code and respond to the prompts below.     What do the linestyle commands do? Include them in Lines 26 and 27, when plotting S_data and I_data , to connect the markers from the Zombie Game App data points with the same style lines as those that solve the SI model.    What do the markersize commands do? Try different numerical values to find what you like.    What do the linewidth commands do? Try different numerical values to find what you like.    Label the data points from the Zombie Game App so that they appear in the legend.    Change the label on the horizontal axis to say time (rounds) to make the units of time more clear.          Start with the basic SI model in Python. Code for this appears in and . Change the code in the ways described below. For each change, list the original Python code, specify what updates you make, provide an image of the resulting graph, and describe in words how the resulting graph looks different as a result of the change you made. Keep the change in part (a) when you update part (b), then keep all these changes when you update part (c).    Increase to 200.    Adjust so that the Susceptible population is approximately 100 on day 10. (Notice that this update requires changing more than just the value of .)    Increase to 10.     The following figures, in order, are possible results.   A possible outcome from setting .   Sample solution graph for setting to 200.     A possible outcome when adjusting so that . The graph includes a grid, and it extends time to .   Sample solution graph for setting so that . The graph includes a grid, and it extends time to .     A possible outcome when setting .   Sample solution graph for setting to 10.     Open the Zombie Game App and run it, creating a data set that is (hopefully) different than that in . Use Python to plot these data points for humans and zombies. On the same set of axes, plot the graphical solutions to the differential equations in the SI model. Adjust so the SI model solution curves fit adequately well with the generated data points. Include a short discussion of ways in which the curves fit the data well, and ways in which the fit is not as good.  Look up information online about making data visualization more accessible to people who have some version of colorblindness. Read multiple sources on this topic, and use them to respond to the following questions. Cite your sources, including links to any web pages, the title of each web page used, the name of the publisher of each web page, and the date you most recently accessed the web page.   What sorts of color palettes can work relatively well to make a graph more accessible to a colorblind individual?    What are some ways that data markers can be used to improve graph accessibility?    How can different line styles be used to improve graph accessibility?    What are yet additional ways you can use Python features to create graphs that are accessible to as many people as possible?     "
},
{
  "id": "objectives-3",
  "level": "2",
  "url": "ch-visualization-graphing-model-results-and-data.html#objectives-3",
  "type": "Goals",
  "number": "",
  "title": "",
  "body": "   Visualize data from the Zombie Game App alongside solution curves of the SI model from     Use comparisons between data and our initial SI model to visually estimate the value of the parameter     Learn the Python needed for solving systems of differential equations and graphing these solutions, plus data, on a shared set of axes    "
},
{
  "id": "expl-creating-graphs-in-python-from-the-human-zombie-game",
  "level": "2",
  "url": "ch-visualization-graphing-model-results-and-data.html#expl-creating-graphs-in-python-from-the-human-zombie-game",
  "type": "Exploration",
  "number": "3.1",
  "title": "Creating Graphs in Python from the HumanZombie Game.",
  "body": " Creating Graphs in Python from the Human Zombie Game   If you have never used Python before, you are in the right place! If you have used Python, you may be able to move through this chapter more quickly, but be sure to spend time to make sure you know the code you need to complete modeling tasks. In this chapter, we spend a significant amount of time reading code, viewing code output, and making changes to code, to build up enough Python knowledge to be able to generate additional graphs of data and model results. The code we practice with allows us to visualize the sample data set shown as a table in .    Read carefully through the code below, focusing your attention on lines 3 8. Click the Evaluate (Sage) button underneath to view the output. Using the code and its output, answer the questions that follow.     Explain where and how in the code we enter, and label, the data from .    Which lines of code produce the blue dots on the output graph, and what information from do these dots represent?    Which lines of code produce the orange stars on the output graph, and what information from do these dots represent?       In Line 3, we enter the time data and label it t . In the human zombie game, time is listed in rounds of game play.  In Lines 4 and 5, we enter the human and zombie data, that is, Susceptible and Infectious, labeled S_data and I_data , respectively.  To enter a list of data, we type the label and the = sign. We then place the data inside square brackets, and we separate the data using commas. (The data, as listed, are separated by commas and also spaces. The spaces are optional.)  We are not entering the data for New Infections. Instead, we enter only the data we need for graphing the Susceptible and Infectious populations.    Lines 3 and 4 enter the data: the inputs (time, in terms of rounds of game play, which we label on the horizontal axis and enter in Line 3) and the outputs (values of the Human population, also called the Susceptible population, which are labeled on the vertical axis and are entered in Line 4). Line 6 creates, but does not show, the plot of data from Lines 3 and 4. Line 8 shows the plot of data.    Lines 3 and 5 enter the data: the inputs (time, in terms of rounds of game play, which we label on the horizontal axis and enter in Line 3) and the outputs (values of the Zombie population, also called the Infectious population, which are labeled on the vertical axis and are entered in Line 5). Line 7 creates, but does not show, the plot of data from Lines 3 and 5. Line 8 shows the plot of data.      Go back to the Python code and begin to play with it: make some changes. You can always start anew by refreshing the browser window. Address the following questions, and experiment freely beyond that.    What marker shapes do you like? To experiment with other shapes, see the library of marker shapes available in the online documentation for matplotlib .    Try different colors for the markers. One way to do this quickly is to go to this page about colors from the online documentation for matplotlib , and scroll down to the header CSS Colors . Replace blue and orange with colors you choose from the CSS Colors list, and view the resulting graph. (There are many other ways to choose colors in Python, and you can search online examples and documentation to learn about these.)      The first two lines of the Python code are important, but their phrasing does not make very obvious what they do. Line 1 imports a Python package that includes commands for drawing plots. Line 2 clears any past plots, meaning any past plots should be completely gone. This makes sure that any new plot contains only what we want. Line 2 may not be needed when we very first use Python, but if we create a different plot, and then come back to this code cell and re-enter it, the other plot we created could be overlaid with this one. The clear command, plt.cla() , makes sure that only our current plot appears.   "
},
{
  "id": "p-144",
  "level": "2",
  "url": "ch-visualization-graphing-model-results-and-data.html#p-144",
  "type": "Paragraph (with a defined term)",
  "number": "",
  "title": "",
  "body": "graphical solution "
},
{
  "id": "exer-solve-de",
  "level": "2",
  "url": "ch-visualization-graphing-model-results-and-data.html#exer-solve-de",
  "type": "Activity",
  "number": "3.2",
  "title": "",
  "body": "  As we mentioned back in , a differential equation is just an equation in which at least one term is a derivative. This means that an equation like is a differential equation.  Solving a differential equation often means finding a way to write an equivalent relationship, without including a derivative. Using this interpretation of solving : solve     The general solution is , where can be any constant. In this case, we solved by computing the antiderivatives of both sides of the differential equation.   "
},
{
  "id": "exer-cannot-easily-solve-de-system",
  "level": "2",
  "url": "ch-visualization-graphing-model-results-and-data.html#exer-cannot-easily-solve-de-system",
  "type": "Activity",
  "number": "3.3",
  "title": "",
  "body": "  Now consider the SI model:   What are the challenges to solving this system of equations, where solving means determining formulas that do not involve derivatives for and ?    There are many ways to answer this. One consideration is that each of the differential equations involves both and . This means the differential equations do not stand alone: each depends on the other. This interrelationship means we cannot just compute two separate antiderivative formulas.  Another consideration is that the right-hand side of the differential equation in involves only , that is, only the independent variable. The dependent variable does not appear except in the derivative term . However, in the SI model system of equations, the dependent variables and appear in the derivatives and elsewhere in the equations . The antiderivative methods learned in a typical introductory Calculus course do not apply in this situation.  You may have thought of yet other challenges as well.   "
},
{
  "id": "p-155",
  "level": "2",
  "url": "ch-visualization-graphing-model-results-and-data.html#p-155",
  "type": "Paragraph (with a defined term)",
  "number": "",
  "title": "",
  "body": "numerical solutions "
},
{
  "id": "p-160",
  "level": "2",
  "url": "ch-visualization-graphing-model-results-and-data.html#p-160",
  "type": "Paragraph (with a defined term)",
  "number": "",
  "title": "",
  "body": "initial conditions "
},
{
  "id": "exer-first-odeint-code",
  "level": "2",
  "url": "ch-visualization-graphing-model-results-and-data.html#exer-first-odeint-code",
  "type": "Activity",
  "number": "3.4",
  "title": "",
  "body": "  Read the Python code in the block below, and click the Evaluate (Sage) button to view the resulting graph. Think carefully about steps 1-5 in the outline above. Which lines of code address which steps of the outline? (Notice that you may need to scroll down within the code block. Alternately, click the rectangular icon in the top right of the code block. This opens a full-screen version of the code. To return to the regular screen, click again the rectangle in the top right.)        The formulas for the system of differential equations appear most directly in line 8, in order. The first formula is -beta * S * I , and the second formula is beta * S * I . Collectively, these are labeled dy\/dt . More generally, the lines 6 9 define the system of differential equations.    In line 11, we give the value of 0.02. This number can be changed, and the resulting numerical solution then changes accordingly.    In line 12, the initial conditions are set to and . These initial conditions are collectively labeled as y0 . The initial conditions appear in square brackets and are separated by a comma. This syntax should look familiar from line 8, when we entered the right-hand sides of the differential equations all in one command, using the same syntax.    The time range for this numerical solution appears in line 13, using the arange command from the numpy package downloaded in line 2. The code says t = np.arange(0.0, 8.0, 0.1) . This means that time starts at and continues till . In addition, the 0.1 tells Python to use a step size of 0.1 in the step through process for computing and values.    We ask in line 14 for Python to compute a solution, called sol . To compute this solution, Python uses the command odeint and the inputs hz (the differential equations in the model), y0 (the initial conditions for this solution), and t_range (the range of time across which to compute the solution).  The commands in lines 16-18 work together to create the plot we see after clicking Evaluate (Sage) . Line 16 plots the blue curve, using the time inputs t_range and the values of throughout those times, which are described as sol[:, 0] . This means the solution sol , at all times, which is designated by : , in the initial position 0 . Python typically starts counting with 0 rather than 1, so the values are labeled as 0 rather than 1 .  Line 17 plots the orange curve, using the time inputs t_range and the values of throughout those times, which are described as sol[:, 1] . Python continues its counting here, with the values labeled as 1 .      "
},
{
  "id": "exer-first-odeint-code-play-around",
  "level": "2",
  "url": "ch-visualization-graphing-model-results-and-data.html#exer-first-odeint-code-play-around",
  "type": "Activity",
  "number": "3.5",
  "title": "",
  "body": "  Start with the same Python code as in and try various small changes to the code. Identify where and how in the code to make the changes suggested below, and discuss the effects of each change on the resulting graph. Here and elsewhere, whenever we work with Python, feel free to try your own adaptations to the code.     Change the value of . Identify where in the Python code to make this change, and comment on how the output graph changes when increases or decreases. (While you can change to any value you like, recall that a realistic outbreak model requires .)    Change the initial conditions so that , , or both. Comment on how these changes affect the resulting graph. (To stay in the realm of biologically feasible outbreaks, keep and .)    Change the time range. Continue to begin at , but change the end time to something different than . Discuss reasons why a modeler may want to change the time range, and identify ways in which changing the time range causes the output graph to change.    Change the step size for time so that Python steps forward in increments of 1.0 instead of 0.1. Identify where in the Python code to make this change, and observe any ways in which the output graph looks different after the change.     "
},
{
  "id": "exer-combine-data-points-and-curves",
  "level": "2",
  "url": "ch-visualization-graphing-model-results-and-data.html#exer-combine-data-points-and-curves",
  "type": "Activity",
  "number": "3.6",
  "title": "",
  "body": "  Combine lines of Python code from the coding blocks shown in and so that both the individual data markers from and the smooth solution curves from appear on the same graph.  Notice before you begin: some of the same commands appear in each of the two coding blocks you are combining. You do not need to include those lines twice.   Once you have combined the data points and solution curves into a single graph, try different values of . Working visually, comparing data points with solution curves, can you identify a value of that you believe produces the best correspondence between data points and solution curves? Discuss your reasoning, including a description of the features of a good correspondence between data points and solution curves.    If your approach creates two separate sets of axes, try again. Can you find a way to produce just one set of axes that contains both the data points from the Zombie Game App, and also the solution curves from the system of differential equations?  Regarding , we are not seeking a mathematically precise best fit . Instead, we are (1) visually identifying what a good fit may look like, and (2) describing the features of a good fit, from a visual perspective . The features may be somewhat subjective: there is not likely to be a perfect fit, and different readers may have different priorities regarding how a good fit should look.    One possible answer for the code is the following. import matplotlib.pyplot as plt import numpy as np from scipy.integrate import odeint plt.cla() t_steps = [0, 1, 2, 3, 4, 5, 6] S_data = [49, 47, 43, 36, 20, 4, 0] I_data = [1, 3, 7, 14, 30, 46, 50] def hz(y, t): S, I = y dydt = [-beta * S * I, beta * S * I] return dydt beta = 0.02 y0 = [49, 1] t_range = np.arange(0.0, 8.0, 0.1) sol = odeint(hz, y0, t_range) plt.plot(t_steps, S_data,'o', color='blue') plt.plot(t_steps, I_data, '*', color='orange') plt.plot(t_range, sol[:, 0], color='blue') plt.plot(t_range, sol[:, 1], color='orange') plt.show()   There are many possible answers regarding the value of . The key is to discuss what a good fit may look like. When the data and model do not fit perfectly, which is usually what will happen, then which aspects of the data do we most hope are represented in the model's solution curves?   "
},
{
  "id": "exer-grid-axis-labels-comments",
  "level": "2",
  "url": "ch-visualization-graphing-model-results-and-data.html#exer-grid-axis-labels-comments",
  "type": "Activity",
  "number": "3.7",
  "title": "",
  "body": "  Evaluate the code below. Use the Python code, as well as the resulting graphs, to answer the questions appearing below the code block.     This code block includes an additional optional command in each of the lines starting with plt.plot . This command begins with label in each line. Where do you find these labels, and , on the plot produced below the code?   Line 19 says plt.legend() . What does this mean? You can check by turning this line off, then on again. To turn it off, type # at the start of Line 19, and run the code again. To turn it back on, remove the # . Starting a line with # turns the line into a comment rather than code. This means that Python does not execute the rest of the line after the # .   Line 20 states plt.xlabel('time') . Do you see where this label appears in the resulting plot? If so: can you figure out how to label the vertical axis as populations , to represent the combination of populations and ?   Uncomment Line 21 by removing the # symbol and evaluate the code again. How does this change the resulting plot? What advantages or disadvantages do you see in this change?        The labels and appear in the box on the graph, next to the line color of their associated plot. That is, label appears next to a blue line, and is plotted in blue. Label appears next to an orange line, and is plotted in orange.    The legend is the box mentioned in the previous bullet point. Legends can be very helpful when multiple plots appear on a shared set of axes.    The label appears below the horizontal axis. To label the vertical axis, include this new line in the code: plt.ylabel('populations') .    A grid appears throughout the plot. This may be an advantage for better pinpointing what the values of and are at various times . It may be a disadvantage if it makes the plot seem cluttered. There may be other advantages and disadvantages.     "
},
{
  "id": "exer-dash-dot-comments",
  "level": "2",
  "url": "ch-visualization-graphing-model-results-and-data.html#exer-dash-dot-comments",
  "type": "Activity",
  "number": "3.8",
  "title": "",
  "body": "  Notice that the code block below includes many comments. Read through the comments: do they make sense? Would you add others?  Then evaluate the code and respond to the prompts below.     What do the linestyle commands do? Include them in Lines 26 and 27, when plotting S_data and I_data , to connect the markers from the Zombie Game App data points with the same style lines as those that solve the SI model.    What do the markersize commands do? Try different numerical values to find what you like.    What do the linewidth commands do? Try different numerical values to find what you like.    Label the data points from the Zombie Game App so that they appear in the legend.    Change the label on the horizontal axis to say time (rounds) to make the units of time more clear.      "
},
{
  "id": "exercise-7",
  "level": "2",
  "url": "ch-visualization-graphing-model-results-and-data.html#exercise-7",
  "type": "Exercise",
  "number": "3.3.1",
  "title": "",
  "body": " Start with the basic SI model in Python. Code for this appears in and . Change the code in the ways described below. For each change, list the original Python code, specify what updates you make, provide an image of the resulting graph, and describe in words how the resulting graph looks different as a result of the change you made. Keep the change in part (a) when you update part (b), then keep all these changes when you update part (c).    Increase to 200.    Adjust so that the Susceptible population is approximately 100 on day 10. (Notice that this update requires changing more than just the value of .)    Increase to 10.     The following figures, in order, are possible results.   A possible outcome from setting .   Sample solution graph for setting to 200.     A possible outcome when adjusting so that . The graph includes a grid, and it extends time to .   Sample solution graph for setting so that . The graph includes a grid, and it extends time to .     A possible outcome when setting .   Sample solution graph for setting to 10.    "
},
{
  "id": "exercise-8",
  "level": "2",
  "url": "ch-visualization-graphing-model-results-and-data.html#exercise-8",
  "type": "Exercise",
  "number": "3.3.2",
  "title": "",
  "body": "Open the Zombie Game App and run it, creating a data set that is (hopefully) different than that in . Use Python to plot these data points for humans and zombies. On the same set of axes, plot the graphical solutions to the differential equations in the SI model. Adjust so the SI model solution curves fit adequately well with the generated data points. Include a short discussion of ways in which the curves fit the data well, and ways in which the fit is not as good. "
},
{
  "id": "exercise-9",
  "level": "2",
  "url": "ch-visualization-graphing-model-results-and-data.html#exercise-9",
  "type": "Exercise",
  "number": "3.3.3",
  "title": "",
  "body": "Look up information online about making data visualization more accessible to people who have some version of colorblindness. Read multiple sources on this topic, and use them to respond to the following questions. Cite your sources, including links to any web pages, the title of each web page used, the name of the publisher of each web page, and the date you most recently accessed the web page.   What sorts of color palettes can work relatively well to make a graph more accessible to a colorblind individual?    What are some ways that data markers can be used to improve graph accessibility?    How can different line styles be used to improve graph accessibility?    What are yet additional ways you can use Python features to create graphs that are accessible to as many people as possible?   "
},
{
  "id": "ch-compartmental-diagrams",
  "level": "1",
  "url": "ch-compartmental-diagrams.html",
  "type": "Chapter",
  "number": "4",
  "title": "Compartmental Diagrams",
  "body": " Compartmental Diagrams      Begin to use compartmental diagrams    Learn the rules and assumptions for drawing compartmental diagrams    Connect compartmental diagrams with their corresponding systems of differential equations    Build understanding of units and rate parameters in models     In we simulated a simple outbreak. This outbreak can be modeled using the system of ordinary differential equations appearing in and . Here is the system again:   This style of model is called a compartmental model because the individuals in our model are designated by categories called compartments ; in this case, the compartments are Susceptibles and Infectious . In we made calculus-based observations of the differential equations in this model. We can draw the dynamics of the model in a compartmental diagram , as shown in .   The compartmental diagram for one possible SI model, where S stands for Susceptible and I stands for Infectious   (Write this)     In this text, we regularly represent the dynamics of an outbreak using both compartmental model drawings and systems of differential equations. When we are careful in how we draw our compartmental diagrams, we can use these diagrams interchangeably with their corresponding systems of differential equations. In this chapter, we learn the vocabulary of compartmental models, as well as ways to draw compartmental diagrams so they clearly and completely represent the information contained in their corresponding systems of differential equations.  We begin in by trying a different version of the human zombie game. We then ask you to use the intuition you are building to think through how the compartmental diagram should look for this human zombie game variation. After that, we discuss more details about compartmental diagrams. You are strongly encouraged to try to build your own compartmental diagram before moving on to the text's discussion of the details.    Varying the Human Zombie Game   In the original Zombie Game App , once an individual becomes a zombie, they are always a zombie. This means that no one leaves the Infectious compartment.  Suppose, instead, that zombies do not last forever. Instead, after some number of days, the zombies die (again), or in other words, the zombies become inactive. The number of days they remain Infectious before becoming inactive can be stated in the app.     Before trying this scenario in the app , think through how zombie death, and different zombie lifespans, would change the outcomes of the simulation. In particular, think carefully about these questions:    What do you expect will happen if Zombies die, that is, they become inactive and unable to spread infection? Whether you feel very certain, or somewhat uncertain, articulate some outcomes that you think will occur with this game variation.    How might your expected outcomes differ from those in the original model?    Outcomes might be measured by the table of data, by the graphs, by the timing of how infection spreads, by the numbers of survivors, or in other ways. For each of your expectations about how the outcomes may change, what support can you show for why this expectation makes sense?    This exercise is not about right or wrong ideas, but instead is about building hypotheses, comparing the hypotheses with data, and developing deeper understanding of what the model shows.    After you have thought through how the outcomes will change in a variation, use the app to generate data.  To set up this variation in the Zombie Game app, check the box for Zombie Mortality , shown by the lower red arrow in . A box then appears for Zombie Lifespan (days) , shown by the upper red arrow in . Try setting Zombie Lifespan to 1, then 2, then 3. For each length of time, run several simulations, save your data sets, and compare the outcomes.   Checking the box for Zombie Mortality and setting a value for Zombie Lifespan (days)   Screen image from the Zombie Game App, showing the checked box for Zombie Mortality and the Zombie Lifespan (days) that appears       Compare the results with the ideas you generated in part (a). How similar or different are the actual results, compared with what you thought?     What else do you observe? Consider how many humans or zombies survive till the end, and consider how much these numbers vary from simulation to simulation. Consider how many days the outbreak lasts. Make note of any additional observations you have, and reach out to other people trying this experiment to see how your results compare with theirs.     Before moving on to the next section , use your intuition to draw a possible compartmental diagram for the outbreak you just simulated in this Exploration. The only compartmental diagram we have seen so far is in : use this diagram as an example, and make changes to match your simulation.      Compartmental Diagrams: Vocabulary and Comments  In this section, we give a general description of compartmental diagrams. As you read, check in with the intuition you have been building: do these ideas fit with your understanding so far? Soon, in , we will connect these general ideas about compartmental diagrams with the specific model you constructed in .  A compartmental diagram is made up of boxes and arrows, each labeled to show what it represents. The boxes are called compartments and represent mutually distinct groups of individuals. The arrows indicate the possible ways that individuals can relocate from one compartment to another.  When we say mutually distinct , we mean that at any moment in time, an individual is in exactly one compartment: no more, no fewer. This means our entire population is fully accounted for at all times because everyone appears in some compartment. We also notice that we cannot double-count individuals, as they cannot be in more than one compartment at a time.  Because our models use continuous time and differential equations, we will sometimes compute non-integer values for the number of individuals in some compartments. We should think through this carefully. If, for instance, we find that at some time we have 13.6 Susceptibles and 36.4 Infectious, we are not saying that we have 13 Susceptibles, plus 36 Infectious, plus one individual who is split up to be 60% Susceptible and 40% Infectious. Instead, the differential equation model is telling us on average what happens, across many possible simulations or many possible outcomes. In computing an on average outcome, non-integer values are possible. If we wish to refer to actual numbers of people, we can round to the nearest integer, or use language that reflects the on average meaning of our model.  When we use a compartmental diagram, we should carefully define and describe all our terms. The definitions and descriptions may change in different models, so we should not assume that , , , or other variables always have the same meaning. Time, , may be measured in days, weeks, or some other unit, and we should indicate the unit. Here are possible descriptions for and based on the human zombie game in : stands for the Susceptible population, meaning people who do not have the zombie disease yet but could become ill with this disease, and stands for the Infectious population, meaning individuals who are currently contagious and currently showing symptoms of the zombie disease. In other outbreaks, and therefore in other models, these descriptions may change. As just one example, in a different model may refer to individuals who are Infectious in the sense that they are contagious, but they may or may not be showing symptoms. Modelers should fully state the specific definitions of , , or other populations, in their models.  The term indicates flow from to . This term indicates that the flow depends on both the population and the population . When either population is very small, flow is relatively small. When both populations are relatively large, their product is large and therefore flow is relatively large. This sort of term is called a mass action term, from the Law of Mass Action in chemistry. The idea of mass action is just one way to model flow from one compartment to another; we will study other formulas for flow.   The letters , , and are variables in the model. The Greek letter is a parameter. We use the following conventions for letters in most of the models we study:   Time is denoted as the lowercase letter  .    We use capital letters such as and to indicate populations of people, which are typically functions of time, so that , .     Greek letters such as represent some aspect of how a disease progresses and are called parameters .   A parameter may seem to behave a bit like a variable, since it can take on different values. However, parameters play a different role than variables in our models. In a given simulation, we use biological information to set all parameter values . By contrast, we choose only the initial values of our variables, that is, the values when , and then the simulation reveals the values of each variable at later points in time. For instance, in the human zombie example, we start at with 49 humans and 1 zombie. Writing this in mathematical terms: and . After , the populations of Susceptibles and Infectious depend on the outcome of the simulation. Even the length of time for the simulation depends on how long it takes the Infectious zombies to convert all the Susceptible humans.    From Zombie Game Variation to Compartmental Diagram  The Zombie Game variation in introduces a new category of individuals, beyond Susceptibles and Infectious. This new category corresponds to a new compartment, compared with , in the model's compartmental diagram.  When zombies die, they leave the Infectious compartment and can no longer infect the Susceptibles. It is typical to represent these dynamics by introducing a Removed (R) compartment for the individuals who were zombies but have then become inactive. Our model then includes S, I, and R compartments, so we call it an SIR model . We typically say each of the letters in SIR when naming this model aloud. That is, we refer to the S  I  R model, not the sir model. A compartmental diagram representing the dynamics of this SIR model appears in .   One possible (Susceptible, Infectious, Removed) compartmental diagram   (Write this)     In this diagram, we include the S and I compartments used previously, while also allowing the Infectious zombies to leave the I compartment and enter the R compartment, where they stay for the rest of the simulation. The mathematical formula for movement from I to R is . The parameter (the Greek letter gamma ) represents the rate at which individuals leave and enter . Larger values of , for instance, mean that zombies become inactive more rapidly than with smaller values of . This formula indicates that neither Susceptibles nor Removed individuals influence movement from I to R: instead, only the number of Infectious people, and a rate based on how long they remain zombies, determine this movement between compartments.    Take time to think through the compartmental diagram in .    Does match your sense of how individuals progress through the simulation? Are all individuals always in exactly one compartment, that is, in at least one compartment and also no more than one compartment at any given time?    Using the information in the compartmental diagram, write the differential equations for this SIR model.        Have you considered whether all individuals must pass through all three compartments?    We saw in that the term named on an arrow appears twice in the differential equations: once as a negative term, in the equation for the compartment the arrow is exiting, and once as a positive term, in the equation for the compartment the arrow is entering.        It should be true that individuals are in exactly one compartment at a time, but with all claims such as this, you should convince yourself or else ask questions about it. It should also be true that individuals cannot progress in any order other than what the compartmental diagram shows. However, in some simulations, some individuals may not leave compartment S. By contrast, with and the SI model, all individuals progress from the S compartment to the I compartment.    The differential equations for this SIR model are:             Estimating Gamma and Other Rates  Consider an SIR model as represented in . Let us think about what the values of should be.    What would it mean if , , or ? Specifically: what fraction of the members of the I compartment leaves I within one time step for each of these values of ? Similarly, what percentage of the members of the I compartment leaves I within one time step for each value of ?    If , then all members of compartment I, that is, of the members, leave I at each time step. If , then half the members, that is, , leave I at each time step. And if , then one-quarter of the members, that is, , leave I at each time step.      Using what you learned in , think further about , , or . For each of these values of , how long does a typical individual remain in compartment I before leaving for compartment R?    If , then all members of compartment I leave at each time step, so a typical individual stays in I for one time step. If , then half the members of I leave at each time step, so a typical individual stays in I for approximately two time steps. And if , then one-quarter of the members of I leave at each time step, so a typical individual stays in I for approximately four time steps.    We begin to see in that we can understand intuitively in relationship to how long an individual is in the I compartment. A compartmental model does not track individuals directly, and the responses in do not suggest that every individual in an outbreak is sick for a precise amount of time that is shown by . Instead, the relationship between and length of time in compartment I shows how long on average individuals stay in compartment I. We can write this relationship mathematically:   Another way to phrase this, when being in the I compartment corresponds to a person being infectious, is:   In we use the ideas in and to estimate for specific outbreaks.  Notice that is an amount of time. This means that the units of are . This observation corresponds with being a rate .  Many, but not all, of the parameters in the models in this text are rates. Usually, when a parameter in a compartmental model is a rate, we can estimate its value in a similar way to how we estimate in .  In particular, notice that in our model can not be a rate. We see this when we recognize that each term in a model equation must have the same units: otherwise, we cannot set terms equal to each other, or add or subtract terms. Explore how this works in .    In , we developed the following system of differential equations for the SIR model shown in :   Recall that each of the variables , , and represents some average number of individuals. This means that the units for each of , , and are population . Alternately, we could call these units people or individuals . We also just saw from the discussion of that the units of are .    Consider the equation from the SIR model. What are the units of the term on the left-hand side, and what are the units of the term on the right-hand side? Can you confirm that these two terms have the same units?    Next, consider the equation from the SIR model. Start by using the first part of this activity to determine the units of and . Next, in order for the units to be the same for all three terms, what should the units be for ? Finally, knowing the units of , what must be the units for ?    Use your results from the first two parts of this activity to confirm that the units are the same on both sides of the equation in the SIR model.        The term has units because the units of in the numerator are population and the units of in the denominator are time .  The term has units because has units and has units (population).  Both sides have the same units, namely .    The terms and have units , for similar reasons to those described in the first part of this activity.  The term should therefore also have units . Since there are two populations, and , multiplied in the numerator, this means that must have units .    The term has units , for similar reasons to those described in the first part of this activity.  Within the term , we saw in the second part of this activity that has units . Both and have units (population). Multiplying together the three terms , , and , the resulting units are .  These observations confirm that the units are the same on both sides of the equation .      After completing , we recognize that in our SIR model, the units of are not . Therefore is not a rate, and we cannot estimate the value of similarly to how we estimate the value of . Indeed, estimating the value of will require different methods. In we discuss estimating visually by comparing our model with data. In and we introduce another way to estimate , using other parameter values we know, along with a formula involving an epidemiological concept known as the basic reproduction number .       Use the ideas and website suggestions of to determine how long individuals are infectious with measles. Cite your source(s). Include links to any web pages, the title of each web page used, the name of the government agency or other publisher of each web page, and the date you most recently accessed the web page. Then suppose you are creating an SIR model for the spread of measles. What value would you use for ? Explain your reasoning.  Compare your response to exercise 1 in with this article on measles from . What are the similarities, and the differences, between how the CDC and People magazine describe how long measles is infectious?  Use the ideas and website suggestions of to determine how long individuals are infectious with RSV. Cite your source(s). Include links to any web pages, the title of each web page used, the name of the government agency or other publisher of each web page, and the date you most recently accessed the web page. Then suppose you are creating an SIR model for the spread of RSV. What value would you use for ? Explain your reasoning.   "
},
{
  "id": "objectives-4",
  "level": "2",
  "url": "ch-compartmental-diagrams.html#objectives-4",
  "type": "Goals",
  "number": "",
  "title": "",
  "body": "   Begin to use compartmental diagrams    Learn the rules and assumptions for drawing compartmental diagrams    Connect compartmental diagrams with their corresponding systems of differential equations    Build understanding of units and rate parameters in models    "
},
{
  "id": "p-233",
  "level": "2",
  "url": "ch-compartmental-diagrams.html#p-233",
  "type": "Paragraph (with a defined term)",
  "number": "",
  "title": "",
  "body": "compartmental model compartments compartmental diagram "
},
{
  "id": "fig-SI-compartmental-diagram",
  "level": "2",
  "url": "ch-compartmental-diagrams.html#fig-SI-compartmental-diagram",
  "type": "Figure",
  "number": "4.1",
  "title": "",
  "body": " The compartmental diagram for one possible SI model, where S stands for Susceptible and I stands for Infectious   (Write this)    "
},
{
  "id": "expl-activity-varying-the-human-zombie-game",
  "level": "2",
  "url": "ch-compartmental-diagrams.html#expl-activity-varying-the-human-zombie-game",
  "type": "Exploration",
  "number": "4.1",
  "title": "Varying the HumanZombie Game.",
  "body": " Varying the Human Zombie Game   In the original Zombie Game App , once an individual becomes a zombie, they are always a zombie. This means that no one leaves the Infectious compartment.  Suppose, instead, that zombies do not last forever. Instead, after some number of days, the zombies die (again), or in other words, the zombies become inactive. The number of days they remain Infectious before becoming inactive can be stated in the app.     Before trying this scenario in the app , think through how zombie death, and different zombie lifespans, would change the outcomes of the simulation. In particular, think carefully about these questions:    What do you expect will happen if Zombies die, that is, they become inactive and unable to spread infection? Whether you feel very certain, or somewhat uncertain, articulate some outcomes that you think will occur with this game variation.    How might your expected outcomes differ from those in the original model?    Outcomes might be measured by the table of data, by the graphs, by the timing of how infection spreads, by the numbers of survivors, or in other ways. For each of your expectations about how the outcomes may change, what support can you show for why this expectation makes sense?    This exercise is not about right or wrong ideas, but instead is about building hypotheses, comparing the hypotheses with data, and developing deeper understanding of what the model shows.    After you have thought through how the outcomes will change in a variation, use the app to generate data.  To set up this variation in the Zombie Game app, check the box for Zombie Mortality , shown by the lower red arrow in . A box then appears for Zombie Lifespan (days) , shown by the upper red arrow in . Try setting Zombie Lifespan to 1, then 2, then 3. For each length of time, run several simulations, save your data sets, and compare the outcomes.   Checking the box for Zombie Mortality and setting a value for Zombie Lifespan (days)   Screen image from the Zombie Game App, showing the checked box for Zombie Mortality and the Zombie Lifespan (days) that appears       Compare the results with the ideas you generated in part (a). How similar or different are the actual results, compared with what you thought?     What else do you observe? Consider how many humans or zombies survive till the end, and consider how much these numbers vary from simulation to simulation. Consider how many days the outbreak lasts. Make note of any additional observations you have, and reach out to other people trying this experiment to see how your results compare with theirs.     Before moving on to the next section , use your intuition to draw a possible compartmental diagram for the outbreak you just simulated in this Exploration. The only compartmental diagram we have seen so far is in : use this diagram as an example, and make changes to match your simulation.   "
},
{
  "id": "p-249",
  "level": "2",
  "url": "ch-compartmental-diagrams.html#p-249",
  "type": "Paragraph (with a defined term)",
  "number": "",
  "title": "",
  "body": "compartments "
},
{
  "id": "p-254",
  "level": "2",
  "url": "ch-compartmental-diagrams.html#p-254",
  "type": "Paragraph (with a defined term)",
  "number": "",
  "title": "",
  "body": "parameters "
},
{
  "id": "p-259",
  "level": "2",
  "url": "ch-compartmental-diagrams.html#p-259",
  "type": "Paragraph (with a defined term)",
  "number": "",
  "title": "",
  "body": "SIR model "
},
{
  "id": "fig-SIR-compartmental-diagram",
  "level": "2",
  "url": "ch-compartmental-diagrams.html#fig-SIR-compartmental-diagram",
  "type": "Figure",
  "number": "4.3",
  "title": "",
  "body": " One possible (Susceptible, Infectious, Removed) compartmental diagram   (Write this)    "
},
{
  "id": "activity-sir-diagram-and-des",
  "level": "2",
  "url": "ch-compartmental-diagrams.html#activity-sir-diagram-and-des",
  "type": "Activity",
  "number": "4.2",
  "title": "",
  "body": "  Take time to think through the compartmental diagram in .    Does match your sense of how individuals progress through the simulation? Are all individuals always in exactly one compartment, that is, in at least one compartment and also no more than one compartment at any given time?    Using the information in the compartmental diagram, write the differential equations for this SIR model.        Have you considered whether all individuals must pass through all three compartments?    We saw in that the term named on an arrow appears twice in the differential equations: once as a negative term, in the equation for the compartment the arrow is exiting, and once as a positive term, in the equation for the compartment the arrow is entering.        It should be true that individuals are in exactly one compartment at a time, but with all claims such as this, you should convince yourself or else ask questions about it. It should also be true that individuals cannot progress in any order other than what the compartmental diagram shows. However, in some simulations, some individuals may not leave compartment S. By contrast, with and the SI model, all individuals progress from the S compartment to the I compartment.    The differential equations for this SIR model are:      "
},
{
  "id": "activity-understanding-gamma-pt1",
  "level": "2",
  "url": "ch-compartmental-diagrams.html#activity-understanding-gamma-pt1",
  "type": "Activity",
  "number": "4.3",
  "title": "",
  "body": "  What would it mean if , , or ? Specifically: what fraction of the members of the I compartment leaves I within one time step for each of these values of ? Similarly, what percentage of the members of the I compartment leaves I within one time step for each value of ?    If , then all members of compartment I, that is, of the members, leave I at each time step. If , then half the members, that is, , leave I at each time step. And if , then one-quarter of the members, that is, , leave I at each time step.   "
},
{
  "id": "activity-understanding-gamma-pt2",
  "level": "2",
  "url": "ch-compartmental-diagrams.html#activity-understanding-gamma-pt2",
  "type": "Activity",
  "number": "4.4",
  "title": "",
  "body": "  Using what you learned in , think further about , , or . For each of these values of , how long does a typical individual remain in compartment I before leaving for compartment R?    If , then all members of compartment I leave at each time step, so a typical individual stays in I for one time step. If , then half the members of I leave at each time step, so a typical individual stays in I for approximately two time steps. And if , then one-quarter of the members of I leave at each time step, so a typical individual stays in I for approximately four time steps.   "
},
{
  "id": "p-276",
  "level": "2",
  "url": "ch-compartmental-diagrams.html#p-276",
  "type": "Paragraph (with a defined term)",
  "number": "",
  "title": "",
  "body": "rate "
},
{
  "id": "activity-introducing-units",
  "level": "2",
  "url": "ch-compartmental-diagrams.html#activity-introducing-units",
  "type": "Activity",
  "number": "4.5",
  "title": "",
  "body": "  In , we developed the following system of differential equations for the SIR model shown in :   Recall that each of the variables , , and represents some average number of individuals. This means that the units for each of , , and are population . Alternately, we could call these units people or individuals . We also just saw from the discussion of that the units of are .    Consider the equation from the SIR model. What are the units of the term on the left-hand side, and what are the units of the term on the right-hand side? Can you confirm that these two terms have the same units?    Next, consider the equation from the SIR model. Start by using the first part of this activity to determine the units of and . Next, in order for the units to be the same for all three terms, what should the units be for ? Finally, knowing the units of , what must be the units for ?    Use your results from the first two parts of this activity to confirm that the units are the same on both sides of the equation in the SIR model.        The term has units because the units of in the numerator are population and the units of in the denominator are time .  The term has units because has units and has units (population).  Both sides have the same units, namely .    The terms and have units , for similar reasons to those described in the first part of this activity.  The term should therefore also have units . Since there are two populations, and , multiplied in the numerator, this means that must have units .    The term has units , for similar reasons to those described in the first part of this activity.  Within the term , we saw in the second part of this activity that has units . Both and have units (population). Multiplying together the three terms , , and , the resulting units are .  These observations confirm that the units are the same on both sides of the equation .     "
},
{
  "id": "p-292",
  "level": "2",
  "url": "ch-compartmental-diagrams.html#p-292",
  "type": "Paragraph (with a defined term)",
  "number": "",
  "title": "",
  "body": "basic reproduction number "
},
{
  "id": "exercise-10",
  "level": "2",
  "url": "ch-compartmental-diagrams.html#exercise-10",
  "type": "Exercise",
  "number": "4.4.1",
  "title": "",
  "body": "Use the ideas and website suggestions of to determine how long individuals are infectious with measles. Cite your source(s). Include links to any web pages, the title of each web page used, the name of the government agency or other publisher of each web page, and the date you most recently accessed the web page. Then suppose you are creating an SIR model for the spread of measles. What value would you use for ? Explain your reasoning. "
},
{
  "id": "exercise-11",
  "level": "2",
  "url": "ch-compartmental-diagrams.html#exercise-11",
  "type": "Exercise",
  "number": "4.4.2",
  "title": "",
  "body": "Compare your response to exercise 1 in with this article on measles from . What are the similarities, and the differences, between how the CDC and People magazine describe how long measles is infectious? "
},
{
  "id": "exercise-12",
  "level": "2",
  "url": "ch-compartmental-diagrams.html#exercise-12",
  "type": "Exercise",
  "number": "4.4.3",
  "title": "",
  "body": "Use the ideas and website suggestions of to determine how long individuals are infectious with RSV. Cite your source(s). Include links to any web pages, the title of each web page used, the name of the government agency or other publisher of each web page, and the date you most recently accessed the web page. Then suppose you are creating an SIR model for the spread of RSV. What value would you use for ? Explain your reasoning. "
},
{
  "id": "ch-model-analysis-and-the-basic-reproduction-number-R0",
  "level": "1",
  "url": "ch-model-analysis-and-the-basic-reproduction-number-R0.html",
  "type": "Chapter",
  "number": "5",
  "title": "Model Analysis and the Basic Reproduction Number <span class=\"process-math\">\\(\\mathcal{R}_0\\)<\/span>",
  "body": " Model Analysis and the Basic Reproduction Number      Develop the technique of sign analysis for analyzing outcomes of compartmental models    Investigate relationships between a compartmental disease model, the size of the total population being modeled, and each compartment's long-term population value    Introduce the basic reproduction number and its implication for outbreaks     By now, we have studied models from several perspectives. In and the Zombie Game App, we generated data for an outbreak, constructed tables and graphs of data, and thought through how all these pieces of information fit together. then introduced using a system of differential equations for describing the relationships. The Python code in generated images of data points and solution curves for systems of differential equations. Finally, and crucially, we began drawing compartmental diagrams in .  These multiple forms of describing models all work together. They allow us to understand models and their results through graphs, equations, data, and diagrams. Now that we have these tools for discussing models, we take time to mathematically analyze models. Some of this analysis is necessary for confirming that our models make sense in relationship to the real world. Additional analysis of models gives us ways to think about controlling outbreaks.  Our starting point, using a combination of visual and equation-based understanding, begins in .   Rise and Fall of an Epidemic   We first saw the SIR model in . The compartmental diagram appears in and the system of differential equations is the following:   Throughout this Exploration, continue to connect the model, graphs of its solution curves, and real-world meaning.    Look at the expressions on the right-hand sides of the differential equations for the SIR model.    Which terms are positive? Which terms are negative? What does this tell you about how each population can flow through the compartments?    For each differential equation, what signs ( , , or ) are possible on the right-hand side? What does this tell you about the solution curves for the model?      For the graph in , which curve goes with which compartment of the SIR model? Justify your reasoning in two ways:    Use your sign analysis , that is, the work you just did on describing solution curves based on the sign ( , , or ) of the right-hand side of that compartment's differential equation in the SIR model.    Describe what happens in the Zombie Game App when we run a simulation including zombie mortality, and confirm that these curves make sense in that context.     One set of solution curves for the SIR model   Solution curves for the SIR model, unlabeled, for an exercise asking students to identify which curve represents which compartment in the model        Using Calculus to Analyze Models  The work of involves central ideas from introductory calculus. The equations of the SIR model are differential equations , which means they include derivatives. Derivatives represent change , and we often describe this change as the slope of a graph . The graphs we use in studying models are the solution curves of the model. That is, given equations for, say, , , and , the solution curves are the graphs of , , and , with time on the horizontal axis, and the populations , , and on the vertical axis.  Now, let us continue with model analysis, specifically naming calculus concepts along the way.    Consider the SIR model:   and define to be the total population being modeled, at time .  Each equation in this model represents the change in a single compartment's population, over time. How can we use the equations in the model to represent the change in total population over time? That is, how can we use the equations to represent ?  Determine the value of the change in total population : you should be able to compute a number. What does this number tell us about the total population in our model?    Add together the three differential equations. What is the meaning of the left-hand side? What is the meaning of the right-hand side? And what value do we obtain on the right-hand side when summing the differential equations?    On the left-hand side:   Therefore, summing the three differential equations determines the change over time of the total population.  On the right-hand side:   Since the three differential equations sum to zero, the change in total population is . This tells us that the total population in our model does not change. In other words, the size of the total population remains constant.    The analysis in includes the following calculus concepts.    The sum of derivatives equals the derivative of the sum: . Therefore .    When the derivative of a function equals , the function is unchanging: indicates that is unchanging.    In an outbreak that occurs over a relatively short time, it may make complete sense to say that the population is unchanging. It may be that the population truly does not change at all, or it may be that the population is changing so little that we decide not to include population change in a model of the outbreak. Noticing when population change is , or close to , allows us to write relatively simple models that do not try to incorporate births, deaths, immigration, emigration, or other population changes. Models that represent a longer span of time may need to account for changes in population.  Considering population change requires us to think more deeply about compartment R. We have referred to this compartment as Removed . Some models call the R compartment Recovered . In an outbreak where people all return to full health, calling the R compartment Recovered works well. In an outbreak that causes deaths, one modeling option is to include both deaths and recoveries in the same R compartment. In this case, the name Removed provides a better description. In either case, recognizing that R may stand for differently named compartments is a reminder to us about why we should fully describe each of our models, even if we believe SIR models are well known to our audience: even among SIR models, the interpretations can differ.  For now, we continue to work with an SIR model in which population does not change. We note that some models do need to account for changes in population. As one example, models that represent a longer span of time may incorporate births and deaths. We will see such models later in this text.  Another comment: though we have said our current SIR model probably refers to an outbreak over a relatively short time span, we purposely do not designate amounts of time that are relatively short or longer . This is a choice for the modeler. For each model, a human (the modeler, or perhaps a group working together) makes decisions about whether to list population changes based on length of time or other reasons. They then provide their decisions when describing their models, and they include some form of justification for each decision.  Next, we go back to the SIR model we have been studying to work through some ways the model solutions can change as parameter values change.    Use the code below to create three different graphs of solution curves to an SIR model in which , , , and . The first set of values for and appear in the code block; change the code to get the other two sets of values. It may help you to save screenshots of each of the three graphs, so you can more easily see all three at the same time.    In the first graph, let and .    In the second graph, let and .    In the third graph, let and .    Then respond to the prompts below the code block.     What observations can you make, overall, about the three graphs? Take time with this question, and think expansively, before moving on to the next questions.    Discuss the similarities and differences in the curves in each of your three graphs. Include observations using our sign analysis from : when is rising or falling, and what does this have to do with the sign ( , , or ) of ?    Compare the long-term outcomes for and across the three graphs. What do you notice about the total number of people who ever became sick in each case?    Explore the role that changes to make to the outcome in each graph. Similarly, think through how changes to contribute to changes. For each parameter, decide first how you think changing the parameter will change the solution curves. Then use the code block to make several changes to that parameter, and compare what you see with what you thought you would see.        This is open-ended.    In the first two graphs, rises, then falls. For a sign analysis, first write out the differential equation for . Then substitute in the values of and and the initial values and to see that . Yet decreases rapidly, until , and at this time the curve falls.  In the third graph, the graph has a negative slope from the very beginning. A sign analysis shows why this makes sense, based on the initial value of .    In the first graph, everyone eventually gets sick. The long-term value of appears to be and the long-term value of appears to be , which is the total population.  In the second graph, not everyone gets sick in the outbreak. The curve appears to level out at a value of approximately . Extending t_range beyond can help for confirming this.  In the third graph, quite a few people avoid illness. Estimates for long-term values of and can confirm this.    There is much to say here. In general, increasing makes more people become sick, and makes infection happen more rapidly. Decreasing leads to more infections. The , , and graphs are all affected by these changes, and the answer to this prompt should include descriptions of these changes.      Both and use sign analysis . This usage of the signs ( , , or ) of a derivative can inform us about circumstances in which a population is increasing, decreasing, or remaining constant. Such knowledge about the relationship between signs and derivatives comes from calculus and is tremendously powerful for understanding epidemics through compartmental modeling.  Let us take a moment to emphasize an assumption we make about signs when writing compartmental models. In many applications of mathematics, variables and parameters can take on the values of any real number. However, in compartmental models, we specify that variables and parameters cannot be negative because negative values would not make biological sense. For instance, populations of people cannot be negative, and length of time sick with a disease cannot be negative. Therefore, what we see is what we get: if no negative sign ( ) is visible, then a term cannot be negative.  Here is a summary of some of the key outcomes in the SIR model from our sign analysis so far. Notice that all these observations arise from calculus concepts.    Sign analysis tells us that cannot increase: since , then can only decrease or remain constant.    Sign analysis tells us that cannot decrease: since , then can only increase or remain constant.    Sign analysis tells us that has the ability to increase, decrease, or remain constant because the formula for can take on values that are positive, negative, or zero.    When , the graph of has a slope of . In many simulations, there is a single value of at which and the graph of turns from increasing to decreasing.    Eventually, in this model, the value of will approach , and then the values of and will level out because and will approach .    You may have found yet other ways to connect derivative signs ( , , or ) with model outcomes.    In addition to looking at signs, we examined long-term outcomes in . This is a moment to wonder: what can mathematical approaches tell us about limiting the impact of an outbreak? We explore this question in depth in .    The Basic Reproduction Number  It turns out that the SIR model, and many other compartmental models, can be connected with an epidemiological concept called the basic reproduction number . The basic reproduction number is the average number of new infections caused by one infectious person in an otherwise entirely susceptible population . This number is given the symbol , which is pronounced as R zero or R nought .  In , we begin to link our SIR model with the concept of .    This activity examines the boundary between rising and falling numbers in the SIR model we have been studying. We will see that this boundary relates to important information about the basic reproduction number .  Begin by using the code below to try different values of and . Your goal is to find values for which the curve does not rise at first: instead, it stays level or falls. Keep the initial conditions the same, that is, , , and . If changing the range of values helps you see the outcome better, then change the end time to a smaller or larger value. However, keep the initial time .  Can you find more than one combination of and for which the curve does not rise?  You may wish to test your conclusions by viewing model output. To do this, you can modify the Python code provided as part of . Updating the end time of the model simulation may be helpful: rather than end at , consider extending the model for a longer period of time.   Next, consider the equation from the SIR model. Under what conditions must ? Think about these conditions biologically: what interpretations can you give the conditions?    The first part of this is open-ended. There are many combinations of and for which the curve falls from the start.  For the second part of this, set the right-hand side of the equation equal to 0 and factor:   This results in two possibilities: either or . There are multiple biological interpretations of each possibility.    Both and should be leading you to the following conclusions.    Smaller values of lead to less growth of the curve and can help contribute to fewer total people ever becoming Infectious. Smaller corresponds to less infectivity.    Larger values of also lead to less growth of the curve and can help contribute to fewer total people ever becoming Infectious. Larger corresponds to a higher rate of people moving from compartment I to compartment R.    Another way to think of the previous bullet point: smaller values of lead to less growth of the curve and can help contribute to fewer total people ever becoming Infectious. Given the relationship in , we see that smaller corresponds to a shorter length of time that people are Infectious.    If and combine into a small enough value, the curve does not grow, even at the start of a model simulation.    We find that never grows if at the start of a simulation, that is, when . This means   Since , the only way to achieve is to have .    It would also be possible to have if , but once an outbreak begins, we no longer have .    As a reminder, we said that the basic reproduction number is the average number of new infections caused by one infectious person in an otherwise entirely susceptible population . We are nearly ready to present the formula for in the SIR model   However, we first emphasize that describes a phenomenon that occurs in an entirely susceptible population. When is described in the news or popular culture, as happened in many reports on COVID-19, the entirely susceptible population part of the definition is usually left out.  To incorporate the idea of an entirely susceptible population, we refer back to our definition of total population  , which appeared in . In that activity, we showed that remains constant in this SIR model. We can therefore write more simply as , since the value of does not change over time.  We now have all the pieces we need to assemble a formula for in the SIR model , , and :   It is possible to compute the formula for from the equations in a compartmental model. The most common way to do this is called the Next Generation Method. Because the Next Generation Method uses partial derivatives and techniques from linear algebra, it is described in the optional sections and . In particular, teaches the process in a way that can be used by students who are new to matrix operations and partial derivatives: there are a few math techniques to learn, and Python does the rest. Readers who include will be able to solve for the formula for in their own models. As an alternative, the formulas for several commonly used compartmental models are provided directly throughout this text.  The numerical value of the formula relates closely to the trajectory of an outbreak. Investigate this in .    Here, we connect two ideas: the circumstances under which , according to our work in , and the formula for , as given in .  Start with the following result from : in order to have when , it must be that . Show how to rearrange the equation algebraically to get   Then answer the following questions.    When , is rising or falling?    When , is rising or falling?    In a typical outbreak, what changes to cause to transition in sign between being positive, negative, and ? What is the expected order of these signs, that is, out of , , and , which happens first in an outbreak, which happens second, and which happens third? Why is this the order?    After completing the above questions, next consider the formula from , which says that . Use the work you have already done in this activity, along with the definition of as being the average number of new infections caused by one infectious person in an otherwise entirely susceptible population , to describe what tells us about the behavior of early in an outbreak.    When , then , which means that the number of Infectious people is increasing. This typically happens early in an outbreak. As the outbreak continues, the value of becomes smaller, so that eventually (which means ), and then (which means and the number of Infectious people is decreasing).  With one infectious person in an otherwise entirely susceptible population , it is approximately true that , that is, that the Susceptible population is essentially the entire population. Therefore, is a way of indicating what happens to the population at the very start of an outbreak .    As we have seen in , the value of tells us what happens at the very start of an outbreak. This relates to the definition of , which considers a single infectious person in an otherwise entirely susceptible population.  To be more specific, when , the value of is initially positive, which means that the value of initially increases. Only later, when there are fewer susceptibles, does the graph of level off and begin to fall.  Alternately, if , then the value of is initially negative. In this case, the graph of never rises: it only falls.  The value of , then, tells us whether to expect increasing numbers of Infectious individuals. The specific number is the boundary between rising and falling values of when a new infection is first introduced to a susceptible population. We will further see that larger values of correspond to diseases that are more infectious. The concept of will be central to our study of outbreaks.    Do some mathematical analysis of this SI model: In particular,   Sum the differential equations and use your results to describe how the total population being modeled changes over time.    Perform a sign analysis on the equation, indicating mathematically feasible ways in which the population can change during the time of the outbreak.    Perform a sign analysis on the equation, indicating mathematically feasible ways in which the population can change during the time of the outbreak.    Investigate the role of in changing the outcomes of the model. Describe ways in which changing can change the outcomes, and describe what those changes are. Also describe ways in which the outcomes cannot be changed by changing .    Imagine a new outbreak occurs in a small town of 5000 people. Let us suppose it makes sense to model this outbreak with an SIR model, where the compartments are Susceptible (people who are not sick but can become sick), Infectious (people who are currently able to spread the disease), and Removed (people who are no longer able to spread the disease and are unable to become sick again). At the start of the outbreak, a single person is Infectious, and the rest of the people are Susceptible.   Suppose that, in the early days of the outbreak, researchers estimate and . Compute the value of for this model. Then, based on the value of you compute, answer: what do you think will happen in the short term and in the long term of this outbreak?    Now suppose that the value of was instead approximated to be , yet it is still true that . Compute the value of in this case. With this value of , what do you anticipate for the short-term and long-term outcomes of the outbreak?    Now suppose this outbreak occurs in a town of 1000 people, with and . Compute the value of for the SIR model in this smaller town. Use this value of to describe what you think will happen in the short term and in the long term of this outbreak.    Adapt the Python code shown earlier in this chapter to produce graphs of the outcomes of the SIR models in parts (a), (b), and (c) above. Write a few sentences about how well your descriptions of short-term and long-term model outcomes are supported, or not supported, by the graphs.    Most diseases we know of have . This makes sense: without rising numbers of Infectious people, we do not experience an epidemic. However, in rare cases, a disease emerges for which . One example is MERS, which stands for Middle East Respiratory Syndrome. The first identified case of MERS was in 2012. There is still a lot to learn about MERS, but multiple estimates indicate that the value of for MERS is less than one. This activity is motivated by the existence of diseases with . Suppose we study a disease for which and , that is, people are typically infectious for about ten days. Suppose we choose to model this disease with an SIR model similar to the models we have been using in this chapter: S stands for Susceptible, meaning people who are not sick but can become sick; I stands for Infectious, meaning people who are currently able to spread the disease, and R stands for Removed, meaning people who are no longer able to spread the disease and are unable to become sick again. In the case of a disease similar to MERS, the Removed compartment consists of both recoveries and deaths from the disease.   In an area with a population of 1000, rearrange to solve for the value of for this SIR model.    Suppose that at the start of the outbreak, 20 people are Infectious. Use the Python block below to visualize the outbreak over 200 days. Notice that the Python block includes three print commands. These print and label the last output values stored as sol , that is, the , , and values for the last value of time , namely .   Use caution: by default, the Python block does not contain the correct value for . Instead, replace the existing value with the value you computed in part (a).   Use the graphs to describe qualitatively what happens in this population that began with 20 Infectious people. Does the curve for the population begin falling from the very beginning? What happens to the curves for and ?    Incorporate the output from the print command, along with the visual output of the graphs. How many people, in total, were Infectious at some point during the time of this model? How does this compare with the initial 20 cases? How do you reconcile this result with the behavior of the curve and with the knowledge that in this model?     "
},
{
  "id": "objectives-5",
  "level": "2",
  "url": "ch-model-analysis-and-the-basic-reproduction-number-R0.html#objectives-5",
  "type": "Goals",
  "number": "",
  "title": "",
  "body": "   Develop the technique of sign analysis for analyzing outcomes of compartmental models    Investigate relationships between a compartmental disease model, the size of the total population being modeled, and each compartment's long-term population value    Introduce the basic reproduction number and its implication for outbreaks    "
},
{
  "id": "expl-rise-and-fall-of-an-epidemic",
  "level": "2",
  "url": "ch-model-analysis-and-the-basic-reproduction-number-R0.html#expl-rise-and-fall-of-an-epidemic",
  "type": "Exploration",
  "number": "5.1",
  "title": "Rise and Fall of an Epidemic.",
  "body": " Rise and Fall of an Epidemic   We first saw the SIR model in . The compartmental diagram appears in and the system of differential equations is the following:   Throughout this Exploration, continue to connect the model, graphs of its solution curves, and real-world meaning.    Look at the expressions on the right-hand sides of the differential equations for the SIR model.    Which terms are positive? Which terms are negative? What does this tell you about how each population can flow through the compartments?    For each differential equation, what signs ( , , or ) are possible on the right-hand side? What does this tell you about the solution curves for the model?      For the graph in , which curve goes with which compartment of the SIR model? Justify your reasoning in two ways:    Use your sign analysis , that is, the work you just did on describing solution curves based on the sign ( , , or ) of the right-hand side of that compartment's differential equation in the SIR model.    Describe what happens in the Zombie Game App when we run a simulation including zombie mortality, and confirm that these curves make sense in that context.     One set of solution curves for the SIR model   Solution curves for the SIR model, unlabeled, for an exercise asking students to identify which curve represents which compartment in the model     "
},
{
  "id": "activity-total-population",
  "level": "2",
  "url": "ch-model-analysis-and-the-basic-reproduction-number-R0.html#activity-total-population",
  "type": "Activity",
  "number": "5.2",
  "title": "",
  "body": "  Consider the SIR model:   and define to be the total population being modeled, at time .  Each equation in this model represents the change in a single compartment's population, over time. How can we use the equations in the model to represent the change in total population over time? That is, how can we use the equations to represent ?  Determine the value of the change in total population : you should be able to compute a number. What does this number tell us about the total population in our model?    Add together the three differential equations. What is the meaning of the left-hand side? What is the meaning of the right-hand side? And what value do we obtain on the right-hand side when summing the differential equations?    On the left-hand side:   Therefore, summing the three differential equations determines the change over time of the total population.  On the right-hand side:   Since the three differential equations sum to zero, the change in total population is . This tells us that the total population in our model does not change. In other words, the size of the total population remains constant.   "
},
{
  "id": "activity-three-sets-of-parameters",
  "level": "2",
  "url": "ch-model-analysis-and-the-basic-reproduction-number-R0.html#activity-three-sets-of-parameters",
  "type": "Activity",
  "number": "5.3",
  "title": "",
  "body": "  Use the code below to create three different graphs of solution curves to an SIR model in which , , , and . The first set of values for and appear in the code block; change the code to get the other two sets of values. It may help you to save screenshots of each of the three graphs, so you can more easily see all three at the same time.    In the first graph, let and .    In the second graph, let and .    In the third graph, let and .    Then respond to the prompts below the code block.     What observations can you make, overall, about the three graphs? Take time with this question, and think expansively, before moving on to the next questions.    Discuss the similarities and differences in the curves in each of your three graphs. Include observations using our sign analysis from : when is rising or falling, and what does this have to do with the sign ( , , or ) of ?    Compare the long-term outcomes for and across the three graphs. What do you notice about the total number of people who ever became sick in each case?    Explore the role that changes to make to the outcome in each graph. Similarly, think through how changes to contribute to changes. For each parameter, decide first how you think changing the parameter will change the solution curves. Then use the code block to make several changes to that parameter, and compare what you see with what you thought you would see.        This is open-ended.    In the first two graphs, rises, then falls. For a sign analysis, first write out the differential equation for . Then substitute in the values of and and the initial values and to see that . Yet decreases rapidly, until , and at this time the curve falls.  In the third graph, the graph has a negative slope from the very beginning. A sign analysis shows why this makes sense, based on the initial value of .    In the first graph, everyone eventually gets sick. The long-term value of appears to be and the long-term value of appears to be , which is the total population.  In the second graph, not everyone gets sick in the outbreak. The curve appears to level out at a value of approximately . Extending t_range beyond can help for confirming this.  In the third graph, quite a few people avoid illness. Estimates for long-term values of and can confirm this.    There is much to say here. In general, increasing makes more people become sick, and makes infection happen more rapidly. Decreasing leads to more infections. The , , and graphs are all affected by these changes, and the answer to this prompt should include descriptions of these changes.     "
},
{
  "id": "p-355",
  "level": "2",
  "url": "ch-model-analysis-and-the-basic-reproduction-number-R0.html#p-355",
  "type": "Paragraph (with a defined term)",
  "number": "",
  "title": "",
  "body": "basic reproduction number "
},
{
  "id": "activity-formula-for-i-of-t-turning-around",
  "level": "2",
  "url": "ch-model-analysis-and-the-basic-reproduction-number-R0.html#activity-formula-for-i-of-t-turning-around",
  "type": "Activity",
  "number": "5.4",
  "title": "",
  "body": "  This activity examines the boundary between rising and falling numbers in the SIR model we have been studying. We will see that this boundary relates to important information about the basic reproduction number .  Begin by using the code below to try different values of and . Your goal is to find values for which the curve does not rise at first: instead, it stays level or falls. Keep the initial conditions the same, that is, , , and . If changing the range of values helps you see the outcome better, then change the end time to a smaller or larger value. However, keep the initial time .  Can you find more than one combination of and for which the curve does not rise?  You may wish to test your conclusions by viewing model output. To do this, you can modify the Python code provided as part of . Updating the end time of the model simulation may be helpful: rather than end at , consider extending the model for a longer period of time.   Next, consider the equation from the SIR model. Under what conditions must ? Think about these conditions biologically: what interpretations can you give the conditions?    The first part of this is open-ended. There are many combinations of and for which the curve falls from the start.  For the second part of this, set the right-hand side of the equation equal to 0 and factor:   This results in two possibilities: either or . There are multiple biological interpretations of each possibility.   "
},
{
  "id": "activity-r0-less-than-1",
  "level": "2",
  "url": "ch-model-analysis-and-the-basic-reproduction-number-R0.html#activity-r0-less-than-1",
  "type": "Activity",
  "number": "5.5",
  "title": "",
  "body": "  Here, we connect two ideas: the circumstances under which , according to our work in , and the formula for , as given in .  Start with the following result from : in order to have when , it must be that . Show how to rearrange the equation algebraically to get   Then answer the following questions.    When , is rising or falling?    When , is rising or falling?    In a typical outbreak, what changes to cause to transition in sign between being positive, negative, and ? What is the expected order of these signs, that is, out of , , and , which happens first in an outbreak, which happens second, and which happens third? Why is this the order?    After completing the above questions, next consider the formula from , which says that . Use the work you have already done in this activity, along with the definition of as being the average number of new infections caused by one infectious person in an otherwise entirely susceptible population , to describe what tells us about the behavior of early in an outbreak.    When , then , which means that the number of Infectious people is increasing. This typically happens early in an outbreak. As the outbreak continues, the value of becomes smaller, so that eventually (which means ), and then (which means and the number of Infectious people is decreasing).  With one infectious person in an otherwise entirely susceptible population , it is approximately true that , that is, that the Susceptible population is essentially the entire population. Therefore, is a way of indicating what happens to the population at the very start of an outbreak .   "
},
{
  "id": "exercise-13",
  "level": "2",
  "url": "ch-model-analysis-and-the-basic-reproduction-number-R0.html#exercise-13",
  "type": "Exercise",
  "number": "5.3.1",
  "title": "",
  "body": "Do some mathematical analysis of this SI model: In particular,   Sum the differential equations and use your results to describe how the total population being modeled changes over time.    Perform a sign analysis on the equation, indicating mathematically feasible ways in which the population can change during the time of the outbreak.    Perform a sign analysis on the equation, indicating mathematically feasible ways in which the population can change during the time of the outbreak.    Investigate the role of in changing the outcomes of the model. Describe ways in which changing can change the outcomes, and describe what those changes are. Also describe ways in which the outcomes cannot be changed by changing .   "
},
{
  "id": "exercise-14",
  "level": "2",
  "url": "ch-model-analysis-and-the-basic-reproduction-number-R0.html#exercise-14",
  "type": "Exercise",
  "number": "5.3.2",
  "title": "",
  "body": "Imagine a new outbreak occurs in a small town of 5000 people. Let us suppose it makes sense to model this outbreak with an SIR model, where the compartments are Susceptible (people who are not sick but can become sick), Infectious (people who are currently able to spread the disease), and Removed (people who are no longer able to spread the disease and are unable to become sick again). At the start of the outbreak, a single person is Infectious, and the rest of the people are Susceptible.   Suppose that, in the early days of the outbreak, researchers estimate and . Compute the value of for this model. Then, based on the value of you compute, answer: what do you think will happen in the short term and in the long term of this outbreak?    Now suppose that the value of was instead approximated to be , yet it is still true that . Compute the value of in this case. With this value of , what do you anticipate for the short-term and long-term outcomes of the outbreak?    Now suppose this outbreak occurs in a town of 1000 people, with and . Compute the value of for the SIR model in this smaller town. Use this value of to describe what you think will happen in the short term and in the long term of this outbreak.    Adapt the Python code shown earlier in this chapter to produce graphs of the outcomes of the SIR models in parts (a), (b), and (c) above. Write a few sentences about how well your descriptions of short-term and long-term model outcomes are supported, or not supported, by the graphs.   "
},
{
  "id": "exercise-15",
  "level": "2",
  "url": "ch-model-analysis-and-the-basic-reproduction-number-R0.html#exercise-15",
  "type": "Exercise",
  "number": "5.3.3",
  "title": "",
  "body": "Most diseases we know of have . This makes sense: without rising numbers of Infectious people, we do not experience an epidemic. However, in rare cases, a disease emerges for which . One example is MERS, which stands for Middle East Respiratory Syndrome. The first identified case of MERS was in 2012. There is still a lot to learn about MERS, but multiple estimates indicate that the value of for MERS is less than one. This activity is motivated by the existence of diseases with . Suppose we study a disease for which and , that is, people are typically infectious for about ten days. Suppose we choose to model this disease with an SIR model similar to the models we have been using in this chapter: S stands for Susceptible, meaning people who are not sick but can become sick; I stands for Infectious, meaning people who are currently able to spread the disease, and R stands for Removed, meaning people who are no longer able to spread the disease and are unable to become sick again. In the case of a disease similar to MERS, the Removed compartment consists of both recoveries and deaths from the disease.   In an area with a population of 1000, rearrange to solve for the value of for this SIR model.    Suppose that at the start of the outbreak, 20 people are Infectious. Use the Python block below to visualize the outbreak over 200 days. Notice that the Python block includes three print commands. These print and label the last output values stored as sol , that is, the , , and values for the last value of time , namely .   Use caution: by default, the Python block does not contain the correct value for . Instead, replace the existing value with the value you computed in part (a).   Use the graphs to describe qualitatively what happens in this population that began with 20 Infectious people. Does the curve for the population begin falling from the very beginning? What happens to the curves for and ?    Incorporate the output from the print command, along with the visual output of the graphs. How many people, in total, were Infectious at some point during the time of this model? How does this compare with the initial 20 cases? How do you reconcile this result with the behavior of the curve and with the knowledge that in this model?   "
},
{
  "id": "ch-vaccines-and-incubation-periods",
  "level": "1",
  "url": "ch-vaccines-and-incubation-periods.html",
  "type": "Chapter",
  "number": "6",
  "title": "Vaccines and Incubation Periods",
  "body": " Vaccines and Incubation Periods      Explore the role of public health strategies in managing disease spread, using compartmental models    Strengthen understanding of the meaning of , which involves a single Infectious person in an otherwise entirely Susceptible population    Determine the threshold for what percentage of vaccine coverage reduces transmission enough so that the number of Infectious cases does not rise    Introduce the SEIR model, where E stands for Exposed-and-incubating , meaning people in the E compartment have already contracted an illness but have not yet become infectious to others      In the first few chapters of this text, we have introduced the basic hows for compartmental modeling, as well as a few of the whys . Now, we explore the whys even further.  One of the most significant ways to use models is for trying and comparing possible public health strategies in simulations before actually carrying them out with real people. Professional-level models can be quite detailed and depend on large amounts of data, and compartmental models are just one of the many types of models implemented. In this chapter, we work with one commonly used strategy: vaccination Vaccination is a widely used public health strategy. Yet the author of this text recognizes that reader thoughts on vaccines may vary for many reasons. As mentioned way back in the To Students preface, I will not tell you how to think. Instead, the goal of showing vaccines in models is to demonstrate some of the ways we can use models to try different scenarios. Readers can and should continue to think about their own ethics and experiences when interpreting and discussing models .  Begin in by adjusting a model in a particular way to reduce the occurrence of new infections.   Reducing New Infections   This exploration seeks to reduce the number of new infections by directly reducing the transmission part of the compartmental SIR model shown in , , and . To reduce transmission, we multiply by a term :   This change to the model reflects that the term in the SIR model represents transmission of disease from the Infectious to the Susceptible population. To reduce transmission, we therefore change the specific term by introducing the multiplier .  Work through the parts below to build understanding of the term and the permissible values of .    Read the Python code below. Think through the factor that is multiplied by in both the and equations. We restrict the possible values of so that it must be true that .  After reading and evaluating the Python code, respond to the questions that follow.     Given the restriction that , what is the range of possible values for the term ?    When we multiply the transmission term by , for viable values of , what is the effect? Describe in terms of numbers, in terms of the graphical output of the Python code, and in terms of the impact on a disease outbreak.      These questions get more specific about the value of . Think logically and mathematically about your answers, and use the Python code freely to experiment with . To help you build a strong sense of the role of in the SIR model, you may wish to change the time range, include other information we have seen in past simulations, or make other changes to the code.    What sorts of effects do you see from the term when the value of is relatively small, that is, is just above ? In contrast, what sorts of effects do you see from the term when the value of is relatively large, that is, is just below ?    What can you say about the boundary values of ? That is, what sorts of effects does the term have on the SIR model when or when ?    Pulling ideas together: as the value of increases from to , what observations can you make about the output of the SIR model?        Vaccines in Compartmental Models  The modeling in this section focuses on reducing transmission of a disease through the use of vaccines . We use the multiplier from , along with the concept of from , to demonstrate the effect of vaccines on the number of people who ever become Infectious in a disease outbreak.  As a reminder, the basic reproduction number  is the average number of new infections caused by one infectious person in an otherwise entirely susceptible population. This means that is not a number we can use to directly describe a population that has been vaccinated against a disease, since a vaccinated population is not entirely susceptible. Instead, we introduce an effective reproduction number  , which is the average number of new infections caused by one infectious person in a population that may not be entirely susceptible, such as a population that has had access to vaccination. One way to pronounce the symbol is R effective .  We cannot change the intrinsic value of , but with vaccination, we can work toward the goal of having . If in a model that includes vaccines or other public health interventions, then overall numbers of Infectious people do not rise over time. With a few lines of algebra, we can build a relationship between , , and .  First, we should state a definition for . We define to be the fraction of people vaccinated against a disease, noting that the values of are therefore restricted to , where means no one is vaccinated, and means of the population is vaccinated. Initially, we will think of vaccination as being effective. In the last exercise of , we update our models to include vaccines that are less than effective. When the fraction of people are vaccinated, the remaining fraction are not vaccinated. Since refers to an entirely susceptible population, but only the fraction of the population is susceptible, we see that the average number of new infections caused by one infectious person in the vaccinated population is . In other words:   Our goal in the next few mathematical steps is to use to determine a value of for which . The goal of was set out in the 1983 paper Parasitic Infections as Regulators of Animal Populations by Robert M. May, published in American Scientist in the January-February issue. Additional details and explanation appear in the 1988 textbook Mathematical Models in Biology by Leah Edelstein-Keshet, published by McGraw-Hill. Such a value of corresponds to a vaccination rate high enough that a disease cannot become an outbreak because means that the overall numbers in the population are not expected to rise. Read carefully through the following mathematical steps to see how this value of is computed:    In the lines above, we started with our goal of causing to be less than one. We then made a substitution using and rearranged algebraically until we found a formula showing values of that satisfied our goal. Notice that to compute the next-to-last line, we divided by without changing the direction of the inequality, which assumed that . This assumption makes biological sense, and is important to point out mathematically, as biology and mathematics should support each other throughout the modeling process.  We now note a particular, special value of that is the threshold between two outcomes, which makes it a critical value . The two outcomes are having, or not having, an outbreak. We therefore name this critical value of to be :   Investigate the critical value , and the accompanying threshold between outbreak and no outbreak, in .    In this activity, we explore through the comparison of two historically widespread diseases: smallpox and measles.    We begin by examining smallpox. Estimates for the value of for smallpox range from 3.5 to 6. Estimates that come from the paper Transmission potential of smallpox in contemporary populations by Raymond Gani and Steve Leach, published in the journal Nature on 13 December 2001. Given this range of values, what is the range of values required in order to reduce the value of for smallpox so that ? Suppose that a effective vaccine is available. What percentage of people would need to be vaccinated, using the values of you computed, to prevent a smallpox outbreak, that is, to cause ?    Next, we examine measles. Many estimates for the value of for measles range from 12 to 18. The paper The basic reproduction number (R0) of measles: a systematic review , by Fiona M Guerra, Shelly Bolotin, Gillian Lim, Jane Heffernan, Shelley L Deeks, Ye Li, and Natasha S Crowcroft, states that is often approximated as , while also stating that the actual range of for measles varies even more. This paper was published in The Lancet Infectious Diseases on 27 July 2017. Given this range of values, what is the range of values required in order to reduce the value of for measles so that ? Suppose that a effective vaccine is available. What percentage of people would need to be vaccinated, using the values of you computed, to prevent a measles outbreak, that is, to cause ?    Smallpox has been eliminated: the last natural occurrence was in 1977, and in 1980, the World Health Organization stated that smallpox had been globally eradicated. Measles has not been eliminated: widespread vaccination has reduced cases drastically in many parts of the world, but measles continues to circulate. Given your results in this activity about the values of for smallpox and measles, write a few sentences about how contributes toward making it more or less feasible to vaccinate enough people to eliminate a disease.        For smallpox, , meaning approximately of people need to be vaccinated to prevent an outbreak.    For measles, , meaning approximately of people need to be vaccinated to prevent an outbreak.    This is open-ended. A typical answer may state that higher values of mean we need higher levels of vaccination. Answers may also investigate the reasons why it becomes so much more difficult to achieve higher levels of vaccination, especially on a global scale.      The investigations of asked you to compute values of for specific diseases. Another aspect of is that achieving this critical vaccination level means only that the infection curve, that is, the curve, falls from the beginning rather than rising first. However, this does not mean that there are no new infections after the initial cases. Explore this further in .    This activity focuses on understanding long-term model outcomes, with an emphasis on , the critical vaccine coverage value defined in . Another emphasis is on adjusting our Python code in order to make sure its output truly demonstrates the answers to the questions we are asking.  We use the following SIR model with a term to indicate the unvaccinated fraction of people:   In the default Python code shown below, , , , the initial population values are , , and , and time runs from to days. Begin by running the code, and then work through the steps below to make specific changes to the model.     How many people have had this illness at some point in time, according to this model with its default values? To answer this: notice that everyone who reaches the R compartment must have been sick at some time, so the long-term value of provides the answer. Also notice that we need to make sure to run the model long enough that reaches . Only then will be evaluated at a large enough value of for us to know the total number of people who become ill.    Compute the value for this model, showing your work. Then run the model using the value you computed for and re-answer the question above: how many people get the illness at some point in time, according to this model, when ?    Compare your answer above, regarding how many people get the illness at some time in the situation when , with the initial number of Infectious people in the model. How many people must have gotten the illness sometime after the original Infectious people? Notice that this means that even when , a significant number of additional people can contract the illness being studied. However, the Infectious population curve does not rise: it instead appears as level or decreasing.    We may want to see for ourselves, or demonstrate to others, that the Infectious curve is truly not rising when . The default graph in the Python code for this activity is not the most helpful to us because is so large relative to , which makes it challenging to see the details of the curvature of the curve. To see just the curve, then, we can comment out the lines of code that show the and curves. Do this: comment out those lines, and produce a graph showing just the curve.        The default model says the long-term value of is , but at , there are still people in the compartment. Use a larger value of to find that people have the illness at some time during the outbreak. (State, and show, how large you made your value of .)    The value of is , using to compute and then to compute . Approximating as and setting a large enough value of leads to the conclusion that total people have the illness at some time.    The answer above said that people had the illness at some time, and we used the value . This means that after the initial people, another got the illness. (For readers who approximated differently than , your answers may vary somewhat.)    The first and third lines after #Plotting commands are below should be commented out, that is, the symbol # should be placed at the start of each of these lines. Then run the code block again to produce just the graph.      We now pause our modeling for a moment to provide some extra vocabulary and commentary on vaccines. When vaccines are studied and approved for use, researchers demonstrate their efficacy and effectiveness . Both terms consider how many people within a population of vaccinated individuals get a disease, compared with how many people within a comparable population of unvaccinated individuals get the same disease. If, for instance, fewer people in the vaccinated population get the disease, then we say the vaccine has an efficacy or effectiveness of . Notice what the does NOT mean: it does NOT mean that only of people are protected by the vaccine, or that the vaccine only works  of the time. The word efficacy specifies that the comparison of vaccinated and unvaccinated populations happens within a clinical trial. The word effectiveness indicates that the vaccine is being studied for populations in the real world. While clinical trials do include a range of different people, effectiveness often differs from efficacy.  Nice explanations of the meanings of efficacy and effectiveness can be found at the Vaccine efficacy, effectiveness and protection page from the World Health Organization.  Vaccine outcomes extend beyond affecting disease transmission. One common outcome is reducing the intensity of illness in individuals who have been vaccinated, yet who still become sick. This and other outcomes can be included in models, however such models tend to be more detailed than those we are studying right now. For this reason, this chapter focuses only on vaccine models that show reduced transmission.  Much of this section has focused on vaccines, which are a valuable element of compartmental models. Another important aspect of disease spread is the incubation period of an illness. The SEIR model, described in , incorporates this incubation period.    Including an Incubation Period: The SEIR Model  We introduce here the SEIR model . The new compartment, E, stands for Exposed-and-incubating . The population therefore represents people who have contracted an illness, but who are not yet infectious. As the name SEIR suggests, this model has four compartments.  Now that we have worked with the SI and SIR models, you may well have ideas in mind for how the SEIR model should look. Try these out in .    How do you believe the SEIR model should appear? Demonstrate your ideas for this activity:    Draw the SEIR model as a compartmental diagram. Carefully label each compartment and each arrow. Do not include vaccination in this model.    Write the differential equations of the SEIR model. Do not include vaccination.    Compare the compartmental diagram you drew with the differential equations you wrote. Are they compatible with each other? That is, do they describe the same model, with the same flow of people through compartments?        One possible compartmental diagram appears below.   Compartmental diagram of a model of HIV\/AIDS, using descriptions instead of formulas for each arrow   (Write this)     One key aspect of this diagram is that the term appears on the arrow from to . In the SIR model, the arrow from to involved exactly the compartments at its beginning and end, but with the SEIR model, there is a different pattern.  Notice the arrow labeled . The flow out of the E compartment depends only on the population and the amount of time typically spent as Exposed-and-incubating, similar to how the flow out of the I compartment in the SIR and SEIR models depends only on the population and the amount of time spent as Infectious. An important comment here is that this answer key uses the parameter for the rate governing the flow out of the E compartment, but there is no reason at all that you should have chosen the Greek letter for this rate! Whatever letter you chose, as long as it is not a letter already in use elsewhere in the model, is an excellent choice.    The following differential equations represent the SEIR model:   Your answer should look similar, but you may have selected a different parameter instead of .    Your answers for the first two parts should definitely be compatible. If they are not, whether in this activity or ever in your modeling career, then that is a time to re-evaluate your work. This is one of many ways we can double-check our modeling work: when we describe a model in different formats, such as in a diagram and by means of equations, the different formats should agree with each other.      Now that you have built an SEIR model in , you can explore its compartmental diagram and differential equations. To start, notice that we can estimate the value of similarly to how we estimated the value of in and , using the average incubation time for a disease:   or:   Next, it is helpful with the newly introduced SEIR model to envision how solutions should look, understand how the value of the new parameter affects solutions, and simply play around with the equations and different parameter values so that you can build your intuition for this model. Begin these investigations in .    This activity provides a venue for you to play with the SEIR model. Begin by thinking through how you expect SEIR solution curves to appear, and then use Python code to create these solutions and see how they respond to changing parameters.    Do a brief sign analysis of the SEIR model. Is it possible for the , , or curves in the SEIR model to behave in any ways that are fundamentally different than how these curves behave in the SIR model? In particular: within we discussed the ways these three curves in the SIR model could fall, or rise and fall, or rise. Can these curves behave any differently in the SEIR model? And what does sign analysis tell you about how the model can possibly behave?    Run the Python code below, and observe the curve . Does it behave the way you predicted in the first part of this Activity? (It should.)  Next, make a note of the long-term number of people who become sick in this model. Then make larger and note the newly computed long-term number of people who become sick in the model. Try this for multiple values of . What pattern(s) do you observe?    Continue the Python investigation of different values of . Start with , then run the model with , , and so on, up to . Describe how the curve changes as goes through these changes. Notice that you can focus in on the curve by commenting out the other three solution curves, similarly to how we did in .         As in the SIR model: the curve can only fall or remain level. The curve can both rise and fall, and can remain level. The curve can only rise or remain level.  Sign analysis of the SEIR model shows that the curve has the possibilities of both rising and falling, as well as remaining level.    You should observe that regardless of the value of , the long-term value of is 1960, given the other default values in the Python code. There are many additional observations you can make about the dynamics of how the population reaches its long-term values, and the next part of this Activity addresses several such observations.    As increases, the curve tends to reach lower and lower peak values, and these peak values occur at earlier times . Sample curves, with their values, appear in the graph below.   Possible curves for the SEIR model, with varying   Solution curves for the E compartment in the SEIR model, each with a different value of kappa, ranging from kappa = 0.1 to kappa = 1.0. As kappa increases, the curves have lower peaks, and the peaks occur at earlier times        For readers including on computing , you may wish to try the steps for computing in the SEIR model. The answer appears below, yet this is a great time to test yourself. Completing the steps and confirming your results below lets you gain practice now, before perhaps trying to compute on a future model where no answer is given.  The resulting formula is:   The formula in can be rearranged in order to use information about , , and to compute a reasonable range of values in a model. We have seen how to estimate and in , , , and . We therefore have the ability to determine the parameter values for an SEIR model of a specific outbreak. Try this in .    We are now ready to set up a compartmental model for whooping cough, also called pertussis, in a fictional town having 10,000 residents, using information from the New York State Pertussis or Whooping Cough Fact Sheet . The fact sheet says that the first stage of pertussis, in which symptoms are similar to those of a cold, lasts one to two weeks. Stage two, which includes the severe cough that gave pertussis the name whooping cough , lasts one to two months. The fact sheet also says that pertussis is contagious from the time cold symptoms appear until about three weeks after severe cough starts. The incubation period for pertussis is most often seven to ten days: the incubation period can sometimes be longer, but we focus on the most common lengths of time. We will not include the use of antibiotics in this model.    Use the SEIR model below. Determine as many parameter values as you can, using the information described from the fact sheet. In this model, assume that time is measured in days. It is appropriate for some parameter values to be a range of numbers, rather than a single number, since the fact sheet information includes ranges of time.     You should now have determined the range of values for all parameters except . Here is extra information: the value of for pertussis has been estimated at anywhere from 5.5 to 17, depending on the outbreak in which was measured. A nice summary of studies of for pertussis appears in Pertussis: Microbiology, Disease, Treatment, and Prevention by Paul E. Kilgore, Abdulbaset M. Salim, Marcus J. Zervos, Heinz-Josef Schmitt, published in Clinical Microbiology Reviews in on March 30, 2016. Use this range of values of , along with the parameters you already determined and the formula in for , to solve for .    Run the Python code below, making sure to first enter the values from the parameter ranges you have computed for , , and . (These parameter values are set to 0 in the code, so visualizing the model requires you entering the values you determine.) Notice that the code will compute the appropriate value of , using the total population of 10,000 and the values you assign to and . Make observations about the outcomes of the model. Be sure to adjust the length of time the model runs, or to show just one or two solution curves at a time, or to otherwise alter the code so that you can best see and comment on the results of the model.         The incubation period is usually 7 to 10 days, so is in the range . (The incubation period can be shorter or longer, and if you included this information, you will have a wider range of values for . This is also valid.)  Pertussis begins to be contagious when cold symptoms appear, and the phase for cold symptoms is one to two weeks. Pertussis is most contagious for up to three weeks after the intense coughing phase begins. Adding these phases together, pertussis is contagious, or most contagious, for four to five weeks, meaning 28 to 35 days. So is in the range . (Saying up to three weeks suggests people may not be contagious the full three weeks. And pertussis may be contagious, at a lower level, more than three weeks after severe cough begins. You may have built either of these facts into your answer, which may lead to a different answer.)    Rearranging leads to . Using the range of values and , along with , gives the range of values . Your range of values should be based on the parameter values you determined.    This is open-ended. Make as many observations as you can.      Now that we have discussed public health intervention in the form of vaccines, as well as SI, SIR, and SEIR models, we have learned enough to be able to mathematically model the primary dynamics of many disease outbreaks. These ideas are the core of this course. In we will think through the big ideas inherent in mathematical modeling. The remaining chapters in focus on connecting data with models and working with two additional ways to significantly extend our use of compartmental models: endemic disease, in , and modeling ideas other than diseases, in .    Redo , but convert the time unit to weeks instead of days . To make this change, do the following.   Compute the number of weeks for the incubation period of pertussis. This should be . When you then compute , you should obtain a value equal to .    Similarly, the value of in this exercise should be .    For the graphs to appear the same, the horizontal axis should be adjusted. To be precise, the length of the new time axis should equal . To be close, use the nearest number of weeks. For instance, the default time length in the previous exercise is 365 days, which is one year. One year has approximately, but not exactly, 52 weeks. Using 52 weeks in this exercise will give a very similar graph to the 365-day graph from the previous exercise.   Explain mathematically why the unit conversions described in parts (a.), (b.), and (c.) are the correct conversions for converting the model's time scale from days to weeks. Show graphs from both this exercise and the previous exercise to demonstrate that the model results are the same when we convert the units of time. For better clarity: update the label for the time axis in each graph to say days or weeks instead of time , to make clear which time unit is being used in the graph.  Update to include vaccine. Include the multiplier where appropriate, adapting our work from and to the SEIR model.   Compute for pertussis, using the information that for pertussis can be between 5.5 and 17, depending on the outbreak. Your results for will be a range of values.    Adapt the Python code from the second exercise to run the model with a vaccine level at least as large as . Adjust the time scale, show just some of the solution curve graphs, or make any other changes needed, to best see the long-term outcome of the model. Write your observations of the outcomes of this model, and compare and contrast with the no-vaccine model.    Do some online research to determine the percentage of children in your area, or percentage of all people in your area, who are vaccinated against pertussis. Your area can refer to your city, state, province, country, or whatever other region you choose. Run the Python code again, using this percentage for vaccination, and citing the resources in which you found the percentage. Adjust the code as needed so you can best see the results, and describe your findings.    In approximately 2019, researchers found that the whooping cough vaccine had become less effective over time, for a variety of reasons. They investigated the reasons and made changes. Read about this in from at least three sources, including general news sources as well as government-led websites, and report on your findings.    We make one more update to the pertussis model in , addressing vaccine efficacy. Our inclusion of the multiplier assumed that vaccination had efficacy or effectiveness. However, research into pertussis vaccines shows that the level of vaccine efficacy or effectiveness can be significantly less. There is a wide range of values, depending on the specific vaccine used, the location in the world, and the years of study. For this exercise, we use a range of efficacy. This range of vaccine efficacy level comes from the Centers for Disease Control and Prevention . The range is specific to the DTaP vaccine, in Europe and the Americas, in studies in or after 1991.    Rewrite your model as below, where remains the percentage of people vaccinated, and is the efficacy percentage. We require that and . Explain in words why the way the model is written, and the ranges for and , make sense. In your explanation, include edge cases , that is, describe what happens when , , , and . Also describe what happens as increases from to , and what happens as increases from to .     Use the Python code from to incorporate vaccine efficacy. Use logic, as well as results from your code, to explain how vaccine efficacy below can make it more challenging to achieve the goal of . In your explanation, you may wish to use the information that used the assumption that vaccine was effective.     "
},
{
  "id": "objectives-6",
  "level": "2",
  "url": "ch-vaccines-and-incubation-periods.html#objectives-6",
  "type": "Goals",
  "number": "",
  "title": "",
  "body": "   Explore the role of public health strategies in managing disease spread, using compartmental models    Strengthen understanding of the meaning of , which involves a single Infectious person in an otherwise entirely Susceptible population    Determine the threshold for what percentage of vaccine coverage reduces transmission enough so that the number of Infectious cases does not rise    Introduce the SEIR model, where E stands for Exposed-and-incubating , meaning people in the E compartment have already contracted an illness but have not yet become infectious to others     "
},
{
  "id": "expl-activity-vaccines",
  "level": "2",
  "url": "ch-vaccines-and-incubation-periods.html#expl-activity-vaccines",
  "type": "Exploration",
  "number": "6.1",
  "title": "Reducing New Infections.",
  "body": " Reducing New Infections   This exploration seeks to reduce the number of new infections by directly reducing the transmission part of the compartmental SIR model shown in , , and . To reduce transmission, we multiply by a term :   This change to the model reflects that the term in the SIR model represents transmission of disease from the Infectious to the Susceptible population. To reduce transmission, we therefore change the specific term by introducing the multiplier .  Work through the parts below to build understanding of the term and the permissible values of .    Read the Python code below. Think through the factor that is multiplied by in both the and equations. We restrict the possible values of so that it must be true that .  After reading and evaluating the Python code, respond to the questions that follow.     Given the restriction that , what is the range of possible values for the term ?    When we multiply the transmission term by , for viable values of , what is the effect? Describe in terms of numbers, in terms of the graphical output of the Python code, and in terms of the impact on a disease outbreak.      These questions get more specific about the value of . Think logically and mathematically about your answers, and use the Python code freely to experiment with . To help you build a strong sense of the role of in the SIR model, you may wish to change the time range, include other information we have seen in past simulations, or make other changes to the code.    What sorts of effects do you see from the term when the value of is relatively small, that is, is just above ? In contrast, what sorts of effects do you see from the term when the value of is relatively large, that is, is just below ?    What can you say about the boundary values of ? That is, what sorts of effects does the term have on the SIR model when or when ?    Pulling ideas together: as the value of increases from to , what observations can you make about the output of the SIR model?     "
},
{
  "id": "p-429",
  "level": "2",
  "url": "ch-vaccines-and-incubation-periods.html#p-429",
  "type": "Paragraph (with a defined term)",
  "number": "",
  "title": "",
  "body": "effective reproduction number "
},
{
  "id": "p-434",
  "level": "2",
  "url": "ch-vaccines-and-incubation-periods.html#p-434",
  "type": "Paragraph (with a defined term)",
  "number": "",
  "title": "",
  "body": "critical value "
},
{
  "id": "activity-pcrit",
  "level": "2",
  "url": "ch-vaccines-and-incubation-periods.html#activity-pcrit",
  "type": "Activity",
  "number": "6.2",
  "title": "",
  "body": "  In this activity, we explore through the comparison of two historically widespread diseases: smallpox and measles.    We begin by examining smallpox. Estimates for the value of for smallpox range from 3.5 to 6. Estimates that come from the paper Transmission potential of smallpox in contemporary populations by Raymond Gani and Steve Leach, published in the journal Nature on 13 December 2001. Given this range of values, what is the range of values required in order to reduce the value of for smallpox so that ? Suppose that a effective vaccine is available. What percentage of people would need to be vaccinated, using the values of you computed, to prevent a smallpox outbreak, that is, to cause ?    Next, we examine measles. Many estimates for the value of for measles range from 12 to 18. The paper The basic reproduction number (R0) of measles: a systematic review , by Fiona M Guerra, Shelly Bolotin, Gillian Lim, Jane Heffernan, Shelley L Deeks, Ye Li, and Natasha S Crowcroft, states that is often approximated as , while also stating that the actual range of for measles varies even more. This paper was published in The Lancet Infectious Diseases on 27 July 2017. Given this range of values, what is the range of values required in order to reduce the value of for measles so that ? Suppose that a effective vaccine is available. What percentage of people would need to be vaccinated, using the values of you computed, to prevent a measles outbreak, that is, to cause ?    Smallpox has been eliminated: the last natural occurrence was in 1977, and in 1980, the World Health Organization stated that smallpox had been globally eradicated. Measles has not been eliminated: widespread vaccination has reduced cases drastically in many parts of the world, but measles continues to circulate. Given your results in this activity about the values of for smallpox and measles, write a few sentences about how contributes toward making it more or less feasible to vaccinate enough people to eliminate a disease.        For smallpox, , meaning approximately of people need to be vaccinated to prevent an outbreak.    For measles, , meaning approximately of people need to be vaccinated to prevent an outbreak.    This is open-ended. A typical answer may state that higher values of mean we need higher levels of vaccination. Answers may also investigate the reasons why it becomes so much more difficult to achieve higher levels of vaccination, especially on a global scale.     "
},
{
  "id": "activity-pcrit2",
  "level": "2",
  "url": "ch-vaccines-and-incubation-periods.html#activity-pcrit2",
  "type": "Activity",
  "number": "6.3",
  "title": "",
  "body": "  This activity focuses on understanding long-term model outcomes, with an emphasis on , the critical vaccine coverage value defined in . Another emphasis is on adjusting our Python code in order to make sure its output truly demonstrates the answers to the questions we are asking.  We use the following SIR model with a term to indicate the unvaccinated fraction of people:   In the default Python code shown below, , , , the initial population values are , , and , and time runs from to days. Begin by running the code, and then work through the steps below to make specific changes to the model.     How many people have had this illness at some point in time, according to this model with its default values? To answer this: notice that everyone who reaches the R compartment must have been sick at some time, so the long-term value of provides the answer. Also notice that we need to make sure to run the model long enough that reaches . Only then will be evaluated at a large enough value of for us to know the total number of people who become ill.    Compute the value for this model, showing your work. Then run the model using the value you computed for and re-answer the question above: how many people get the illness at some point in time, according to this model, when ?    Compare your answer above, regarding how many people get the illness at some time in the situation when , with the initial number of Infectious people in the model. How many people must have gotten the illness sometime after the original Infectious people? Notice that this means that even when , a significant number of additional people can contract the illness being studied. However, the Infectious population curve does not rise: it instead appears as level or decreasing.    We may want to see for ourselves, or demonstrate to others, that the Infectious curve is truly not rising when . The default graph in the Python code for this activity is not the most helpful to us because is so large relative to , which makes it challenging to see the details of the curvature of the curve. To see just the curve, then, we can comment out the lines of code that show the and curves. Do this: comment out those lines, and produce a graph showing just the curve.        The default model says the long-term value of is , but at , there are still people in the compartment. Use a larger value of to find that people have the illness at some time during the outbreak. (State, and show, how large you made your value of .)    The value of is , using to compute and then to compute . Approximating as and setting a large enough value of leads to the conclusion that total people have the illness at some time.    The answer above said that people had the illness at some time, and we used the value . This means that after the initial people, another got the illness. (For readers who approximated differently than , your answers may vary somewhat.)    The first and third lines after #Plotting commands are below should be commented out, that is, the symbol # should be placed at the start of each of these lines. Then run the code block again to produce just the graph.     "
},
{
  "id": "p-455",
  "level": "2",
  "url": "ch-vaccines-and-incubation-periods.html#p-455",
  "type": "Paragraph (with a defined term)",
  "number": "",
  "title": "",
  "body": "efficacy effectiveness "
},
{
  "id": "p-459",
  "level": "2",
  "url": "ch-vaccines-and-incubation-periods.html#p-459",
  "type": "Paragraph (with a defined term)",
  "number": "",
  "title": "",
  "body": "SEIR model "
},
{
  "id": "activity-seir-model-intro",
  "level": "2",
  "url": "ch-vaccines-and-incubation-periods.html#activity-seir-model-intro",
  "type": "Activity",
  "number": "6.4",
  "title": "",
  "body": "  How do you believe the SEIR model should appear? Demonstrate your ideas for this activity:    Draw the SEIR model as a compartmental diagram. Carefully label each compartment and each arrow. Do not include vaccination in this model.    Write the differential equations of the SEIR model. Do not include vaccination.    Compare the compartmental diagram you drew with the differential equations you wrote. Are they compatible with each other? That is, do they describe the same model, with the same flow of people through compartments?        One possible compartmental diagram appears below.   Compartmental diagram of a model of HIV\/AIDS, using descriptions instead of formulas for each arrow   (Write this)     One key aspect of this diagram is that the term appears on the arrow from to . In the SIR model, the arrow from to involved exactly the compartments at its beginning and end, but with the SEIR model, there is a different pattern.  Notice the arrow labeled . The flow out of the E compartment depends only on the population and the amount of time typically spent as Exposed-and-incubating, similar to how the flow out of the I compartment in the SIR and SEIR models depends only on the population and the amount of time spent as Infectious. An important comment here is that this answer key uses the parameter for the rate governing the flow out of the E compartment, but there is no reason at all that you should have chosen the Greek letter for this rate! Whatever letter you chose, as long as it is not a letter already in use elsewhere in the model, is an excellent choice.    The following differential equations represent the SEIR model:   Your answer should look similar, but you may have selected a different parameter instead of .    Your answers for the first two parts should definitely be compatible. If they are not, whether in this activity or ever in your modeling career, then that is a time to re-evaluate your work. This is one of many ways we can double-check our modeling work: when we describe a model in different formats, such as in a diagram and by means of equations, the different formats should agree with each other.     "
},
{
  "id": "activity-seir-model-play-with-kappa",
  "level": "2",
  "url": "ch-vaccines-and-incubation-periods.html#activity-seir-model-play-with-kappa",
  "type": "Activity",
  "number": "6.5",
  "title": "",
  "body": "  This activity provides a venue for you to play with the SEIR model. Begin by thinking through how you expect SEIR solution curves to appear, and then use Python code to create these solutions and see how they respond to changing parameters.    Do a brief sign analysis of the SEIR model. Is it possible for the , , or curves in the SEIR model to behave in any ways that are fundamentally different than how these curves behave in the SIR model? In particular: within we discussed the ways these three curves in the SIR model could fall, or rise and fall, or rise. Can these curves behave any differently in the SEIR model? And what does sign analysis tell you about how the model can possibly behave?    Run the Python code below, and observe the curve . Does it behave the way you predicted in the first part of this Activity? (It should.)  Next, make a note of the long-term number of people who become sick in this model. Then make larger and note the newly computed long-term number of people who become sick in the model. Try this for multiple values of . What pattern(s) do you observe?    Continue the Python investigation of different values of . Start with , then run the model with , , and so on, up to . Describe how the curve changes as goes through these changes. Notice that you can focus in on the curve by commenting out the other three solution curves, similarly to how we did in .         As in the SIR model: the curve can only fall or remain level. The curve can both rise and fall, and can remain level. The curve can only rise or remain level.  Sign analysis of the SEIR model shows that the curve has the possibilities of both rising and falling, as well as remaining level.    You should observe that regardless of the value of , the long-term value of is 1960, given the other default values in the Python code. There are many additional observations you can make about the dynamics of how the population reaches its long-term values, and the next part of this Activity addresses several such observations.    As increases, the curve tends to reach lower and lower peak values, and these peak values occur at earlier times . Sample curves, with their values, appear in the graph below.   Possible curves for the SEIR model, with varying   Solution curves for the E compartment in the SEIR model, each with a different value of kappa, ranging from kappa = 0.1 to kappa = 1.0. As kappa increases, the curves have lower peaks, and the peaks occur at earlier times       "
},
{
  "id": "activity-seir-model-pertussis-setup",
  "level": "2",
  "url": "ch-vaccines-and-incubation-periods.html#activity-seir-model-pertussis-setup",
  "type": "Activity",
  "number": "6.6",
  "title": "",
  "body": "  We are now ready to set up a compartmental model for whooping cough, also called pertussis, in a fictional town having 10,000 residents, using information from the New York State Pertussis or Whooping Cough Fact Sheet . The fact sheet says that the first stage of pertussis, in which symptoms are similar to those of a cold, lasts one to two weeks. Stage two, which includes the severe cough that gave pertussis the name whooping cough , lasts one to two months. The fact sheet also says that pertussis is contagious from the time cold symptoms appear until about three weeks after severe cough starts. The incubation period for pertussis is most often seven to ten days: the incubation period can sometimes be longer, but we focus on the most common lengths of time. We will not include the use of antibiotics in this model.    Use the SEIR model below. Determine as many parameter values as you can, using the information described from the fact sheet. In this model, assume that time is measured in days. It is appropriate for some parameter values to be a range of numbers, rather than a single number, since the fact sheet information includes ranges of time.     You should now have determined the range of values for all parameters except . Here is extra information: the value of for pertussis has been estimated at anywhere from 5.5 to 17, depending on the outbreak in which was measured. A nice summary of studies of for pertussis appears in Pertussis: Microbiology, Disease, Treatment, and Prevention by Paul E. Kilgore, Abdulbaset M. Salim, Marcus J. Zervos, Heinz-Josef Schmitt, published in Clinical Microbiology Reviews in on March 30, 2016. Use this range of values of , along with the parameters you already determined and the formula in for , to solve for .    Run the Python code below, making sure to first enter the values from the parameter ranges you have computed for , , and . (These parameter values are set to 0 in the code, so visualizing the model requires you entering the values you determine.) Notice that the code will compute the appropriate value of , using the total population of 10,000 and the values you assign to and . Make observations about the outcomes of the model. Be sure to adjust the length of time the model runs, or to show just one or two solution curves at a time, or to otherwise alter the code so that you can best see and comment on the results of the model.         The incubation period is usually 7 to 10 days, so is in the range . (The incubation period can be shorter or longer, and if you included this information, you will have a wider range of values for . This is also valid.)  Pertussis begins to be contagious when cold symptoms appear, and the phase for cold symptoms is one to two weeks. Pertussis is most contagious for up to three weeks after the intense coughing phase begins. Adding these phases together, pertussis is contagious, or most contagious, for four to five weeks, meaning 28 to 35 days. So is in the range . (Saying up to three weeks suggests people may not be contagious the full three weeks. And pertussis may be contagious, at a lower level, more than three weeks after severe cough begins. You may have built either of these facts into your answer, which may lead to a different answer.)    Rearranging leads to . Using the range of values and , along with , gives the range of values . Your range of values should be based on the parameter values you determined.    This is open-ended. Make as many observations as you can.     "
},
{
  "id": "exercise-16",
  "level": "2",
  "url": "ch-vaccines-and-incubation-periods.html#exercise-16",
  "type": "Exercise",
  "number": "6.3.1",
  "title": "",
  "body": "Redo , but convert the time unit to weeks instead of days . To make this change, do the following.   Compute the number of weeks for the incubation period of pertussis. This should be . When you then compute , you should obtain a value equal to .    Similarly, the value of in this exercise should be .    For the graphs to appear the same, the horizontal axis should be adjusted. To be precise, the length of the new time axis should equal . To be close, use the nearest number of weeks. For instance, the default time length in the previous exercise is 365 days, which is one year. One year has approximately, but not exactly, 52 weeks. Using 52 weeks in this exercise will give a very similar graph to the 365-day graph from the previous exercise.   Explain mathematically why the unit conversions described in parts (a.), (b.), and (c.) are the correct conversions for converting the model's time scale from days to weeks. Show graphs from both this exercise and the previous exercise to demonstrate that the model results are the same when we convert the units of time. For better clarity: update the label for the time axis in each graph to say days or weeks instead of time , to make clear which time unit is being used in the graph. "
},
{
  "id": "exercise-17",
  "level": "2",
  "url": "ch-vaccines-and-incubation-periods.html#exercise-17",
  "type": "Exercise",
  "number": "6.3.2",
  "title": "",
  "body": "Update to include vaccine. Include the multiplier where appropriate, adapting our work from and to the SEIR model.   Compute for pertussis, using the information that for pertussis can be between 5.5 and 17, depending on the outbreak. Your results for will be a range of values.    Adapt the Python code from the second exercise to run the model with a vaccine level at least as large as . Adjust the time scale, show just some of the solution curve graphs, or make any other changes needed, to best see the long-term outcome of the model. Write your observations of the outcomes of this model, and compare and contrast with the no-vaccine model.    Do some online research to determine the percentage of children in your area, or percentage of all people in your area, who are vaccinated against pertussis. Your area can refer to your city, state, province, country, or whatever other region you choose. Run the Python code again, using this percentage for vaccination, and citing the resources in which you found the percentage. Adjust the code as needed so you can best see the results, and describe your findings.    In approximately 2019, researchers found that the whooping cough vaccine had become less effective over time, for a variety of reasons. They investigated the reasons and made changes. Read about this in from at least three sources, including general news sources as well as government-led websites, and report on your findings.   "
},
{
  "id": "exercise-18",
  "level": "2",
  "url": "ch-vaccines-and-incubation-periods.html#exercise-18",
  "type": "Exercise",
  "number": "6.3.3",
  "title": "",
  "body": "We make one more update to the pertussis model in , addressing vaccine efficacy. Our inclusion of the multiplier assumed that vaccination had efficacy or effectiveness. However, research into pertussis vaccines shows that the level of vaccine efficacy or effectiveness can be significantly less. There is a wide range of values, depending on the specific vaccine used, the location in the world, and the years of study. For this exercise, we use a range of efficacy. This range of vaccine efficacy level comes from the Centers for Disease Control and Prevention . The range is specific to the DTaP vaccine, in Europe and the Americas, in studies in or after 1991.    Rewrite your model as below, where remains the percentage of people vaccinated, and is the efficacy percentage. We require that and . Explain in words why the way the model is written, and the ranges for and , make sense. In your explanation, include edge cases , that is, describe what happens when , , , and . Also describe what happens as increases from to , and what happens as increases from to .     Use the Python code from to incorporate vaccine efficacy. Use logic, as well as results from your code, to explain how vaccine efficacy below can make it more challenging to achieve the goal of . In your explanation, you may wish to use the information that used the assumption that vaccine was effective.   "
},
{
  "id": "ch-getting-the-answer-right-in-modeling",
  "level": "1",
  "url": "ch-getting-the-answer-right-in-modeling.html",
  "type": "Chapter",
  "number": "7",
  "title": "Getting the Answer Right in Modeling",
  "body": " Getting the Answer Right in Modeling      Appreciate that mathematical models by themselves are not right or wrong , but instead depend on logically addressing specific questions    Recognize that mathematical models reflect ethics and priorities, and that modelers should consider their ethics and priorities while constructing models    Embrace the process of updating models based on new data, different questions being asked, or for many other reasons    Commit to explaining models and their results clearly, using carefully chosen graphs and words     In this chapter, we pause and step back to consider the overall process of mathematical modeling .  Mathematical modeling allows us to represent real-world scenarios with mathematical formulas. Models may primarily reflect what is happening in the world, giving us a mathematical way to describe what we see. Alternately, we may use models to think about how to change what is happening in the world. We can make changes mathematically, trying ideas within models, before ever trying to implement those ideas as policies or medical interventions involving actual people.   Which Model(s) to Use?   So far, we have worked with the SI, SIR, and SEIR models. We have shown how to include vaccines in a model. And for those who completed the last exercise of , we showed how to include vaccines along with their efficacy or effectiveness. Now, think through choosing from these models for different scenarios.    Which model(s) would you choose to work with if you wanted to include a term such as to indicate vaccination? Why?    Which model(s) would allow you to change the length of time someone is Infectious, perhaps to test the outcome of a medication that reduces the length of time a person can infect others? Why does your choice of model(s) make sense?    Which model(s) would you use if you had an Infectious compartment in which individuals would always stay Infectious? Why?    Which model(s) would allow you to change the time scale from days to weeks? How would you know this is possible?    Many people believe that mathematics is all about getting the right answer . With mathematical modeling, there may not be a right answer , or even a best answer. For instance, in there may be multiple reasonable answers to some of the questions. In modeling, the answers we seek depend on the questions we ask, the priorities we set, the way we use models to explore these questions, and our ability to explain all these pieces of our thought process.  You could say that modeling consists of four components:    A logical approach ;    Stated priorities , which relate to both goals and ethics;    Making changes to models as we gain more information, to better represent a situation, to answer different questions, or to try alternate scenarios;    Well-constructed explanations of every decision and result.    We work through each of these in the sections below. We then use these ideas throughout the textbook.    The Logical Approach  Throughout mathematics, we set up statements in a particular logical way. We will see that researchers follow similar principles when describing mathematical models.  The structure of mathematical statements typically involves if and then statements, such as: If a polygon has six sides and six angles, then the polygon is a hexagon. The if statements are called assumptions . The then statements are called conclusions . A mathematical statement may include multiple assumptions and\/or multiple conclusions. The words if and then are not always included, so we as readers may need to think carefully about which parts of a mathematical statement are the assumptions and which parts are the conclusions.  Work through to build familiarity with identifying the assumptions and conclusions in mathematical statements.     For each of the following mathematical statements, specify the assumptions and the conclusions . There may be multiple assumptions and\/or conclusions per statement. The words if and\/or then may not appear explicitly. If cases when these words do not appear, it may help to rewrite the mathematical statement in a way that has the same logical meaning, yet that includes if and then in appropriate parts of the statement.  A note: you may recognize these statements, but it is completely OK if you do not recognize them. Naming the assumptions and conclusions is possible even if the statements are unfamiliar.    If a right triangle has legs with lengths and , and if the same triangle's hypotenuse has length , then the equation is true.    Suppose a function is continuous for -values satisfying . In this case, takes on every value between the numbers and .    Differentiable functions are continuous.        This is the most straightforward of the three statements in this activity. Most responses will probably have two hypothesis statements and one conclusion. It is possible to list even more assumptions, such as a triangle is a right triangle,  one leg of the triangle has length , and so on.    This statement is roughly in if-then format already, with the if portion in the first sentence and the then portion in the second sentence.  As a note: this statement is inspired by the Intermediate Value Theorem in calculus, but it is not exactly the Intermediate Value Theorem, as it does not state that we are restricting ourselves to values of for which when stating that takes on every value between and .    The logical structure for this statement is the same as in the rewritten statement: If a function is differentiable, then that function is continuous.       The statements in are traditionally mathematical. When discussing mathematical models, the statements may look somewhat different. Practice with modeling language in .    For each of the following paragraphs, specify the assumptions and the conclusions . There may be multiple assumptions and\/or conclusions per paragraph. The words if and\/or then may not appear explicitly.    Suppose we use an SIR model to represent an outbreak in a population of 10,000 people. In this model, the S compartment contains the Susceptibles, that is, people who are not sick but can become sick. The I compartment contains the Infectious, that is, people who are currently able to spread the disease. The R compartment contains the Removed, that is, people who are no longer able to spread the disease and are unable to become sick again. Suppose we estimate the parameters to be and . If, at the start of the outbreak, ten people are Infectious and the rest are Susceptible, then by the end of the outbreak, the model suggests that will remain Susceptible, that is, people will never have become Infectious.    Suppose we use the same SIR model equations described above, with the same initial conditions and the same value of . However, public health measures are implemented, so that is estimated to fall to approximately . In this situation, the model suggests that people will remain Susceptible at the end of the outbreak.        There are many assumptions here! Everything before the word then forms part of the assumptions. The conclusion appears after then .    The assumptions here include most of the information from the first scenario, except with a changed value of . The conclusion begins after In this situation .      All this practice with assumptions and conclusions leads us to a key idea. When the assumptions in a statement are not all satisfied, we should not expect the conclusion in that statement to be satisfied. Practice with this concept appears in .    Each of the following changes a statement from . Based on the change, comment on what we should expect regarding the statement's conclusion.    Recall the statement Suppose a function is continuous for -values satisfying . In this case, takes on every value between the numbers and . Suppose a function is not continuous at some of the -values satisfying . In this case, might there be some numbers between and for which does not take on the value of those numbers?    Recall the statement Differentiable functions are continuous . Suppose a function is differentiable at all points except at . Must this function be continuous everywhere? Explain in terms of mathematical logic, and if possible, provide one or more examples of functions that demonstrate that when an assumption is not satisfied, then the conclusion may not be satisfied.      When any of the assumptions are not satisfied, we should not expect the conclusion to be satisfied.    The sheer number of assumptions in a model is notable. We comment again that if any assumptions are not satisfied, then we should not assume that the conclusions must be true. Think through this in .    Recall the following from .   Suppose we use an SIR model to represent an outbreak in a population of 10,000 people. In this model, the S compartment contains the Susceptibles, that is, people who are not sick but can become sick. The I compartment contains the Infectious, that is, people who are currently able to spread the disease. The R compartment contains the Removed, that is, people who are no longer able to spread the disease and are unable to become sick again. Suppose we estimate the parameters to be and . If, at the start of the outbreak, ten people are Infectious and the rest are Susceptible, then by the end of the outbreak, the model suggests that will remain Susceptible, that is, people will never have become Infectious.   Write at least five different ways that the assumptions in the statement of this model may not be satisfied. In each of these cases, we should not expect the conclusion to be satisfied.    We have learned in this section that a model includes statements to create a very specific scenario. Whatever conclusions there may be from the model, we should expect them to occur only in the scenario created by the assumptions . If any of the assumptions change, then we should not expect any of the same conclusions to occur.  In mathematical statements and model scenarios: it is not completely impossible to see some of the same conclusions, even if we change the assumptions. We are not saying that it is impossible to end up at the same conclusion. Instead, our emphasis is that we should not expect the conclusion to be the same. All our discussion about the model should include this logical connection between assumptions and conclusions.  In addition to the purely logical relationship between the ifs and thens of model statements, there are priorities built into any model. We discuss this in .    Priorities: Where Goals Meet Ethics  Each model is based on the priorities of the people who create the model. Recognizing this, and thinking about it from the start, makes us better modelers.  The word priorities can take on many meanings. One key priority in model building is answering a question . For instance, in we described models that address questions about how helpful vaccines or isolation can be in preventing an outbreak or reducing the effects of an outbreak. Different questions may require different models.  There may be other priorities as well, and we may not even realize when we start model building that we are incorporating those priorities. A student project I once advised produced one very powerful example of priorities that we do not see initially. This project forms the idea behind . Though this student put tremendous thought and research into creating their model, the results of the model showed that the student's priorities had not been properly built into the model. This new understanding led the student to revise the model to better include their priorities.    This activity describes a process for constructing a model to address how a government can best use its resources to reduce the impact of HIV\/AIDS in its population. The real-life project that inspires this activity involved an excellent student who did meticulous research in constructing their model. The model shown below is a simplification of the model this student produced, yet still includes the key ideas.    This model has three compartments and is similar in structure to an SIR model. However, the compartments here have the initials S, I, and A.    The S compartment is our familiar Susceptibles compartment, for people without HIV or AIDS.    The I compartment is for Infectious people, meaning those with HIV.    The A compartment is for people with AIDS.      Many modelers, at the time this student was working, indicated that patients with AIDS were typically too sick to spread the virus to others. Therefore patients with AIDS, according to models, did not contribute to new cases of HIV. The same hypothesis is part of this model: people in the I compartment can cause new infections, but people in the A compartment cannot.    When someone in compartment I progresses in status from HIV to AIDS, they move to compartment A.    This model lasts many years, so it includes births and deaths. All births are assumed to be Susceptible, and births occur at a constant rate . The death rates can differ from compartment to compartment. The death rates are labeled for compartment S, for compartment I, and for compartment A.    The compartmental diagram for this model appears in .   An SIA diagram for HIV and AIDS, with births and deaths included   (Write this)     This model has more pieces than the models we have seen before. It may take some time to think through these pieces! Begin by taking a significant amount of time to view the compartmental diagram in and read the ideas that led to the model's development. Be sure you understand them. Then respond to the following questions.    The student project that inspired this Activity examined government strategies for spending limited funds designated for public health. Write about at least four ways government funds could be used to address health-related issues connected with HIV and AIDS. Include funding for HIV\/AIDS prevention as well as funding for the care of those who are sick.    This student project had a goal of determining how government funds should be allocated, given a goal of reducing the number of new HIV infections as much as possible. For each way you described how government funds could be used, do your best to indicate how those funds would affect the model in . For example, the number of people in a compartment could be affected, or one of the rate parameters could be increased or decreased. Explain your reasoning.    Given a fixed amount of funding, and a goal of decreasing new HIV infections as much as possible, the results of this student project prescribed a very stark allocation of funding. Thinking through all the ways you thought funding could be used, and thinking about the stated goal of decreasing new HIV infections: can you guess what this student project found in its results?     Only after making a guess at the previous question: check the Hint below to see what happened in this student's project. Then consider carefully why this approach to modeling produced this answer, and give some examples of what would need to change in the modeling process in order to give a different answer.      The model indicated that no funds at all should be spent on treating patients with AIDS: no medicines, no hospital beds, nothing.    The example in provides an important insight: We may think we know what questions we are answering with our models, but we should continue to interrogate our answers in relation to our goals, priorities, and ethics. The outcome of the model in did not fit the goals or ethics of the student doing the project. The result from the mathematical model highlighted built-in priorities of the model that the student (and I) did not notice at first. When new infections are completely unaffected by the people in the A compartment, then treating those people, or providing them any healthcare at all, is irrelevant to the goals of the model. However, leaving large numbers of people without healthcare was never the goal of this project. The model needed to be revised to account for this.  You may have noticed that the example in provides yet another important insight: The results of a model may draw attention to assumptions we had not realized we were making. Many researchers producing HIV\/AIDS models were using models in which patients with AIDS did not contribute to new cases of HIV, so we used the same assumption. However, this led to a model whose outcome indicated that an optimal allocation of funds meant AIDS patients would receive no healthcare. This made brute logical sense, but it showed that we needed to update the model to have an expectation of healthcare for AIDS patients. Models help us see situations in a new light. Even when a model's results are not what we hoped for, the process of modeling often improves our understanding of the system we are studying.   We have just seen an example in which updating a model was crucial. More generally, the process of modeling nearly always involves revision. We restructure models when we spot errors, or when we are able to access better data, or when we begin by asking some questions and then shift to different questions. Updating models is the focus of .    Making Changes to Models  The setup of a model matters. Definitions of compartments and rate parameters matter. Initial conditions, such as initial numbers of people in the population of each compartment, matter. All aspects of a model should reflect our priorities and goals, as described in , and should fit together logically, as described in . We may endeavor to get all these model details right on the first try, incorporating research into the disease being modeled and the populations involved in the outbreak. Yet the act of building and using a model often shows us more details to consider, such as what was described in . Other changes to models may be motivated by asking different questions, gathering new data, updating information about an outbreak, or many other reasons. Making changes to models is a central part of the modeling process .  When COVID-19 first emerged, people had lots of questions, and data were being updated all the time. This was a disease that was truly new, and mathematical models were (and still are) a way to build understanding. Work through to address some of the questions people immediately had about COVID-19. Importantly: the models in are inspired by the questions circulating early in the COVID-19 outbreak, but different regions throughout the world experienced COVID-19 in different ways, and the models here are not meant to address every circumstance. In other words: the models here cannot fully and accurately represent early COVID-19 , as worldwide outbreaks were more complex. However, by considering public health interventions and changing models to examine the outcomes of these interventions, we learn more about how such interventions affect the trajectory of an outbreak.    For this activity, we model a simplified version of early COVID-19 using an SEIR model in which the compartment definitions may differ from what we have seen before. For each question below, part of the response includes clarifying the definitions of compartments. Here are comments on each compartment, where terms such as could , may , and in some cases indicate aspects of compartment definitions that change, depending on how we define the compartments in a specific model.    Susceptibles (S) are people who have not yet become sick, and who can become sick. The Susceptibles could, in some cases, include people who have been vaccinated and therefore have less chance of becoming sick.    The Exposed-and-incubating (E) compartment includes people who have gotten the COVID-19 virus but not yet become infectious, and this class may include people with and without vaccination.    The Infectious (I) compartment includes people who are currently infectious, regardless of the severity of their symptoms, and in some cases, people in the Infectious compartment are also assumed to be interacting with Susceptibles.    The Removed (R) compartment may consist of people who have recovered from COVID-19, died from COVID-19, or entirely isolated themselves from others, so that they cannot spread COVID-19 at all.    The equations for the SEIR model are below. Use these, along with the Python code block, to answer the questions that follow.  For questions 2, 3, and possibly 4, first imagine how changes to initial population values or parameter values can change outcomes in the model . That is, truly think through this in your mind, and write down your thoughts, before proceeding with changes. For reference, the values in the original model are based very loosely on Lombardy, Italy, in early 2020. The total population was approximately ten million. The value of was estimated to be , and is estimated at about . These estimates come from the paper The early phase of the COVID-19 epidemic in Lombardy, Italy by many researchers, published in the journal Epidemics in December 2021. The value of is , indicating an average of two weeks of being infectious. This is based on many reports suggesting that most people were infectious for one to two weeks, but that some people were infectious for much longer. There was vast variation on how early COVID-19 affected people, which is part of the reason we need to consider changes and updates to models.  Next, try your changes in Python, creating before-and-after graphs. The code block includes sections titled original model and your changes to the model : scroll through to the your changes to the model version to make updates. Then go to the plotting commands section to choose the compartments for which you would like to show graphs; the default is to show I(t) for both the original and updated versions. Notice that if you were to show all four compartments, before and after, there would be eight total curves, which can be complicated for a reader to understand. Instead, prioritize the graphs that best illustrate your findings, probably showing no more than two or four total graphs at a time.      How would you define each compartment in the very early stages of COVID-19, when most people did not yet know this was a new disease, and no public health measures had yet been instituted to try to contain the outbreak?    Early public health measures aimed to flatten the curve . The idea was that, even without vaccines or COVID-19-specific medicines, we could slow the spread of the outbreak by having people stay distant from each other. Which parameter(s) in the SEIR model are most affected when people maintain physical distance from each other? Try changing the parameter(s) you have chosen in the Python block and compare your results with the original result.    Creating COVID-19 vaccines was an early goal, one that people were modeling long before vaccines became available. In some parts of the world, there has been significant controversy about the use of vaccines for COVID-19. This book does not require readers to have any one opinion about vaccine usage. We use models to address questions about vaccines, and readers are invited to do the same, building models that represent different vaccine-based outcomes and using those models to determine outcomes and dynamics of COVID-19, with and without vaccines. The plan was for vaccines to address COVID-19 in multiple ways; we will address two such ways here. One way was for people to be less likely to get COVID-19. Another way was to reduce the severity or length of time ill for people who did get COVID-19. For each of these ways of addressing COVID-19: which compartments and\/or parameters in the SEIR model are affected? Prepare before-and-after versions of the model, carefully defining each compartment and parameter in the before model and again in the after model. Then use the Python graph to generate graphs comparing the outcomes before and after vaccines.    Do more open-ended exploration. How else can we use the SEIR model to address questions about the early spread of an outbreak? State questions of your own, explain what changes you are making to the model to answer your questions, and show your results. Include explanations and interpretations of your results.        These are likely the traditional definitions we have used previously for the SEIR model. There is always room for flexibility, though, when different answers are accompanied by logical explanations.    Flattening the curve, social distancing, and other terms predominantly reduce the parameter . Other changes to the model may also represent some aspects of flattening the curve.    The effect of people being less likely to get COVID-19 is usually modeled by reducing . Reducing the severity or time ill typically increases gamma, which also has the meaning of reducing the average time in the Infectious compartment, as shown in and . Other answers are possible.    Be expansive and creative here, explain all your reasoning, and create graphs and\/or bring in yet other evidence to demonstrate your findings.        Writing Explanations to Present Models to Others  Doing mathematical work, and presenting that mathematical work, are two related yet different tasks. Moreover, mathematical work is just one part of the bigger process of building a model, justifying the assumptions within the model, determining the possible outcomes of the model, and explaining the possible solutions and outcomes of the model. In this section, we discuss the presentation of modeling results through careful writing and organization.  Students who take a course in modeling sometimes come from a mathematical background in which explanations are sparse. A question such as What is the value of times ? may not require any explanation. (A more fun question might be, What are two different ways to demonstrate that times equals ? . How would your approach to responding change if the question were phrased this way?) My experience teaching a variety of math courses is that students have not always experienced the value of explanation, prior to a modeling course. We address this directly so that each student's models make the most sense, and the impacts of each model are as meaningful and powerful as they can be.  We have discussed writing and presentation already in this text, and we will continue to do so throughout. Notably, focuses entirely on writing, specifically when writing mathematics and writing about mathematical models. Within this chapter, our focus is on unifying these four components of modeling: a logical approach, clearly stated priorities, making any appropriate changes to a model, and constructing meaningful explanations of the results of our models. Try this in .    Imagine a residential college campus experiences an outbreak of flu, which is also called influenza. The incubation period for influenza is usually one to four days, and most often about two days. People tend to be sick with influenza for a few days to less than two weeks, and in most people, less than one week Facts on incubation period and period of contagion are shown in the CDC's Key Facts About Influenza page: . . The value of for influenza is typically between 1 and 2 This summary of values comes from the Virginia Department of Health ( ), and many other research articles and websites report on estimates. , and many people in a population tend to have some immunity or protection from influenza, either because they have been sick with a related strain of influenza in the past, or because they have received an influenza vaccine, or for both reasons.    Decide on a model that you would use for an influenza outbreak on the campus you are imagining. Write out your reasons for the modeling decisions you make. Ideas to consider include: which compartmental model? How many people are involved, and what are the initial numbers of people in each compartment? What are the parameter values? What ranges of values may be possible for initial values and parameter values? There may be yet other aspects of your model to describe and explain.    Ask some questions of your model. Two sample questions are, What happens if the campus vastly increases its number and distribution of hand sanitizing stations? and How much do the model's results change as the initial number of infectious people changes? . There are many other questions you can ask. Use Python code blocks from elsewhere in the text to answer your questions. Select a code block that includes the type of model you are using (such as SIR, SEIR, and possibly vaccination) and make whatever changes you need.  Once you have addressed each question, write about your results. Include information about what question you asked and why it was a reasonable question, given the outbreak being studied. In addition to writing your response using words, incorporate other evidence, such as graphs and long-term values of Susceptibles or other compartments. Think throughout about structuring your response logically; indicating your priorities; explaining the change you made and why you made it; and explaining what happened when you made that change.    Creating COVID-19 vaccines was an early goal, one that people were modeling long before vaccines became available. In some parts of the world, there has been significant controversy about the use of vaccines for COVID-19. This book does not require readers to have any one opinion about vaccine usage. We use models to address questions about vaccines, and readers are invited to do the same, building models that represent different vaccine-based outcomes and using those models to determine outcomes and dynamics of COVID-19, with and without vaccines. The plan was for vaccines to address COVID-19 in multiple ways; we will address two such ways here. One way was for people to be less likely to get COVID-19. Another way was to reduce the severity or length of time ill for people who did get COVID-19. For each of these ways of addressing COVID-19: which compartments and\/or parameters in the SEIR model are affected? Prepare before-and-after versions of the model, carefully defining each compartment and parameter in the before model and again in the after model. Then use the Python graph to generate graphs comparing the outcomes before and after vaccines.    Do more open-ended exploration. How else can we use the SEIR model to address questions about the early spread of an outbreak? State questions of your own, explain what changes you are making to the model to answer your questions, and show your results. Include explanations and interpretations of your results.      Susceptibles (S) are people who have not yet become sick, and who can become sick. The Susceptibles could, in some cases, include people who have been vaccinated and therefore have less chance of becoming sick.    The Exposed-and-incubating (E) compartment includes people who have gotten the COVID-19 virus but not yet become infectious, and this class may include people with and without vaccination.    The Infectious (I) compartment includes people who are currently infectious, regardless of the severity of their symptoms, and in some cases, people in the Infectious compartment are also assumed to be interacting with Susceptibles.    The Removed (R) compartment may consist of people who have recovered from COVID-19, died from COVID-19, or entirely isolated themselves from others, so that they cannot spread COVID-19 at all.    The equations for the SEIR model are below. Use these, along with the Python code block, to answer the questions that follow.  For questions 2, 3, and possibly 4, first imagine how changes to initial population values or parameter values can change outcomes in the model . That is, truly think through this in your mind, and write down your thoughts, before proceeding with changes. For reference, the values in the original model are based very loosely on Lombardy, Italy, in early 2020. The total population was approximately ten million. The value of was estimated to be , and is estimated at about . These estimates come from the paper The early phase of the COVID-19 epidemic in Lombardy, Italy by many researchers, published in the journal Epidemics in December 2021. The value of is , indicating an average of two weeks of being infectious. This is based on many reports suggesting that most people were infectious for one to two weeks, but that some people were infectious for much longer. There was vast variation on how early COVID-19 affected people, which is part of the reason we need to consider changes and updates to models.  Next, try your changes in Python, creating before-and-after graphs. The code block includes sections titled original model and your changes to the model : scroll through to the your changes to the model version to make updates. Then go to the plotting commands section to choose the compartments for which you would like to show graphs; the default is to show I(t) for both the original and updated versions. Notice that if you were to show all four compartments, before and after, there would be eight total curves, which can be complicated for a reader to understand. Instead, prioritize the graphs that best illustrate your findings, probably showing no more than two or four total graphs at a time.        These are likely the traditional definitions we have used previously for the SEIR model. There is always room for flexibility, though, when different answers are accompanied by logical explanations.    Flattening the curve, social distancing, and other terms predominantly reduce the parameter . Other changes to the model may also represent some aspects of flattening the curve.    The effect of people being less likely to get COVID-19 is usually modeled by reducing . Reducing the severity or time ill typically increases gamma, which also has the meaning of reducing the average time in the Infectious compartment, as shown in and . Other answers are possible.    Be expansive and creative here, explain all your reasoning, and create graphs and\/or bring in yet other evidence to demonstrate your findings.        Redo  Update   Compute    Adapt    We   "
},
{
  "id": "objectives-7",
  "level": "2",
  "url": "ch-getting-the-answer-right-in-modeling.html#objectives-7",
  "type": "Goals",
  "number": "",
  "title": "",
  "body": "   Appreciate that mathematical models by themselves are not right or wrong , but instead depend on logically addressing specific questions    Recognize that mathematical models reflect ethics and priorities, and that modelers should consider their ethics and priorities while constructing models    Embrace the process of updating models based on new data, different questions being asked, or for many other reasons    Commit to explaining models and their results clearly, using carefully chosen graphs and words    "
},
{
  "id": "p-512",
  "level": "2",
  "url": "ch-getting-the-answer-right-in-modeling.html#p-512",
  "type": "Paragraph (with a defined term)",
  "number": "",
  "title": "",
  "body": "mathematical modeling "
},
{
  "id": "expl-activity-getting-the-answer-right",
  "level": "2",
  "url": "ch-getting-the-answer-right-in-modeling.html#expl-activity-getting-the-answer-right",
  "type": "Exploration",
  "number": "7.1",
  "title": "Which Model(s) to Use?",
  "body": " Which Model(s) to Use?   So far, we have worked with the SI, SIR, and SEIR models. We have shown how to include vaccines in a model. And for those who completed the last exercise of , we showed how to include vaccines along with their efficacy or effectiveness. Now, think through choosing from these models for different scenarios.    Which model(s) would you choose to work with if you wanted to include a term such as to indicate vaccination? Why?    Which model(s) would allow you to change the length of time someone is Infectious, perhaps to test the outcome of a medication that reduces the length of time a person can infect others? Why does your choice of model(s) make sense?    Which model(s) would you use if you had an Infectious compartment in which individuals would always stay Infectious? Why?    Which model(s) would allow you to change the time scale from days to weeks? How would you know this is possible?   "
},
{
  "id": "activity-mathematical-logic-sections",
  "level": "2",
  "url": "ch-getting-the-answer-right-in-modeling.html#activity-mathematical-logic-sections",
  "type": "Activity",
  "number": "7.2",
  "title": "",
  "body": "  For each of the following mathematical statements, specify the assumptions and the conclusions . There may be multiple assumptions and\/or conclusions per statement. The words if and\/or then may not appear explicitly. If cases when these words do not appear, it may help to rewrite the mathematical statement in a way that has the same logical meaning, yet that includes if and then in appropriate parts of the statement.  A note: you may recognize these statements, but it is completely OK if you do not recognize them. Naming the assumptions and conclusions is possible even if the statements are unfamiliar.    If a right triangle has legs with lengths and , and if the same triangle's hypotenuse has length , then the equation is true.    Suppose a function is continuous for -values satisfying . In this case, takes on every value between the numbers and .    Differentiable functions are continuous.        This is the most straightforward of the three statements in this activity. Most responses will probably have two hypothesis statements and one conclusion. It is possible to list even more assumptions, such as a triangle is a right triangle,  one leg of the triangle has length , and so on.    This statement is roughly in if-then format already, with the if portion in the first sentence and the then portion in the second sentence.  As a note: this statement is inspired by the Intermediate Value Theorem in calculus, but it is not exactly the Intermediate Value Theorem, as it does not state that we are restricting ourselves to values of for which when stating that takes on every value between and .    The logical structure for this statement is the same as in the rewritten statement: If a function is differentiable, then that function is continuous.      "
},
{
  "id": "activity-mathematical-logic-in-modeling",
  "level": "2",
  "url": "ch-getting-the-answer-right-in-modeling.html#activity-mathematical-logic-in-modeling",
  "type": "Activity",
  "number": "7.3",
  "title": "",
  "body": "  For each of the following paragraphs, specify the assumptions and the conclusions . There may be multiple assumptions and\/or conclusions per paragraph. The words if and\/or then may not appear explicitly.    Suppose we use an SIR model to represent an outbreak in a population of 10,000 people. In this model, the S compartment contains the Susceptibles, that is, people who are not sick but can become sick. The I compartment contains the Infectious, that is, people who are currently able to spread the disease. The R compartment contains the Removed, that is, people who are no longer able to spread the disease and are unable to become sick again. Suppose we estimate the parameters to be and . If, at the start of the outbreak, ten people are Infectious and the rest are Susceptible, then by the end of the outbreak, the model suggests that will remain Susceptible, that is, people will never have become Infectious.    Suppose we use the same SIR model equations described above, with the same initial conditions and the same value of . However, public health measures are implemented, so that is estimated to fall to approximately . In this situation, the model suggests that people will remain Susceptible at the end of the outbreak.        There are many assumptions here! Everything before the word then forms part of the assumptions. The conclusion appears after then .    The assumptions here include most of the information from the first scenario, except with a changed value of . The conclusion begins after In this situation .     "
},
{
  "id": "activity-mathematical-logic-assumptions-not-satisfied",
  "level": "2",
  "url": "ch-getting-the-answer-right-in-modeling.html#activity-mathematical-logic-assumptions-not-satisfied",
  "type": "Activity",
  "number": "7.4",
  "title": "",
  "body": "  Each of the following changes a statement from . Based on the change, comment on what we should expect regarding the statement's conclusion.    Recall the statement Suppose a function is continuous for -values satisfying . In this case, takes on every value between the numbers and . Suppose a function is not continuous at some of the -values satisfying . In this case, might there be some numbers between and for which does not take on the value of those numbers?    Recall the statement Differentiable functions are continuous . Suppose a function is differentiable at all points except at . Must this function be continuous everywhere? Explain in terms of mathematical logic, and if possible, provide one or more examples of functions that demonstrate that when an assumption is not satisfied, then the conclusion may not be satisfied.      When any of the assumptions are not satisfied, we should not expect the conclusion to be satisfied.   "
},
{
  "id": "activity-mathematical-logic-assumptions-not-satisfied-model",
  "level": "2",
  "url": "ch-getting-the-answer-right-in-modeling.html#activity-mathematical-logic-assumptions-not-satisfied-model",
  "type": "Activity",
  "number": "7.5",
  "title": "",
  "body": "  Recall the following from .   Suppose we use an SIR model to represent an outbreak in a population of 10,000 people. In this model, the S compartment contains the Susceptibles, that is, people who are not sick but can become sick. The I compartment contains the Infectious, that is, people who are currently able to spread the disease. The R compartment contains the Removed, that is, people who are no longer able to spread the disease and are unable to become sick again. Suppose we estimate the parameters to be and . If, at the start of the outbreak, ten people are Infectious and the rest are Susceptible, then by the end of the outbreak, the model suggests that will remain Susceptible, that is, people will never have become Infectious.   Write at least five different ways that the assumptions in the statement of this model may not be satisfied. In each of these cases, we should not expect the conclusion to be satisfied.   "
},
{
  "id": "activity-priorities-HIV-AIDS",
  "level": "2",
  "url": "ch-getting-the-answer-right-in-modeling.html#activity-priorities-HIV-AIDS",
  "type": "Activity",
  "number": "7.6",
  "title": "",
  "body": "  This activity describes a process for constructing a model to address how a government can best use its resources to reduce the impact of HIV\/AIDS in its population. The real-life project that inspires this activity involved an excellent student who did meticulous research in constructing their model. The model shown below is a simplification of the model this student produced, yet still includes the key ideas.    This model has three compartments and is similar in structure to an SIR model. However, the compartments here have the initials S, I, and A.    The S compartment is our familiar Susceptibles compartment, for people without HIV or AIDS.    The I compartment is for Infectious people, meaning those with HIV.    The A compartment is for people with AIDS.      Many modelers, at the time this student was working, indicated that patients with AIDS were typically too sick to spread the virus to others. Therefore patients with AIDS, according to models, did not contribute to new cases of HIV. The same hypothesis is part of this model: people in the I compartment can cause new infections, but people in the A compartment cannot.    When someone in compartment I progresses in status from HIV to AIDS, they move to compartment A.    This model lasts many years, so it includes births and deaths. All births are assumed to be Susceptible, and births occur at a constant rate . The death rates can differ from compartment to compartment. The death rates are labeled for compartment S, for compartment I, and for compartment A.    The compartmental diagram for this model appears in .   An SIA diagram for HIV and AIDS, with births and deaths included   (Write this)     This model has more pieces than the models we have seen before. It may take some time to think through these pieces! Begin by taking a significant amount of time to view the compartmental diagram in and read the ideas that led to the model's development. Be sure you understand them. Then respond to the following questions.    The student project that inspired this Activity examined government strategies for spending limited funds designated for public health. Write about at least four ways government funds could be used to address health-related issues connected with HIV and AIDS. Include funding for HIV\/AIDS prevention as well as funding for the care of those who are sick.    This student project had a goal of determining how government funds should be allocated, given a goal of reducing the number of new HIV infections as much as possible. For each way you described how government funds could be used, do your best to indicate how those funds would affect the model in . For example, the number of people in a compartment could be affected, or one of the rate parameters could be increased or decreased. Explain your reasoning.    Given a fixed amount of funding, and a goal of decreasing new HIV infections as much as possible, the results of this student project prescribed a very stark allocation of funding. Thinking through all the ways you thought funding could be used, and thinking about the stated goal of decreasing new HIV infections: can you guess what this student project found in its results?     Only after making a guess at the previous question: check the Hint below to see what happened in this student's project. Then consider carefully why this approach to modeling produced this answer, and give some examples of what would need to change in the modeling process in order to give a different answer.      The model indicated that no funds at all should be spent on treating patients with AIDS: no medicines, no hospital beds, nothing.   "
},
{
  "id": "activity-changing-models-COVID-19",
  "level": "2",
  "url": "ch-getting-the-answer-right-in-modeling.html#activity-changing-models-COVID-19",
  "type": "Activity",
  "number": "7.7",
  "title": "",
  "body": "  For this activity, we model a simplified version of early COVID-19 using an SEIR model in which the compartment definitions may differ from what we have seen before. For each question below, part of the response includes clarifying the definitions of compartments. Here are comments on each compartment, where terms such as could , may , and in some cases indicate aspects of compartment definitions that change, depending on how we define the compartments in a specific model.    Susceptibles (S) are people who have not yet become sick, and who can become sick. The Susceptibles could, in some cases, include people who have been vaccinated and therefore have less chance of becoming sick.    The Exposed-and-incubating (E) compartment includes people who have gotten the COVID-19 virus but not yet become infectious, and this class may include people with and without vaccination.    The Infectious (I) compartment includes people who are currently infectious, regardless of the severity of their symptoms, and in some cases, people in the Infectious compartment are also assumed to be interacting with Susceptibles.    The Removed (R) compartment may consist of people who have recovered from COVID-19, died from COVID-19, or entirely isolated themselves from others, so that they cannot spread COVID-19 at all.    The equations for the SEIR model are below. Use these, along with the Python code block, to answer the questions that follow.  For questions 2, 3, and possibly 4, first imagine how changes to initial population values or parameter values can change outcomes in the model . That is, truly think through this in your mind, and write down your thoughts, before proceeding with changes. For reference, the values in the original model are based very loosely on Lombardy, Italy, in early 2020. The total population was approximately ten million. The value of was estimated to be , and is estimated at about . These estimates come from the paper The early phase of the COVID-19 epidemic in Lombardy, Italy by many researchers, published in the journal Epidemics in December 2021. The value of is , indicating an average of two weeks of being infectious. This is based on many reports suggesting that most people were infectious for one to two weeks, but that some people were infectious for much longer. There was vast variation on how early COVID-19 affected people, which is part of the reason we need to consider changes and updates to models.  Next, try your changes in Python, creating before-and-after graphs. The code block includes sections titled original model and your changes to the model : scroll through to the your changes to the model version to make updates. Then go to the plotting commands section to choose the compartments for which you would like to show graphs; the default is to show I(t) for both the original and updated versions. Notice that if you were to show all four compartments, before and after, there would be eight total curves, which can be complicated for a reader to understand. Instead, prioritize the graphs that best illustrate your findings, probably showing no more than two or four total graphs at a time.      How would you define each compartment in the very early stages of COVID-19, when most people did not yet know this was a new disease, and no public health measures had yet been instituted to try to contain the outbreak?    Early public health measures aimed to flatten the curve . The idea was that, even without vaccines or COVID-19-specific medicines, we could slow the spread of the outbreak by having people stay distant from each other. Which parameter(s) in the SEIR model are most affected when people maintain physical distance from each other? Try changing the parameter(s) you have chosen in the Python block and compare your results with the original result.    Creating COVID-19 vaccines was an early goal, one that people were modeling long before vaccines became available. In some parts of the world, there has been significant controversy about the use of vaccines for COVID-19. This book does not require readers to have any one opinion about vaccine usage. We use models to address questions about vaccines, and readers are invited to do the same, building models that represent different vaccine-based outcomes and using those models to determine outcomes and dynamics of COVID-19, with and without vaccines. The plan was for vaccines to address COVID-19 in multiple ways; we will address two such ways here. One way was for people to be less likely to get COVID-19. Another way was to reduce the severity or length of time ill for people who did get COVID-19. For each of these ways of addressing COVID-19: which compartments and\/or parameters in the SEIR model are affected? Prepare before-and-after versions of the model, carefully defining each compartment and parameter in the before model and again in the after model. Then use the Python graph to generate graphs comparing the outcomes before and after vaccines.    Do more open-ended exploration. How else can we use the SEIR model to address questions about the early spread of an outbreak? State questions of your own, explain what changes you are making to the model to answer your questions, and show your results. Include explanations and interpretations of your results.        These are likely the traditional definitions we have used previously for the SEIR model. There is always room for flexibility, though, when different answers are accompanied by logical explanations.    Flattening the curve, social distancing, and other terms predominantly reduce the parameter . Other changes to the model may also represent some aspects of flattening the curve.    The effect of people being less likely to get COVID-19 is usually modeled by reducing . Reducing the severity or time ill typically increases gamma, which also has the meaning of reducing the average time in the Infectious compartment, as shown in and . Other answers are possible.    Be expansive and creative here, explain all your reasoning, and create graphs and\/or bring in yet other evidence to demonstrate your findings.     "
},
{
  "id": "activity-writing-explanations-to-present-models",
  "level": "2",
  "url": "ch-getting-the-answer-right-in-modeling.html#activity-writing-explanations-to-present-models",
  "type": "Activity",
  "number": "7.8",
  "title": "",
  "body": "  Imagine a residential college campus experiences an outbreak of flu, which is also called influenza. The incubation period for influenza is usually one to four days, and most often about two days. People tend to be sick with influenza for a few days to less than two weeks, and in most people, less than one week Facts on incubation period and period of contagion are shown in the CDC's Key Facts About Influenza page: . . The value of for influenza is typically between 1 and 2 This summary of values comes from the Virginia Department of Health ( ), and many other research articles and websites report on estimates. , and many people in a population tend to have some immunity or protection from influenza, either because they have been sick with a related strain of influenza in the past, or because they have received an influenza vaccine, or for both reasons.    Decide on a model that you would use for an influenza outbreak on the campus you are imagining. Write out your reasons for the modeling decisions you make. Ideas to consider include: which compartmental model? How many people are involved, and what are the initial numbers of people in each compartment? What are the parameter values? What ranges of values may be possible for initial values and parameter values? There may be yet other aspects of your model to describe and explain.    Ask some questions of your model. Two sample questions are, What happens if the campus vastly increases its number and distribution of hand sanitizing stations? and How much do the model's results change as the initial number of infectious people changes? . There are many other questions you can ask. Use Python code blocks from elsewhere in the text to answer your questions. Select a code block that includes the type of model you are using (such as SIR, SEIR, and possibly vaccination) and make whatever changes you need.  Once you have addressed each question, write about your results. Include information about what question you asked and why it was a reasonable question, given the outbreak being studied. In addition to writing your response using words, incorporate other evidence, such as graphs and long-term values of Susceptibles or other compartments. Think throughout about structuring your response logically; indicating your priorities; explaining the change you made and why you made it; and explaining what happened when you made that change.    Creating COVID-19 vaccines was an early goal, one that people were modeling long before vaccines became available. In some parts of the world, there has been significant controversy about the use of vaccines for COVID-19. This book does not require readers to have any one opinion about vaccine usage. We use models to address questions about vaccines, and readers are invited to do the same, building models that represent different vaccine-based outcomes and using those models to determine outcomes and dynamics of COVID-19, with and without vaccines. The plan was for vaccines to address COVID-19 in multiple ways; we will address two such ways here. One way was for people to be less likely to get COVID-19. Another way was to reduce the severity or length of time ill for people who did get COVID-19. For each of these ways of addressing COVID-19: which compartments and\/or parameters in the SEIR model are affected? Prepare before-and-after versions of the model, carefully defining each compartment and parameter in the before model and again in the after model. Then use the Python graph to generate graphs comparing the outcomes before and after vaccines.    Do more open-ended exploration. How else can we use the SEIR model to address questions about the early spread of an outbreak? State questions of your own, explain what changes you are making to the model to answer your questions, and show your results. Include explanations and interpretations of your results.      Susceptibles (S) are people who have not yet become sick, and who can become sick. The Susceptibles could, in some cases, include people who have been vaccinated and therefore have less chance of becoming sick.    The Exposed-and-incubating (E) compartment includes people who have gotten the COVID-19 virus but not yet become infectious, and this class may include people with and without vaccination.    The Infectious (I) compartment includes people who are currently infectious, regardless of the severity of their symptoms, and in some cases, people in the Infectious compartment are also assumed to be interacting with Susceptibles.    The Removed (R) compartment may consist of people who have recovered from COVID-19, died from COVID-19, or entirely isolated themselves from others, so that they cannot spread COVID-19 at all.    The equations for the SEIR model are below. Use these, along with the Python code block, to answer the questions that follow.  For questions 2, 3, and possibly 4, first imagine how changes to initial population values or parameter values can change outcomes in the model . That is, truly think through this in your mind, and write down your thoughts, before proceeding with changes. For reference, the values in the original model are based very loosely on Lombardy, Italy, in early 2020. The total population was approximately ten million. The value of was estimated to be , and is estimated at about . These estimates come from the paper The early phase of the COVID-19 epidemic in Lombardy, Italy by many researchers, published in the journal Epidemics in December 2021. The value of is , indicating an average of two weeks of being infectious. This is based on many reports suggesting that most people were infectious for one to two weeks, but that some people were infectious for much longer. There was vast variation on how early COVID-19 affected people, which is part of the reason we need to consider changes and updates to models.  Next, try your changes in Python, creating before-and-after graphs. The code block includes sections titled original model and your changes to the model : scroll through to the your changes to the model version to make updates. Then go to the plotting commands section to choose the compartments for which you would like to show graphs; the default is to show I(t) for both the original and updated versions. Notice that if you were to show all four compartments, before and after, there would be eight total curves, which can be complicated for a reader to understand. Instead, prioritize the graphs that best illustrate your findings, probably showing no more than two or four total graphs at a time.        These are likely the traditional definitions we have used previously for the SEIR model. There is always room for flexibility, though, when different answers are accompanied by logical explanations.    Flattening the curve, social distancing, and other terms predominantly reduce the parameter . Other changes to the model may also represent some aspects of flattening the curve.    The effect of people being less likely to get COVID-19 is usually modeled by reducing . Reducing the severity or time ill typically increases gamma, which also has the meaning of reducing the average time in the Infectious compartment, as shown in and . Other answers are possible.    Be expansive and creative here, explain all your reasoning, and create graphs and\/or bring in yet other evidence to demonstrate your findings.     "
},
{
  "id": "exercise-19",
  "level": "2",
  "url": "ch-getting-the-answer-right-in-modeling.html#exercise-19",
  "type": "Exercise",
  "number": "7.5.1",
  "title": "",
  "body": "Redo "
},
{
  "id": "exercise-20",
  "level": "2",
  "url": "ch-getting-the-answer-right-in-modeling.html#exercise-20",
  "type": "Exercise",
  "number": "7.5.2",
  "title": "",
  "body": "Update   Compute    Adapt   "
},
{
  "id": "exercise-21",
  "level": "2",
  "url": "ch-getting-the-answer-right-in-modeling.html#exercise-21",
  "type": "Exercise",
  "number": "7.5.3",
  "title": "",
  "body": "We "
},
{
  "id": "ch-preparing-influenza-data-to-compare-with-a-model",
  "level": "1",
  "url": "ch-preparing-influenza-data-to-compare-with-a-model.html",
  "type": "Chapter",
  "number": "8",
  "title": "* Preparing Influenza Data to Compare With a Model",
  "body": " * Preparing Influenza Data to Compare With a Model   Starter Example Comparing Data with a Model: Zombie Data   Suppose you have data to compare against your model. Which set of parameters is best? We start by revisiting the type of graph and data we saw with our (relatively simple) early-semester zombie models. Read through the following and make sure you understand what is happening in each command.     Using RSS  One way to compare data with a graph is by computing the Residual Sum of Squares. (There will be an explanation during class time.) Within a single model, this is a good option. Read the code block below to see how we can do this in Python.     Influenza Data and RSS  Now try computing RSS using the influenza prevalence data. The data are already written into the code block below. Time 0 is the same as October 6.    "
},
{
  "id": "ch-epidemic-vs-endemic-models",
  "level": "1",
  "url": "ch-epidemic-vs-endemic-models.html",
  "type": "Chapter",
  "number": "9",
  "title": "* Epidemic vs. Endemic Models",
  "body": " * Epidemic vs. Endemic Models    Talk about demographic effects. Emphasize here that this is why we aren't normalizing total population to 1. Also: put herd immunity in this chapter.   "
},
{
  "id": "ch-residual-sum-of-squares-improving-a-models-fit-to-data",
  "level": "1",
  "url": "ch-residual-sum-of-squares-improving-a-models-fit-to-data.html",
  "type": "Chapter",
  "number": "10",
  "title": "* Residual Sum of Squares: Improving a Model's Fit to Data",
  "body": " * Residual Sum of Squares: Improving a Model's Fit to Data    Use Bates flu data? Introduce RSS. Discuss improving model fit and show how to do it. Emphasize (!!!!!!!) biological suitability of parameter choices, noise in data, etc. Consider developing a range of very good parameters, rather than imagining there is some set of \"best\" parameters.   "
},
{
  "id": "ch-akaike-information-criterion-comparing-different-models",
  "level": "1",
  "url": "ch-akaike-information-criterion-comparing-different-models.html",
  "type": "Chapter",
  "number": "11",
  "title": "* Akaike Information Criterion: Comparing Different Models",
  "body": " * Akaike Information Criterion: Comparing Different Models    Use Bates flu data? Introduce AICc. Discuss comparing models and why we might want to do so. Discuss overfitting, Occam's Razor.   "
},
{
  "id": "ch-modeling-the-spread-of-a-rumor",
  "level": "1",
  "url": "ch-modeling-the-spread-of-a-rumor.html",
  "type": "Chapter",
  "number": "12",
  "title": "* Modeling the Spread of a Rumor",
  "body": " * Modeling the Spread of a Rumor    Rumor - use multiple references, and write up our \"own\" model here   "
},
{
  "id": "ch-the-next-generation-method",
  "level": "1",
  "url": "ch-the-next-generation-method.html",
  "type": "Chapter",
  "number": "13",
  "title": "* The Next Generation Method",
  "body": " * The Next Generation Method   Python Code for the Next Generation Method   The code block below produces the eigenvalues for the SEIR model. This code can also be used as a template for producing eigenvalues when the Next Generation Method produces a matrix.  Spend some time looking through the code. Be sure you see how and where matrices are entered. You can use similar code for other compartmental models, and the only parts you need to change are the and matrices.   The code block below produces the eigenvalues for the SLIAR model. This code can also be used as a template for producing eigenvalues when the Next Generation Method produces a matrix. Comparing this code with the previous code may help show how similar the code is when computing the Next Generation matrix for different models, as well as showing what to change for a different model.    "
},
{
  "id": "ch-tips-on-reading-a-scientific-paper",
  "level": "1",
  "url": "ch-tips-on-reading-a-scientific-paper.html",
  "type": "Chapter",
  "number": "14",
  "title": "* Tips on Reading a Scientific Paper",
  "body": " * Tips on Reading a Scientific Paper      "
},
{
  "id": "ch-preparing-mumps-data-to-compare-with-a-six-compartment-model",
  "level": "1",
  "url": "ch-preparing-mumps-data-to-compare-with-a-six-compartment-model.html",
  "type": "Chapter",
  "number": "15",
  "title": "* Preparing Mumps Data to Compare with a Six-Compartment Model",
  "body": " * Preparing Mumps Data to Compare with a Six-Compartment Model    Mumps data and SEIJAR model (and SEIR model)   "
},
{
  "id": "glossary-of-terms",
  "level": "1",
  "url": "glossary-of-terms.html",
  "type": "Glossary",
  "number": "",
  "title": "Glossary of Mathematical Epidemiology Terms",
  "body": " Glossary of Mathematical Epidemiology Terms   This glossary includes both definitions and, in many cases, examples along with fuller descriptions. The terms are listed in alphabetical order. At the end of each definition, a chapter number in parentheses indicates where the term first appeared in the text. The definitions and descriptions of the terms relate to their usage in the types of models described in this text: readers should know that some of the terms may have more broadly defined meanings in other mathematical contexts.    Basic Reproduction Number  The basic reproduction number is the average number of new infections caused by one infectious person in an otherwise entirely susceptible population. The symbol , pronounced R zero or R nought , represents the concept of the basic reproduction number, both in writing and in mathematical formulas. (Defined in Chapter 5, with a very brief mention at the end of Chapter 4)    Compartmental Diagram  A compartmental diagram is an image, typically consisting of labeled boxes and arrows, that visually represents the flow of individuals through a compartmental model . Examples include and . (Chapter 4)    Compartmental Model  A compartmental model is a style of mathematical model in which the subjects of the model are grouped into categories called compartments . Such a model follows the overall outcomes for each compartment, but does not typically track the outcomes of smaller groups such as individuals. The compartmental models in this text use differential equations to demonstrate the interactions and rates governing how many individuals move from one group to another at specific points in time. As one example of a compartmental model, an SIR model consists of three compartments: S, I, and R. Most often in this text, compartment S represents Susceptible individuals, compartment I represents Infectious individuals, and compartment R represents Removed individuals. (Chapter 4)    Compartments  In most models within this text, individuals are placed into categories called compartments. The individuals can typically move out of some compartments and into others, and the differential equations in compartmental models are sets of rules for the ways in which individuals are able to make such moves between compartments. (Chapter 4)    Continuous  We tend to think of real-world time as continuous, meaning time does not keep stopping and starting. The compartmental models we use in most of this book show continuous time. While this sense of time matches the real world, we need to think about how to reconcile it with data sets, which typically involve discrete time steps, such as days or weeks. (Chapter 2)    Discrete  We can think of time as discrete when we describe it as separate steps, such as Day 0, Day 1, or Day 2. Many data sets we work with report data in discrete time steps, such as by day or by week. We need to think through how to reconcile discrete data sets with the continuous models we most often use in this text. (Chapter 2)    Effective Reproduction Number  The effective reproduction number is the average number of new infections caused by one infectious person in a population that is not entirely susceptible. The most common reason for a population to not be entirely susceptible is when some of the people have some form of immunity. Reasons for immunity may include vaccination and\/or some of the people in the population previously having the disease being studied. The symbol represents the effective reproduction number. (Chapter 6)    Effectiveness  A measure of how many people within a population of vaccinated individuals get a disease, compared with how many people within a comparable population of unvaccinated individuals get the same disease, in real-world conditions . For instance, if after a vaccine has been released to the public fewer vaccinated people get the virus than do those who are unvaccinated, then the vaccine is said to have an effectiveness of . (Chapter 6)    Efficacy  A measure of how many people within a population of vaccinated individuals get a disease, compared with how many people within a comparable population of unvaccinated individuals get the same disease, in a clinical trial . For instance, if in trials fewer people in the vaccinated group get a virus than do those in the unvaccinated group, then the vaccine is said to have an efficacy of . (Chapter 6)    Graphical Solution  A graphical solution to a differential equation, or system of differential equations, is a curve or curves showing the behavior of the differential equation(s), based on specific parameter values and initial conditions. When parameter values change, or when initial conditions change, the graphical solution typically changes as well. A graphical solution is often called a solution , and readers should use context to know whether the word solution refers to a graphical solution, a numerical solution, or a formula. (Chapter 3)    Initial Conditions  Initial conditions are the starting values of the dependent variables in differential equations. Within this text, our dependent variables are typically populations such as or , and the start of solutions is usually the time . This means the initial conditions are the values and . Initial conditions are used when computing a numerical solution: the numerical solution begins with the initial conditions and then steps through time, computing the later values of each dependent variable using both the earlier values and the information in the differential equations about how each dependent variable changes. (Chapter 3)    Mathematical Modeling  Mathematical modeling is a process by which we represent real-world dynamics using mathematical formulas. In this text, we typically use differential equations in our models. The process of mathematical modeling can require many steps, such as choosing which equations to use, comparing the results of a model with data, updating a model as needed to respond to different goals, and considering multiple models to best answer the questions we are asking. (Chapter 7)    Numerical Solution  A numerical solution to a differential equation, or system of differential equations, is a set of lists of numbers that result from approximating the outcome of the differential equation(s), given specific parameter values and initial conditions. When parameter values change, or when initial conditions change, the numerical solution typically changes as well. The lists of numbers for an SIR model, for instance, typically show the values of , , and at many values of time within the range of time values of interest. We may print some or all of the values in the lists, or we may use graphing to present the information in the lists. A numerical solution is often called a solution , and readers should use context to know whether the word solution refers to a graphical solution, a numerical solution, or a formula. (Chapter 3)    Parameters  Parameters in a model are numbers, determined using biological information, that represent some aspect of how a disease progresses. In this text, most parameters are shown as Greek letters, such as or . A few parameters in this text represent percentages, such as the percentage of a population that is vaccinated against a disease, and these parameters are typically represented by lowercase letters such as or . Parameters are different than variables: the variables in our models are typically the independent variable for time, and dependent variables such as , , , and others, for populations. (Chapter 4)    Rate  A rate is, in general, a ratio between two different things. In this text, rates are parameters having units . In a model, the rate is typically multiplied by a population such as or to show the flow of that population out of one compartment and into another compartment. (Chapter 4)    Sign Analysis  The word sign in sign analysis refers to whether terms in differential equations are positive ( ), negative ( ), or zero ( ). In sign analysis, we use these signs to build understanding of the differential equation. Often, our goal is to learn whether the solution to the differential equation is rising, falling, or level at some time . This understanding may help us identify which solution curve goes with which differential equation, may show when a disease starts with an outbreak or can never experience an outbreak, and may indicate many other outcomes of models. Sign analysis is powerful because it depends only on the signs of terms, without forcing us to rely on detailed data sets that may not always be available. (Chapter 5)    SI Model  An SI model is a compartmental model having two compartments, labeled S and I. Most often in this text, S stands for Susceptible and I stands for Infectious , though the compartments can have other interpretations. The letters S and I are each pronounced when we say SI model : Ess  Eye model. (Chapter 2)    SEIR Model  An SEIR model is a compartmental model having four compartments, labeled S, E, I, and R. Most often in this text, S stands for Susceptible , E stands for Exposed-and-incubating , I stands for Infectious , and R stands for Removed , though the compartments can have other interpretations. The letters S, E, I, and R are each pronounced when we say SEIR model : Ess  Eee  Eye  Arr model. (Chapter 6)    SIR Model  An SIR model is a compartmental model having three compartments, labeled S, I, and R. Most often in this text, S stands for Susceptible , I stands for Infectious , and R stands for Removed , though the compartments can have other interpretations. The letters S, I, and R are each pronounced when we say SIR model : Ess  Eye  Arr model. (Chapter 4)    Total Population  The total population of a compartmental model is the sum of the populations in each compartment. We typically use the variable to refer to total population, and we write to mean total population at time . (Chapter 5)   "
}
]

var ptx_lunr_idx = lunr(function () {
  this.ref('id')
  this.field('title')
  this.field('body')

  ptx_lunr_docs.forEach(function (doc) {
    this.add(doc)
  }, this)
})
